{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/murmurhash-js/index.js","node_modules/murmurhash-js/murmurhash2_gc.js","node_modules/murmurhash-js/murmurhash3_gc.js","node_modules/random-material-color/dist/randomColor.js","src/js/config.js","src/js/lib/keyHandler.js","src/js/lib/pubsub.js","src/js/main.js","src/js/models/Card.js","src/js/models/CardManager.js","src/js/prototypes.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnEA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var murmur3 = require(\"./murmurhash3_gc.js\")\nvar murmur2 = require(\"./murmurhash2_gc.js\")\n\nmodule.exports = murmur3\nmodule.exports.murmur3 = murmur3\nmodule.exports.murmur2 = murmur2\n","/**\n * JS Implementation of MurmurHash2\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} str ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash\n */\n\nfunction murmurhash2_32_gc(str, seed) {\n  var\n    l = str.length,\n    h = seed ^ l,\n    i = 0,\n    k;\n  \n  while (l >= 4) {\n  \tk = \n  \t  ((str.charCodeAt(i) & 0xff)) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 8) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 16) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 24);\n    \n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n    k ^= k >>> 24;\n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n\n\th = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16)) ^ k;\n\n    l -= 4;\n    ++i;\n  }\n  \n  switch (l) {\n  case 3: h ^= (str.charCodeAt(i + 2) & 0xff) << 16;\n  case 2: h ^= (str.charCodeAt(i + 1) & 0xff) << 8;\n  case 1: h ^= (str.charCodeAt(i) & 0xff);\n          h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  }\n\n  h ^= h >>> 13;\n  h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  h ^= h >>> 15;\n\n  return h >>> 0;\n}\n\nif(typeof module !== undefined) {\n  module.exports = murmurhash2_32_gc\n}\n","/**\n * JS Implementation of MurmurHash3 (r136) (as of May 20, 2011)\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} key ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash \n */\n\nfunction murmurhash3_32_gc(key, seed) {\n\tvar remainder, bytes, h1, h1b, c1, c1b, c2, c2b, k1, i;\n\t\n\tremainder = key.length & 3; // key.length % 4\n\tbytes = key.length - remainder;\n\th1 = seed;\n\tc1 = 0xcc9e2d51;\n\tc2 = 0x1b873593;\n\ti = 0;\n\t\n\twhile (i < bytes) {\n\t  \tk1 = \n\t  \t  ((key.charCodeAt(i) & 0xff)) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 8) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 16) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 24);\n\t\t++i;\n\t\t\n\t\tk1 = ((((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16))) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = ((((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16))) & 0xffffffff;\n\n\t\th1 ^= k1;\n        h1 = (h1 << 13) | (h1 >>> 19);\n\t\th1b = ((((h1 & 0xffff) * 5) + ((((h1 >>> 16) * 5) & 0xffff) << 16))) & 0xffffffff;\n\t\th1 = (((h1b & 0xffff) + 0x6b64) + ((((h1b >>> 16) + 0xe654) & 0xffff) << 16));\n\t}\n\t\n\tk1 = 0;\n\t\n\tswitch (remainder) {\n\t\tcase 3: k1 ^= (key.charCodeAt(i + 2) & 0xff) << 16;\n\t\tcase 2: k1 ^= (key.charCodeAt(i + 1) & 0xff) << 8;\n\t\tcase 1: k1 ^= (key.charCodeAt(i) & 0xff);\n\t\t\n\t\tk1 = (((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16)) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = (((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16)) & 0xffffffff;\n\t\th1 ^= k1;\n\t}\n\t\n\th1 ^= key.length;\n\n\th1 ^= h1 >>> 16;\n\th1 = (((h1 & 0xffff) * 0x85ebca6b) + ((((h1 >>> 16) * 0x85ebca6b) & 0xffff) << 16)) & 0xffffffff;\n\th1 ^= h1 >>> 13;\n\th1 = ((((h1 & 0xffff) * 0xc2b2ae35) + ((((h1 >>> 16) * 0xc2b2ae35) & 0xffff) << 16))) & 0xffffffff;\n\th1 ^= h1 >>> 16;\n\n\treturn h1 >>> 0;\n}\n\nif(typeof module !== \"undefined\") {\n  module.exports = murmurhash3_32_gc\n}","var defaultPalette={50:[\"#FFEBEE\",\"#FCE4EC\",\"#F3E5F5\",\"#EDE7F6\",\"#E8EAF6\",\"#E3F2FD\",\"#E1F5FE\",\"#E0F7FA\",\"#E0F2F1\",\"#E8F5E9\",\"#F1F8E9\",\"#F9FBE7\",\"#FFFDE7\",\"#FFF8E1\",\"#FFF3E0\",\"#FBE9E7\",\"#EFEBE9\",\"#FAFAFA\",\"#ECEFF1\"],100:[\"#FFCDD2\",\"#F8BBD0\",\"#E1BEE7\",\"#D1C4E9\",\"#C5CAE9\",\"#BBDEFB\",\"#B3E5FC\",\"#B2EBF2\",\"#B2DFDB\",\"#C8E6C9\",\"#DCEDC8\",\"#F0F4C3\",\"#FFF9C4\",\"#FFECB3\",\"#FFE0B2\",\"#FFCCBC\",\"#D7CCC8\",\"#F5F5F5\",\"#CFD8DC\"],200:[\"#EF9A9A\",\"#F48FB1\",\"#CE93D8\",\"#B39DDB\",\"#9FA8DA\",\"#90CAF9\",\"#81D4FA\",\"#80DEEA\",\"#80CBC4\",\"#A5D6A7\",\"#C5E1A5\",\"#E6EE9C\",\"#FFF59D\",\"#FFE082\",\"#FFCC80\",\"#FFAB91\",\"#BCAAA4\",\"#EEEEEE\",\"#B0BEC5\"],300:[\"#E57373\",\"#F06292\",\"#BA68C8\",\"#9575CD\",\"#7986CB\",\"#64B5F6\",\"#4FC3F7\",\"#4DD0E1\",\"#4DB6AC\",\"#81C784\",\"#AED581\",\"#DCE775\",\"#FFF176\",\"#FFD54F\",\"#FFB74D\",\"#FF8A65\",\"#A1887F\",\"#E0E0E0\",\"#90A4AE\"],400:[\"#EF5350\",\"#EC407A\",\"#AB47BC\",\"#7E57C2\",\"#5C6BC0\",\"#42A5F5\",\"#29B6F6\",\"#26C6DA\",\"#26A69A\",\"#66BB6A\",\"#9CCC65\",\"#D4E157\",\"#FFEE58\",\"#FFCA28\",\"#FFA726\",\"#FF7043\",\"#8D6E63\",\"#BDBDBD\",\"#78909C\"],500:[\"#F44336\",\"#E91E63\",\"#9C27B0\",\"#673AB7\",\"#3F51B5\",\"#2196F3\",\"#03A9F4\",\"#00BCD4\",\"#009688\",\"#4CAF50\",\"#8BC34A\",\"#CDDC39\",\"#FFEB3B\",\"#FFC107\",\"#FF9800\",\"#FF5722\",\"#795548\",\"#9E9E9E\",\"#607D8B\"],600:[\"#E53935\",\"#D81B60\",\"#8E24AA\",\"#5E35B1\",\"#3949AB\",\"#1E88E5\",\"#039BE5\",\"#00ACC1\",\"#00897B\",\"#43A047\",\"#7CB342\",\"#C0CA33\",\"#FDD835\",\"#FFB300\",\"#FB8C00\",\"#F4511E\",\"#6D4C41\",\"#757575\",\"#546E7A\"],700:[\"#D32F2F\",\"#C2185B\",\"#7B1FA2\",\"#512DA8\",\"#303F9F\",\"#1976D2\",\"#0288D1\",\"#0097A7\",\"#00796B\",\"#388E3C\",\"#689F38\",\"#AFB42B\",\"#FBC02D\",\"#FFA000\",\"#F57C00\",\"#E64A19\",\"#5D4037\",\"#616161\",\"#455A64\"],800:[\"#C62828\",\"#AD1457\",\"#6A1B9A\",\"#4527A0\",\"#283593\",\"#1565C0\",\"#0277BD\",\"#00838F\",\"#00695C\",\"#2E7D32\",\"#558B2F\",\"#9E9D24\",\"#F9A825\",\"#FF8F00\",\"#EF6C00\",\"#D84315\",\"#4E342E\",\"#424242\",\"#37474F\"],900:[\"#B71C1C\",\"#880E4F\",\"#4A148C\",\"#311B92\",\"#1A237E\",\"#0D47A1\",\"#01579B\",\"#006064\",\"#004D40\",\"#1B5E20\",\"#33691E\",\"#827717\",\"#F57F17\",\"#FF6F00\",\"#E65100\",\"#BF360C\",\"#3E2723\",\"#212121\",\"#263238\"],A100:[\"#FF8A80\",\"#FF80AB\",\"#EA80FC\",\"#B388FF\",\"#8C9EFF\",\"#82B1FF\",\"#80D8FF\",\"#84FFFF\",\"#A7FFEB\",\"#B9F6CA\",\"#CCFF90\",\"#F4FF81\",\"#FFFF8D\",\"#FFE57F\",\"#FFD180\",\"#FF9E80\"],A200:[\"#FF5252\",\"#FF4081\",\"#E040FB\",\"#7C4DFF\",\"#536DFE\",\"#448AFF\",\"#40C4FF\",\"#18FFFF\",\"#64FFDA\",\"#69F0AE\",\"#B2FF59\",\"#EEFF41\",\"#FFFF00\",\"#FFD740\",\"#FFAB40\",\"#FF6E40\"],A400:[\"#FF1744\",\"#F50057\",\"#D500F9\",\"#651FFF\",\"#3D5AFE\",\"#2979FF\",\"#00B0FF\",\"#00E5FF\",\"#1DE9B6\",\"#00E676\",\"#76FF03\",\"#C6FF00\",\"#FFEA00\",\"#FFC400\",\"#FF9100\",\"#FF3D00\"],A700:[\"#D50000\",\"#C51162\",\"#AA00FF\",\"#6200EA\",\"#304FFE\",\"#2962FF\",\"#0091EA\",\"#00B8D4\",\"#00BFA5\",\"#00C853\",\"#64DD17\",\"#AEEA00\",\"#FFD600\",\"#FFAB00\",\"#FF6D00\",\"#DD2C00\"]},murmur=require(\"murmurhash-js\");module.exports=function(){var F=[],E={shades:[\"500\"],palette:defaultPalette,text:null,ignoreColors:[]},C=function(C){C||(C=E),C.palette||(C.palette=defaultPalette),C.shades||(C.shades=[\"500\"]);for(var B,D=F.length,t=0;D>t;t++)if(C.text&&F[t].text===C.text)return F[t].color;return B=A(C),C.text&&F.push({text:C.text,color:B}),B},A=function(F){var E=F.shades[B(F.shades.length)],C=\"\";for(var A in F.palette)F.palette.hasOwnProperty(A)&&A===E&&(C=F.text?F.palette[A][D(F.text,F.palette[A].length)]:F.palette[A][B(F.palette[A].length)]);return C},B=function(F){return Math.floor(Math.random()*F)},D=function(F,E){var C=murmur.murmur3(F)/1e10;return.1>C&&(C=10*C),Math.floor(C*E)};return{getColor:C}}();","module.exports = {\n  SAVE_CARDS: 'SAVE_CARDS',\n  SELECT_CARD: 'SELECT_CARD',\n  RERENDER: 'RERENDER',\n  LESS_PRISTINE: 'LESS_PRISTINE',\n  ASCII: {\n    ESCAPE_KEY: 27,\n    TAB_KEY: 9,\n    C_KEY: 67,\n    D_KEY: 68,\n    E_KEY: 69,\n    PLUS_KEY: 187,\n    MINUS_KEY: 189,\n    DOT_KEY: 190,\n    A_KEY: 65,\n    I_KEY: 73,\n    R_KEY: 82,\n    Z_KEY: 90,\n    CMD_KEY: 91,\n    KEYS_ARRAY: [27, 9, 67, 68, 69, 187, 189, 190, 65, 73, 82, 90, 91],\n  },\n  DEFAULT_CONTENT: 'W3siaWQiOjAsInRpdGxlIjoiMSIsImRlc2NyaXB0aW9uIjoiVXNlIHRhYiBhbmQgc2hpZnQgdGFiIHRvIGNpcmNsZSBiZXR3ZWVuIGNhcmRzIDpEXG5cbkRyYWdnaW5nIG9yIGNsaWNraW5nIHRoZW0gd2lsbCBhbHNvIG1hcmsgdGhlbSBhcyBzZWxlY3RlZCIsImRlcHRoIjo1LCJ4IjoxNjksInkiOjc5LCJjb2xvciI6IiNBNUQ2QTciLCJzZWxlY3RlZCI6dHJ1ZSwiaXNBcmNoaXZlZCI6ZmFsc2UsImlzRGVsZXRlZCI6ZmFsc2UsImNyZWF0ZWRBdCI6MTUwNzY0Njc1ODE4NiwiYXJjaGl2ZWRBdCI6bnVsbCwibm9kZSI6eyJqUXVlcnkxNzIwNDI0NzE4MTg1NzEyOTY0MDUiOjR9fSx7ImlkIjoxLCJ0aXRsZSI6IjIiLCJkZXNjcmlwdGlvbiI6Ik9uIGEgbWFya2VkIGNhcmQgdXNlIGN0cmwgKzpcbidjJyB0byBjb3B5IHRoZSBjb250ZW50XG4nZCcgdG8gZGVsZXRlIGl0XG4nZScgdG8gZWRpdCBpdFxuJ2EnIHRvIGFyY2hpdmUgb3IgZGVhcmNoaXZlIGRlIGNhcmQiLCJkZXB0aCI6NSwieCI6MzgyLCJ5Ijo3NiwiY29sb3IiOiIjQUVENTgxIiwic2VsZWN0ZWQiOmZhbHNlLCJpc0FyY2hpdmVkIjpmYWxzZSwiaXNEZWxldGVkIjpmYWxzZSwiY3JlYXRlZEF0IjoxNTA3NjQ2NzcxNzQwLCJhcmNoaXZlZEF0IjpudWxsLCJub2RlIjp7ImpRdWVyeTE3MjA0MjQ3MTgxODU3MTI5NjQwNSI6OH19LHsiaWQiOjIsInRpdGxlIjoiZW50ZXJzIiwiZGVzY3JpcHRpb24iOiJXaGlsZSBlZGl0aW5nIHVzZSBzaGlmdCArIGVudGVyIHRvIFxuaW5zZXJ0XG5hXG5saW5lXG5icmVha1xuOkQiLCJkZXB0aCI6NSwieCI6MTU5LCJ5IjozMTIsImNvbG9yIjoiI0ZGQjc0RCIsInNlbGVjdGVkIjpmYWxzZSwiaXNBcmNoaXZlZCI6ZmFsc2UsImlzRGVsZXRlZCI6ZmFsc2UsImNyZWF0ZWRBdCI6MTUwNzY0Njc5MjI5NywiYXJjaGl2ZWRBdCI6bnVsbCwibm9kZSI6eyJqUXVlcnkxNzIwNDI0NzE4MTg1NzEyOTY0MDUiOjZ9fSx7ImlkIjozLCJ0aXRsZSI6IkdlbmVyaWMiLCJkZXNjcmlwdGlvbiI6IllvdSBjYW4gYWxzbyB1c2UgZ2VuZXJpYyBjb21tYW5kcyBzdWNoIGFzIGN0cmwrXG4naScgdG8gY3JlYXRlIGEgY2FyZFxuJ3onIHRvIHJldml2ZSB0aGUgbGFzdCBkZWxldGVkIGNhcmQiLCJkZXB0aCI6NSwieCI6NDQxLCJ5IjoyOTYsImNvbG9yIjoiI0ZGRTA4MiIsInNlbGVjdGVkIjpmYWxzZSwiaXNBcmNoaXZlZCI6ZmFsc2UsImlzRGVsZXRlZCI6ZmFsc2UsImNyZWF0ZWRBdCI6MTUwNzY0ODYzODM4NiwiYXJjaGl2ZWRBdCI6bnVsbCwiaXNQcmlzdGluZSI6ZmFsc2UsIm5vZGUiOnsialF1ZXJ5MTcyMDQyNDcxODE4NTcxMjk2NDA1IjoxMH19XQ',\n  VERSION: '0.5.0',\n};","const CONFIG = require('../config');\n\nlet cardManager,\n    Card = require('../models/Card');\n\nlet mainContainer,\n    editContainer,\n    editInput,\n    titleInput,\n    importContainer,\n    importInput,\n    exportContainer,\n    exportContent,\n    importButton;\n\n\nfunction init(options) {\n    cardManager = options.cardManager;\n    bindings();\n}\n\nfunction bindings() {\n    mainContainer = $('#mainContainer');\n    editContainer = document.getElementById('editContainer');\n    editInput = editContainer.getElementsByClassName('textarea')[0];\n    titleInput = editContainer.getElementsByClassName('input')[0];\n    importContainer = document.getElementById('importContainer');\n    importInput = importContainer.getElementsByClassName('input')[0];\n    importButton = importContainer.getElementsByClassName('button')[0];\n    exportContainer = document.getElementById('exportContainer');\n    exportContent = exportContainer.getElementsByTagName('div')[0];\n\n\n    window.addEventListener('keyup', keyHandlerUp, false);\n    window.addEventListener('keydown', keyHandlerDown, false);\n    editInput.addEventListener('keydown', editInputKeyEvent);\n    titleInput.addEventListener('keydown', editInputKeyEvent);\n    editContainer.addEventListener('click', hideEditContainer);\n    editInput.addEventListener('click', stopPropagation);\n    titleInput.addEventListener('click', stopPropagation);\n    /*\n     On double click edit the card\n     */\n    mainContainer.on('dblclick', 'div', doubleClickHandler);\n    /*\n     On click perform the card\n     */\n    mainContainer.on('click', 'div', cardClickEvents);\n    mainContainer.on('click', 'div > div', cardMenuEvents);\n    document.getElementById('export').addEventListener('click', exportCards);\n    document.getElementById('import').addEventListener('click', showImporter);\n    importButton.addEventListener('click', loadImportCardsCode);\n    importContainer.addEventListener('click', hideImportContainer);\n    importInput.addEventListener('keydown', importInputKeyEvent);\n    importInput.addEventListener('click', stopPropagation);\n    exportContainer.addEventListener('click', hideExportContainer);\n    exportContent.addEventListener('click', stopPropagation);\n}\n\nfunction keyHandlerDown(e) {\n\n    if (e.keyCode === CONFIG.ASCII.TAB_KEY) {\n        document.activeElement.blur();\n        if (event.shiftKey) {\n            cardManager.previousCard();\n        } else {\n            cardManager.nextCard();\n        }\n        if (e.preventDefault) {\n            e.preventDefault();\n        }\n    } else if (e.keyCode === CONFIG.ASCII.CMD_KEY) {\n        window.cmdPress = true;\n    }\n}\n\nfunction keyHandlerUp(e) {\n    console.log(e.keyCode);\n    console.log(document.activeElement);\n    if (document.activeElement !== document.body || CONFIG.ASCII.KEYS_ARRAY.indexOf(e.keyCode) === -1) {\n        return;\n    }\n    e.stopPropagation();\n    e.preventDefault();\n\n    switch (e.keyCode) {\n        case CONFIG.ASCII.C_KEY:\n            if (event.ctrlKey || window.cmdPress) {\n                let elem = cardManager.selectedCard.node,\n                    selection;\n\n                selection = selectText(elem.getElementsByClassName('cardText')[0]);\n                copySelectionText();\n                selection.empty();\n            }\n\n            break;\n        case CONFIG.ASCII.D_KEY:\n            if (event.ctrlKey || window.cmdPress) {\n                let card = cardManager.selectedCard;\n                cardManager.nextCard();\n\n                cardManager.deleteCard(card);\n\n                cardManager.saveCards();\n            }\n            break;\n        case CONFIG.ASCII.E_KEY:\n            if (event.ctrlKey || window.cmdPress) {\n                doubleClickHandler.apply(cardManager.selectedCard.node);\n            }\n            break;\n        case CONFIG.ASCII.A_KEY:\n            if (event.ctrlKey || window.cmdPress) {\n                cardManager.selectedCard.toggleArchived();\n            }\n            break;\n        case CONFIG.ASCII.I_KEY:\n            if (event.ctrlKey || window.cmdPress) {\n                // input.focus();\n                createCard();\n            }\n            break;\n        case CONFIG.ASCII.PLUS_KEY:\n            changeDepth.apply(cardManager.selectedCard.node, [cardManager.selectedCard.id, 1]);\n            break;\n        case CONFIG.ASCII.MINUS_KEY:\n            changeDepth.apply(cardManager.selectedCard.node, [cardManager.selectedCard.id, -1]);\n            break;\n        case CONFIG.ASCII.DOT_KEY:\n            setDepth.apply(cardManager.selectedCard.node, [cardManager.selectedCard.id, 5]);\n            break;\n        case CONFIG.ASCII.R_KEY:\n            cardManager.selectedCard.color = cardManager.selectedCard.getBackgroundColor();\n            cardManager.selectedCard.derender();\n            cardManager.selectedCard.render();\n\n            cardManager.saveCards();\n            break;\n        case CONFIG.ASCII.Z_KEY:\n            if (event.ctrlKey || window.cmdPress) {\n                cardManager.undeleteLastCard();\n            }\n            break;\n        case CONFIG.ASCII.CMD_KEY:\n            window.cmdPress = false;\n    }\n}\n\nfunction hideExportContainer() {\n    exportContainer.style.display = 'none';\n}\n\nfunction hideEditContainer() {\n    editContainer.style.display = 'none';\n}\n\nfunction hideImportContainer() {\n    importContainer.style.display = 'none';\n}\n\nfunction stopPropagation(e) {\n    e.stopPropagation();\n}\n\nfunction editInputKeyEvent(event) {\n    event.stopPropagation();\n    let card;\n    if (event.keyCode === 13 && event.shiftKey) return;\n    if (event.keyCode === 13) {\n        card = cardManager.cards[editContainer.cardId];\n        card.title = titleInput.value;\n        card.description = editInput.value;\n        card.derender();\n        card.render();\n        this.value = '';\n        cardManager.saveCards();\n        hideEditContainer();\n    } else if (event.keyCode === 27) {\n        hideEditContainer();\n    }\n\n}\n\nfunction importInputKeyEvent(event) {\n    if (event.keyCode === 27) {\n        hideImportContainer();\n    }\n}\n\nfunction doubleClickHandler() {\n    let elem = this.querySelector('.cardText'),\n        cardId,\n        card;\n\n    if (this.id === '') {\n        cardId = parseInt(this.parentElement.id.split('_')[1]);\n    } else {\n        cardId = parseInt(this.id.split('_')[1]);\n    }\n\n    card = cardManager.cards[cardId];\n\n    titleInput.value = card.title;\n    editInput.value = card.description;\n    titleInput.style.top = card.y;\n    titleInput.style.left = card.x;\n    editContainer.cardId = cardId;\n    editContainer.style.display = 'block';\n    editInput.style.top = card.y + 23;\n    editInput.style.left = card.x;\n    titleInput.focus();\n}\n\nfunction cardClickEvents(event) {\n    let elem = this.querySelector('.cardText'),\n        cardId,\n        card;\n\n    if (this.id === \"\") {\n        cardId = parseInt(this.parentElement.id.split('_')[1]);\n    } else {\n        cardId = parseInt(this.id.split('_')[1]);\n    }\n\n    card = cardManager.cards[cardId];\n\n    if (card === undefined) return;\n\n    cardManager.selectCard(card.id);\n\n    if (event.ctrlKey) {\n    }\n    if (event.altKey) {\n        this.querySelector('.copy').click();\n    }\n    if (event.shiftKey) {\n\n    }\n}\n\nfunction cardMenuEvents() {\n    let option = $(this).html(),\n        selection,\n        cardId = getParentCardId(this);\n\n    switch (option) {\n        case '+':\n            changeDepth.apply(this, [cardId, 1]);\n            break;\n        case '-':\n            changeDepth.apply(this, [cardId, -1]);\n            break;\n        case 'C':\n            selection = selectText(this.parentElement.getElementsByClassName('cardText')[0]);\n            copySelectionText();\n            selection.empty();\n            break;\n        case 'x':\n            cardManager.deleteCard(cardManager.cards[cardId]);\n            break;\n        case 'V':\n        case 'O':\n            cardManager.cards[cardId].toggleArchived();\n    }\n    cardManager.saveCards();\n}\n\nfunction exportCards() {\n    exportContainer.style.display = 'block';\n    exportContent.innerHTML = cardManager.exportCards();\n    selection = selectText(exportContent);\n    copySelectionText();\n    selection.empty();\n}\n\nfunction loadImportCardsCode() {\n    let data = importInput.value;\n    cardManager.importCards(data);\n    importContainer.style.display = 'none';\n}\n\nfunction showImporter() {\n    importContainer.style.display = 'block';\n    importInput.focus();\n}\n\nfunction createCard() {\n    const card = cardManager.addCard(Object.create(Card, {}).init(''));\n    card.render();\n    cardManager.selectCard(card.id);\n\n    // and now we autoedit :D\n    doubleClickHandler.apply(card.node);\n}\n\nmodule.exports = {\n    init: init\n};","\nvar subs = {};\n\n\nfunction pub(name, params) {\n  subs[name].forEach(function(elem) {\n    elem.callback.apply(elem.context, params);\n  });\n}\n\nfunction sub(name, callback, context) {\n  if (subs[name] === undefined) {\n    subs[name] = [];\n  }\n\n  subs[name].push({\n    callback: callback,\n    context: context\n  });\n}\n\n\nmodule.exports = {\n  pub: pub,\n  sub: sub\n};","window.CONFIG = require('./config.js');\n\nlet keyHandler = require('./lib/keyHandler'),\n  cardManager = require('./models/CardManager').getInstance(),\n  pubsub = require('./lib/pubsub');\n\nwindow.cm = {\n  cardManager: cardManager\n};\n\nObject.assign(window, require('./prototypes'));\n\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  'strict mode';\n\n  keyHandler.init({\n    cardManager: cardManager\n  });\n\n  cardManager.loadCards();\n  cardManager.renderAllCards();\n});\n","let pubsub = require('../lib/pubsub'),\n    randomMC = require('random-material-color');\n\n\nlet Card = {\n    init: function(title, description, pristine) {\n        this.id = -1;\n        this.title = title;\n        this.description = description;\n        this.depth = 5;\n        this.x = 100;\n        this.y = 100;\n        this.color = this.getBackgroundColor();\n        this.selected = false;\n        this.isArchived = false;\n        this.isDeleted = false;\n        this.createdAt = +new Date();\n        this.archivedAt = null;\n        this.isPristine = true;\n\n        return this;\n    },\n    render: function(always = false) {\n        if (this.isDeleted === true && always === false) {\n            return;\n        }\n\n        let node = document.createElement('div'),\n            title = document.createElement('div'),\n            text = document.createElement('div'),\n            link = this.findLink(),\n            that = this;\n\n        if (this.title) {\n            title.innerHTML = this.title;\n        }\n\n        if (this.description) {\n            text.innerHTML = this.description.replace(/\\r?\\n/g, '<br/>');\n        }\n\n        title.className = 'cardTitle';\n        text.className = 'cardText';\n\n        node.id = 'todo_' + this.id;\n        node.className = 'card card-1';\n        node.style.position = 'fixed';\n        node.style.left = this.x;\n        node.style.top = this.y;\n        node.style.cursor = '-webkit-grab';\n        node.style.zIndex = this.depth;\n        node.style.backgroundColor = this.color;\n\n        document.getElementById('mainContainer').appendChild(node);\n\n        node.appendChild(createDiv('x', 'control remove'));\n        // node.appendChild(createDiv('+', 'control up'));\n        // node.appendChild(createDiv('-', 'control down'));\n        node.appendChild(createDiv('C', 'control copy'));\n        node.appendChild(createDiv('depth: ' + this.depth, 'depth'));\n        // node.appendChild(createDiv(this.isArchived ? 'V' : 'O', 'isArchived'));\n        node.appendChild(createDiv('id: ' + this.id, 'id'));\n        if (link) {\n            node.appendChild(createDiv(`<a target=\"_blank\" href=\"${link}\">Link!</a>`, 'link'));\n        }\n\n        node.appendChild(title);\n        node.appendChild(text);\n\n        $('#todo_' + this.id).draggable({\n            stop: function() {\n                let card = $('#todo_' + that.id);\n\n                if (that.isPristine === true) {\n                    that.isPristine = false;\n\n                    pubsub.pub(window.CONFIG.LESS_PRISTINE);\n                }\n\n                that.x = + card.css('left').replace('px', '');\n                that.y = + card.css('top').replace('px', '');\n\n                pubsub.pub(window.CONFIG.SELECT_CARD, [that.id]);\n                pubsub.pub(window.CONFIG.SAVE_CARDS);\n            },\n        });\n\n        this.node = node;\n\n\n        if (this.selected === true) {\n            node.classList.add('selected');\n        }\n\n        if (this.isArchived) {\n            node.classList.add('completed');\n        }\n\n        return this;\n    },\n    getBackgroundColor: function() {\n        return randomMC.getColor({shades: ['200', '300']});\n    },\n    derender: function() {\n        let node = document.getElementById('todo_' + this.id);\n        document.getElementById('mainContainer').removeChild(node);\n\n        return this;\n    },\n    toggleArchived: function() {\n        if (this.isArchived === false || this.isArchived === undefined) {\n            this.node.classList.remove('notCompleted');\n            void this.node.offsetWidth;\n            this.node.classList.add('completed');\n            this.archivedAt = +new Date();\n        } else {\n            this.node.classList.remove('completed');\n            void this.node.offsetWidth;\n            this.node.classList.add('notCompleted');\n            this.archivedAt = null;\n        }\n\n        this.isArchived = !this.isArchived;\n\n        pubsub.pub(window.CONFIG.SAVE_CARDS);\n    },\n    delete: function() {\n        this.isDeleted = true;\n\n        this.derender();\n    },\n    undelete: function() {\n        this.isDeleted = false;\n\n        this.render();\n\n        return this;\n    },\n    findLink: function() {\n        const regex = /(https?:\\/\\/[^\\s]+|www.[^\\s]+)/;\n        const link = regex.exec(this.title);\n\n        if (link) {\n            return link[0];\n        }\n    }\n};\n\nmodule.exports = Card;","const Card = require('./Card'),\n    pubsub = require('../lib/pubsub'),\n    CONFIG = require('../config');\n\nlet CardManager = {\n    init: function() {\n        this.cards = [];\n        this.selectedCard = {id: -1};\n        this.deletedCards = [];\n        this.pristine = 0;\n\n        return this;\n    },\n    addCard: function(card) {\n        this.cards.push(card);\n        card.id = this.cards.length - 1;\n\n        card.x = card.x + this.pristine * 10;\n        card.y = card.y + this.pristine * 10;\n\n        this.pristine++;\n\n        return card;\n    },\n    removeCard: function(id) {\n        this.cards[id].derender();\n        this.cards[id] = undefined;\n\n        return this;\n    },\n    redrawCard: function(cardId, x, y) {\n        let card = this.cards[cardId];\n        card.x = x;\n        card.y = y;\n\n        card.derender();\n        card.render();\n\n        return this;\n    },\n    saveCards: function() {\n        if (typeof(Storage) !== 'undefined') {\n            localStorage.setItem('cards', JSON.stringify(this.cards));\n        } else {\n            console.log('you don\\'t have local storage :(');\n        }\n\n        this.persistSelectedCard();\n        this.persistDeletedCards();\n\n        return this;\n    },\n    loadCards: function() {\n        this.cards = JSON.parse(localStorage.getItem('cards'));\n\n        if (this.cards === null) {\n            this.cards = JSON.parse(atob(CONFIG.DEFAULT_CONTENT));\n        }\n\n        this.clearArray();\n\n        this.loadSelectedCard();\n        this.loadDeletedCards();\n\n        document.activeElement.blur();\n\n        return this;\n    },\n    clearArray: function() {\n        let i;\n\n        this.cards = this.cards.filter(function(elem) {\n            return elem !== undefined && elem !== null;\n        });\n        for (i in this.cards) {\n            if (this.cards.hasOwnProperty(i)) {\n                this.cards[+i].id = +i;\n            }\n        }\n\n        return this;\n    },\n    reRenderAllCards: function() {\n        this.cards.forEach((card) => {\n            card.derender();\n        });\n        this.renderAllCards();\n    },\n    renderAllCards: function() {\n\n        this.cards.forEach((card) => {\n                card.selected = this.selectedCard && (this.selectedCard.id === card.id);\n                Object.setPrototypeOf(card, Card);\n                card.render();\n            }\n        );\n\n        return this;\n    },\n    getInstance: function() {\n        if (CardManager.instance === undefined) {\n            CardManager.instance = Object.create(CardManager, {});\n            CardManager.instance.init();\n            pubsub.sub(window.CONFIG.SAVE_CARDS, CardManager.instance.saveCards, CardManager.instance);\n            pubsub.sub(window.CONFIG.SELECT_CARD, CardManager.instance.selectCard, CardManager.instance);\n            pubsub.sub(window.CONFIG.RERENDER, CardManager.instance.reRenderAllCards, CardManager.instance);\n            pubsub.sub(window.CONFIG.LESS_PRISTINE, CardManager.instance.lessPristine, CardManager.instance);\n        }\n\n        return CardManager.instance;\n\n    },\n    lessPristine: function() {\n        this.pristine--;\n    },\n    exportCards: function() {\n        return btoa(JSON.stringify(this.cards));\n    },\n    importCards: function(data) {\n        localStorage.setItem('cards', atob(data));\n        this.loadCards();\n        this.renderAllCards();\n    },\n    selectCard: function(cardId) {\n        if (this.selectedCard !== undefined && this.selectedCard.node.classList !== undefined) {\n            this.selectedCard.node.classList.remove('selected');\n        }\n        this.selectedCard = this.cards[cardId];\n\n        this.selectedCard.node.classList.add('selected');\n\n        this.persistSelectedCard();\n        document.activeElement.blur();\n    },\n    nextCard: function() {\n        let it = +this.selectedCard.id + 1;\n\n        while (it !== +this.selectedCard.id) {\n            if (this.cards[it] !== undefined && this.cards[it].isDeleted !== true) {\n                break;\n            }\n            if (++it >= this.cards.length) {\n                it = 0;\n            }\n        }\n\n        this.selectCard(it);\n    },\n    previousCard: function() {\n        let it = +this.selectedCard.id - 1;\n\n        while (it !== +this.selectedCard.id) {\n            if (this.cards[it] !== undefined) {\n                break;\n            }\n            if (--it <= 0) {\n                it = this.cards.length;\n            }\n        }\n\n        this.selectCard(it);\n    },\n    persistSelectedCard: function() {\n        if (this.selectedCard && this.selectedCard.id > -1) {\n            localStorage.setItem('selectedCard', this.selectedCard.id);\n        }\n    },\n    loadSelectedCard: function() {\n        let selectedCardId = +localStorage.getItem('selectedCard');\n\n        if (selectedCardId !== undefined && selectedCardId > -1) {\n            this.selectedCard = this.cards[selectedCardId];\n        }\n    },\n    persistDeletedCards: function() {\n        localStorage.setItem('deletedCards', JSON.stringify(this.deletedCards));\n    },\n    loadDeletedCards: function() {\n        console.log(localStorage.getItem('deletedCards'));\n        this.deletedCards = JSON.parse(localStorage.getItem('deletedCards')) || [];\n\n    },\n    deleteCard: function(card) {\n        this.deletedCards.push(card.id);\n\n        card.delete();\n    },\n    undeleteLastCard: function() {\n        if (this.deletedCards.length === 0) {\n            return;\n        }\n\n        this.selectCard(this.cards[this.deletedCards.splice(this.deletedCards.length - 1)].undelete().id);\n\n        this.saveCards();\n    }\n};\n\nmodule.exports = CardManager;","let cardManager = require('./models/CardManager').getInstance();\n\nfunction createDiv(text, className) {\n    let div = document.createElement('div');\n    div.innerHTML = text;\n    div.style.float = \"right\";\n    div.style.cursor = \"pointer\";\n    div.style.width = \"auto\";\n    div.style.textAlign = \"center\";\n    div.style.margin = \"0 3px\";\n\n    if (className !== undefined) {\n        div.className = className;\n    }\n\n    return div;\n}\n\nfunction copySelectionText() {\n    let copysuccess; // let to check whether execCommand successfully executed\n    try {\n        copysuccess = document.execCommand(\"copy\"); // run command to copy selected text to clipboard\n    } catch (e) {\n        copysuccess = false\n    }\n    return copysuccess\n}\n\nfunction selectText(element) {\n    let doc = document\n        , text = element\n        , range, selection\n    ;\n    if (doc.body.createTextRange) {\n        range = document.body.createTextRange();\n        range.moveToElementText(text);\n        range.select();\n    } else if (window.getSelection) {\n        selection = window.getSelection();\n        range = document.createRange();\n        range.selectNodeContents(text);\n        selection.removeAllRanges();\n        selection.addRange(range);\n        return selection;\n    }\n}\n\nfunction getParentCardId(context) {\n    if (context.parentElement === null) return;\n    return parseInt(context.parentElement.id.split(\"_\")[1]);\n}\n\nfunction getSomethingByclassName(context, classname) {\n    let res = context.getElementsByClassName(classname);\n\n    if (res.length === 0) {\n        res = context.parentElement.getElementsByClassName(classname);\n    }\n\n    return res;\n}\n\nfunction changeDepth(cardId, increment) {\n    let depth = cardManager.cards[cardId].depth + increment;\n\n    this.style.zIndex = depth;\n    cardManager.cards[cardId].depth = depth;\n\n    let elem = getSomethingByclassName(this, 'depth');\n    elem[0].innerHTML = depth;\n}\n\nfunction setDepth(cardId, depth) {\n    this.style.zIndex = depth;\n    cardManager.cards[cardId].depth = depth;\n\n    let elem = getSomethingByclassName(this, 'depth');\n    elem[0].innerHTML = depth;\n}\n\nfunction getCardHTMLById(mainContainer, id) {\n    return mainContainer.getElementById('todo_' + id);\n}\n\n// PROTOTYPES\n\n/*\n * Returns the size of an array\n */\nArray.prototype.size = function() {\n    return this.filter(function(a) {\n        return a !== undefined;\n    }).length\n};\n\n/*\n * Returns the size of an object\n */\nObject.size = function(obj) {\n    let size = 0, key = \"\";\n\n    for (key in obj) {\n        if (obj.hasOwnProperty(key)) size++;\n    }\n    return size;\n};\n\nmodule.exports = {\n    createDiv: createDiv,\n    copySelectionText: copySelectionText,\n    selectText: selectText,\n    getParentCardId: getParentCardId,\n    changeDepth: changeDepth,\n    setDepth: setDepth,\n    getCardHTMLById: getCardHTMLById\n};"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvbXVybXVyaGFzaC1qcy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9tdXJtdXJoYXNoLWpzL211cm11cmhhc2gyX2djLmpzIiwibm9kZV9tb2R1bGVzL211cm11cmhhc2gtanMvbXVybXVyaGFzaDNfZ2MuanMiLCJub2RlX21vZHVsZXMvcmFuZG9tLW1hdGVyaWFsLWNvbG9yL2Rpc3QvcmFuZG9tQ29sb3IuanMiLCJzcmMvanMvY29uZmlnLmpzIiwic3JjL2pzL2xpYi9rZXlIYW5kbGVyLmpzIiwic3JjL2pzL2xpYi9wdWJzdWIuanMiLCJzcmMvanMvbWFpbi5qcyIsInNyYy9qcy9tb2RlbHMvQ2FyZC5qcyIsInNyYy9qcy9tb2RlbHMvQ2FyZE1hbmFnZXIuanMiLCJzcmMvanMvcHJvdG90eXBlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3REQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25FQTs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdE1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwidmFyIG11cm11cjMgPSByZXF1aXJlKFwiLi9tdXJtdXJoYXNoM19nYy5qc1wiKVxudmFyIG11cm11cjIgPSByZXF1aXJlKFwiLi9tdXJtdXJoYXNoMl9nYy5qc1wiKVxuXG5tb2R1bGUuZXhwb3J0cyA9IG11cm11cjNcbm1vZHVsZS5leHBvcnRzLm11cm11cjMgPSBtdXJtdXIzXG5tb2R1bGUuZXhwb3J0cy5tdXJtdXIyID0gbXVybXVyMlxuIiwiLyoqXG4gKiBKUyBJbXBsZW1lbnRhdGlvbiBvZiBNdXJtdXJIYXNoMlxuICogXG4gKiBAYXV0aG9yIDxhIGhyZWY9XCJtYWlsdG86Z2FyeS5jb3VydEBnbWFpbC5jb21cIj5HYXJ5IENvdXJ0PC9hPlxuICogQHNlZSBodHRwOi8vZ2l0aHViLmNvbS9nYXJ5Y291cnQvbXVybXVyaGFzaC1qc1xuICogQGF1dGhvciA8YSBocmVmPVwibWFpbHRvOmFhcHBsZWJ5QGdtYWlsLmNvbVwiPkF1c3RpbiBBcHBsZWJ5PC9hPlxuICogQHNlZSBodHRwOi8vc2l0ZXMuZ29vZ2xlLmNvbS9zaXRlL211cm11cmhhc2gvXG4gKiBcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgQVNDSUkgb25seVxuICogQHBhcmFtIHtudW1iZXJ9IHNlZWQgUG9zaXRpdmUgaW50ZWdlciBvbmx5XG4gKiBAcmV0dXJuIHtudW1iZXJ9IDMyLWJpdCBwb3NpdGl2ZSBpbnRlZ2VyIGhhc2hcbiAqL1xuXG5mdW5jdGlvbiBtdXJtdXJoYXNoMl8zMl9nYyhzdHIsIHNlZWQpIHtcbiAgdmFyXG4gICAgbCA9IHN0ci5sZW5ndGgsXG4gICAgaCA9IHNlZWQgXiBsLFxuICAgIGkgPSAwLFxuICAgIGs7XG4gIFxuICB3aGlsZSAobCA+PSA0KSB7XG4gIFx0ayA9IFxuICBcdCAgKChzdHIuY2hhckNvZGVBdChpKSAmIDB4ZmYpKSB8XG4gIFx0ICAoKHN0ci5jaGFyQ29kZUF0KCsraSkgJiAweGZmKSA8PCA4KSB8XG4gIFx0ICAoKHN0ci5jaGFyQ29kZUF0KCsraSkgJiAweGZmKSA8PCAxNikgfFxuICBcdCAgKChzdHIuY2hhckNvZGVBdCgrK2kpICYgMHhmZikgPDwgMjQpO1xuICAgIFxuICAgIGsgPSAoKChrICYgMHhmZmZmKSAqIDB4NWJkMWU5OTUpICsgKCgoKGsgPj4+IDE2KSAqIDB4NWJkMWU5OTUpICYgMHhmZmZmKSA8PCAxNikpO1xuICAgIGsgXj0gayA+Pj4gMjQ7XG4gICAgayA9ICgoKGsgJiAweGZmZmYpICogMHg1YmQxZTk5NSkgKyAoKCgoayA+Pj4gMTYpICogMHg1YmQxZTk5NSkgJiAweGZmZmYpIDw8IDE2KSk7XG5cblx0aCA9ICgoKGggJiAweGZmZmYpICogMHg1YmQxZTk5NSkgKyAoKCgoaCA+Pj4gMTYpICogMHg1YmQxZTk5NSkgJiAweGZmZmYpIDw8IDE2KSkgXiBrO1xuXG4gICAgbCAtPSA0O1xuICAgICsraTtcbiAgfVxuICBcbiAgc3dpdGNoIChsKSB7XG4gIGNhc2UgMzogaCBePSAoc3RyLmNoYXJDb2RlQXQoaSArIDIpICYgMHhmZikgPDwgMTY7XG4gIGNhc2UgMjogaCBePSAoc3RyLmNoYXJDb2RlQXQoaSArIDEpICYgMHhmZikgPDwgODtcbiAgY2FzZSAxOiBoIF49IChzdHIuY2hhckNvZGVBdChpKSAmIDB4ZmYpO1xuICAgICAgICAgIGggPSAoKChoICYgMHhmZmZmKSAqIDB4NWJkMWU5OTUpICsgKCgoKGggPj4+IDE2KSAqIDB4NWJkMWU5OTUpICYgMHhmZmZmKSA8PCAxNikpO1xuICB9XG5cbiAgaCBePSBoID4+PiAxMztcbiAgaCA9ICgoKGggJiAweGZmZmYpICogMHg1YmQxZTk5NSkgKyAoKCgoaCA+Pj4gMTYpICogMHg1YmQxZTk5NSkgJiAweGZmZmYpIDw8IDE2KSk7XG4gIGggXj0gaCA+Pj4gMTU7XG5cbiAgcmV0dXJuIGggPj4+IDA7XG59XG5cbmlmKHR5cGVvZiBtb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuICBtb2R1bGUuZXhwb3J0cyA9IG11cm11cmhhc2gyXzMyX2djXG59XG4iLCIvKipcbiAqIEpTIEltcGxlbWVudGF0aW9uIG9mIE11cm11ckhhc2gzIChyMTM2KSAoYXMgb2YgTWF5IDIwLCAyMDExKVxuICogXG4gKiBAYXV0aG9yIDxhIGhyZWY9XCJtYWlsdG86Z2FyeS5jb3VydEBnbWFpbC5jb21cIj5HYXJ5IENvdXJ0PC9hPlxuICogQHNlZSBodHRwOi8vZ2l0aHViLmNvbS9nYXJ5Y291cnQvbXVybXVyaGFzaC1qc1xuICogQGF1dGhvciA8YSBocmVmPVwibWFpbHRvOmFhcHBsZWJ5QGdtYWlsLmNvbVwiPkF1c3RpbiBBcHBsZWJ5PC9hPlxuICogQHNlZSBodHRwOi8vc2l0ZXMuZ29vZ2xlLmNvbS9zaXRlL211cm11cmhhc2gvXG4gKiBcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgQVNDSUkgb25seVxuICogQHBhcmFtIHtudW1iZXJ9IHNlZWQgUG9zaXRpdmUgaW50ZWdlciBvbmx5XG4gKiBAcmV0dXJuIHtudW1iZXJ9IDMyLWJpdCBwb3NpdGl2ZSBpbnRlZ2VyIGhhc2ggXG4gKi9cblxuZnVuY3Rpb24gbXVybXVyaGFzaDNfMzJfZ2Moa2V5LCBzZWVkKSB7XG5cdHZhciByZW1haW5kZXIsIGJ5dGVzLCBoMSwgaDFiLCBjMSwgYzFiLCBjMiwgYzJiLCBrMSwgaTtcblx0XG5cdHJlbWFpbmRlciA9IGtleS5sZW5ndGggJiAzOyAvLyBrZXkubGVuZ3RoICUgNFxuXHRieXRlcyA9IGtleS5sZW5ndGggLSByZW1haW5kZXI7XG5cdGgxID0gc2VlZDtcblx0YzEgPSAweGNjOWUyZDUxO1xuXHRjMiA9IDB4MWI4NzM1OTM7XG5cdGkgPSAwO1xuXHRcblx0d2hpbGUgKGkgPCBieXRlcykge1xuXHQgIFx0azEgPSBcblx0ICBcdCAgKChrZXkuY2hhckNvZGVBdChpKSAmIDB4ZmYpKSB8XG5cdCAgXHQgICgoa2V5LmNoYXJDb2RlQXQoKytpKSAmIDB4ZmYpIDw8IDgpIHxcblx0ICBcdCAgKChrZXkuY2hhckNvZGVBdCgrK2kpICYgMHhmZikgPDwgMTYpIHxcblx0ICBcdCAgKChrZXkuY2hhckNvZGVBdCgrK2kpICYgMHhmZikgPDwgMjQpO1xuXHRcdCsraTtcblx0XHRcblx0XHRrMSA9ICgoKChrMSAmIDB4ZmZmZikgKiBjMSkgKyAoKCgoazEgPj4+IDE2KSAqIGMxKSAmIDB4ZmZmZikgPDwgMTYpKSkgJiAweGZmZmZmZmZmO1xuXHRcdGsxID0gKGsxIDw8IDE1KSB8IChrMSA+Pj4gMTcpO1xuXHRcdGsxID0gKCgoKGsxICYgMHhmZmZmKSAqIGMyKSArICgoKChrMSA+Pj4gMTYpICogYzIpICYgMHhmZmZmKSA8PCAxNikpKSAmIDB4ZmZmZmZmZmY7XG5cblx0XHRoMSBePSBrMTtcbiAgICAgICAgaDEgPSAoaDEgPDwgMTMpIHwgKGgxID4+PiAxOSk7XG5cdFx0aDFiID0gKCgoKGgxICYgMHhmZmZmKSAqIDUpICsgKCgoKGgxID4+PiAxNikgKiA1KSAmIDB4ZmZmZikgPDwgMTYpKSkgJiAweGZmZmZmZmZmO1xuXHRcdGgxID0gKCgoaDFiICYgMHhmZmZmKSArIDB4NmI2NCkgKyAoKCgoaDFiID4+PiAxNikgKyAweGU2NTQpICYgMHhmZmZmKSA8PCAxNikpO1xuXHR9XG5cdFxuXHRrMSA9IDA7XG5cdFxuXHRzd2l0Y2ggKHJlbWFpbmRlcikge1xuXHRcdGNhc2UgMzogazEgXj0gKGtleS5jaGFyQ29kZUF0KGkgKyAyKSAmIDB4ZmYpIDw8IDE2O1xuXHRcdGNhc2UgMjogazEgXj0gKGtleS5jaGFyQ29kZUF0KGkgKyAxKSAmIDB4ZmYpIDw8IDg7XG5cdFx0Y2FzZSAxOiBrMSBePSAoa2V5LmNoYXJDb2RlQXQoaSkgJiAweGZmKTtcblx0XHRcblx0XHRrMSA9ICgoKGsxICYgMHhmZmZmKSAqIGMxKSArICgoKChrMSA+Pj4gMTYpICogYzEpICYgMHhmZmZmKSA8PCAxNikpICYgMHhmZmZmZmZmZjtcblx0XHRrMSA9IChrMSA8PCAxNSkgfCAoazEgPj4+IDE3KTtcblx0XHRrMSA9ICgoKGsxICYgMHhmZmZmKSAqIGMyKSArICgoKChrMSA+Pj4gMTYpICogYzIpICYgMHhmZmZmKSA8PCAxNikpICYgMHhmZmZmZmZmZjtcblx0XHRoMSBePSBrMTtcblx0fVxuXHRcblx0aDEgXj0ga2V5Lmxlbmd0aDtcblxuXHRoMSBePSBoMSA+Pj4gMTY7XG5cdGgxID0gKCgoaDEgJiAweGZmZmYpICogMHg4NWViY2E2YikgKyAoKCgoaDEgPj4+IDE2KSAqIDB4ODVlYmNhNmIpICYgMHhmZmZmKSA8PCAxNikpICYgMHhmZmZmZmZmZjtcblx0aDEgXj0gaDEgPj4+IDEzO1xuXHRoMSA9ICgoKChoMSAmIDB4ZmZmZikgKiAweGMyYjJhZTM1KSArICgoKChoMSA+Pj4gMTYpICogMHhjMmIyYWUzNSkgJiAweGZmZmYpIDw8IDE2KSkpICYgMHhmZmZmZmZmZjtcblx0aDEgXj0gaDEgPj4+IDE2O1xuXG5cdHJldHVybiBoMSA+Pj4gMDtcbn1cblxuaWYodHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIikge1xuICBtb2R1bGUuZXhwb3J0cyA9IG11cm11cmhhc2gzXzMyX2djXG59IiwidmFyIGRlZmF1bHRQYWxldHRlPXs1MDpbXCIjRkZFQkVFXCIsXCIjRkNFNEVDXCIsXCIjRjNFNUY1XCIsXCIjRURFN0Y2XCIsXCIjRThFQUY2XCIsXCIjRTNGMkZEXCIsXCIjRTFGNUZFXCIsXCIjRTBGN0ZBXCIsXCIjRTBGMkYxXCIsXCIjRThGNUU5XCIsXCIjRjFGOEU5XCIsXCIjRjlGQkU3XCIsXCIjRkZGREU3XCIsXCIjRkZGOEUxXCIsXCIjRkZGM0UwXCIsXCIjRkJFOUU3XCIsXCIjRUZFQkU5XCIsXCIjRkFGQUZBXCIsXCIjRUNFRkYxXCJdLDEwMDpbXCIjRkZDREQyXCIsXCIjRjhCQkQwXCIsXCIjRTFCRUU3XCIsXCIjRDFDNEU5XCIsXCIjQzVDQUU5XCIsXCIjQkJERUZCXCIsXCIjQjNFNUZDXCIsXCIjQjJFQkYyXCIsXCIjQjJERkRCXCIsXCIjQzhFNkM5XCIsXCIjRENFREM4XCIsXCIjRjBGNEMzXCIsXCIjRkZGOUM0XCIsXCIjRkZFQ0IzXCIsXCIjRkZFMEIyXCIsXCIjRkZDQ0JDXCIsXCIjRDdDQ0M4XCIsXCIjRjVGNUY1XCIsXCIjQ0ZEOERDXCJdLDIwMDpbXCIjRUY5QTlBXCIsXCIjRjQ4RkIxXCIsXCIjQ0U5M0Q4XCIsXCIjQjM5RERCXCIsXCIjOUZBOERBXCIsXCIjOTBDQUY5XCIsXCIjODFENEZBXCIsXCIjODBERUVBXCIsXCIjODBDQkM0XCIsXCIjQTVENkE3XCIsXCIjQzVFMUE1XCIsXCIjRTZFRTlDXCIsXCIjRkZGNTlEXCIsXCIjRkZFMDgyXCIsXCIjRkZDQzgwXCIsXCIjRkZBQjkxXCIsXCIjQkNBQUE0XCIsXCIjRUVFRUVFXCIsXCIjQjBCRUM1XCJdLDMwMDpbXCIjRTU3MzczXCIsXCIjRjA2MjkyXCIsXCIjQkE2OEM4XCIsXCIjOTU3NUNEXCIsXCIjNzk4NkNCXCIsXCIjNjRCNUY2XCIsXCIjNEZDM0Y3XCIsXCIjNEREMEUxXCIsXCIjNERCNkFDXCIsXCIjODFDNzg0XCIsXCIjQUVENTgxXCIsXCIjRENFNzc1XCIsXCIjRkZGMTc2XCIsXCIjRkZENTRGXCIsXCIjRkZCNzREXCIsXCIjRkY4QTY1XCIsXCIjQTE4ODdGXCIsXCIjRTBFMEUwXCIsXCIjOTBBNEFFXCJdLDQwMDpbXCIjRUY1MzUwXCIsXCIjRUM0MDdBXCIsXCIjQUI0N0JDXCIsXCIjN0U1N0MyXCIsXCIjNUM2QkMwXCIsXCIjNDJBNUY1XCIsXCIjMjlCNkY2XCIsXCIjMjZDNkRBXCIsXCIjMjZBNjlBXCIsXCIjNjZCQjZBXCIsXCIjOUNDQzY1XCIsXCIjRDRFMTU3XCIsXCIjRkZFRTU4XCIsXCIjRkZDQTI4XCIsXCIjRkZBNzI2XCIsXCIjRkY3MDQzXCIsXCIjOEQ2RTYzXCIsXCIjQkRCREJEXCIsXCIjNzg5MDlDXCJdLDUwMDpbXCIjRjQ0MzM2XCIsXCIjRTkxRTYzXCIsXCIjOUMyN0IwXCIsXCIjNjczQUI3XCIsXCIjM0Y1MUI1XCIsXCIjMjE5NkYzXCIsXCIjMDNBOUY0XCIsXCIjMDBCQ0Q0XCIsXCIjMDA5Njg4XCIsXCIjNENBRjUwXCIsXCIjOEJDMzRBXCIsXCIjQ0REQzM5XCIsXCIjRkZFQjNCXCIsXCIjRkZDMTA3XCIsXCIjRkY5ODAwXCIsXCIjRkY1NzIyXCIsXCIjNzk1NTQ4XCIsXCIjOUU5RTlFXCIsXCIjNjA3RDhCXCJdLDYwMDpbXCIjRTUzOTM1XCIsXCIjRDgxQjYwXCIsXCIjOEUyNEFBXCIsXCIjNUUzNUIxXCIsXCIjMzk0OUFCXCIsXCIjMUU4OEU1XCIsXCIjMDM5QkU1XCIsXCIjMDBBQ0MxXCIsXCIjMDA4OTdCXCIsXCIjNDNBMDQ3XCIsXCIjN0NCMzQyXCIsXCIjQzBDQTMzXCIsXCIjRkREODM1XCIsXCIjRkZCMzAwXCIsXCIjRkI4QzAwXCIsXCIjRjQ1MTFFXCIsXCIjNkQ0QzQxXCIsXCIjNzU3NTc1XCIsXCIjNTQ2RTdBXCJdLDcwMDpbXCIjRDMyRjJGXCIsXCIjQzIxODVCXCIsXCIjN0IxRkEyXCIsXCIjNTEyREE4XCIsXCIjMzAzRjlGXCIsXCIjMTk3NkQyXCIsXCIjMDI4OEQxXCIsXCIjMDA5N0E3XCIsXCIjMDA3OTZCXCIsXCIjMzg4RTNDXCIsXCIjNjg5RjM4XCIsXCIjQUZCNDJCXCIsXCIjRkJDMDJEXCIsXCIjRkZBMDAwXCIsXCIjRjU3QzAwXCIsXCIjRTY0QTE5XCIsXCIjNUQ0MDM3XCIsXCIjNjE2MTYxXCIsXCIjNDU1QTY0XCJdLDgwMDpbXCIjQzYyODI4XCIsXCIjQUQxNDU3XCIsXCIjNkExQjlBXCIsXCIjNDUyN0EwXCIsXCIjMjgzNTkzXCIsXCIjMTU2NUMwXCIsXCIjMDI3N0JEXCIsXCIjMDA4MzhGXCIsXCIjMDA2OTVDXCIsXCIjMkU3RDMyXCIsXCIjNTU4QjJGXCIsXCIjOUU5RDI0XCIsXCIjRjlBODI1XCIsXCIjRkY4RjAwXCIsXCIjRUY2QzAwXCIsXCIjRDg0MzE1XCIsXCIjNEUzNDJFXCIsXCIjNDI0MjQyXCIsXCIjMzc0NzRGXCJdLDkwMDpbXCIjQjcxQzFDXCIsXCIjODgwRTRGXCIsXCIjNEExNDhDXCIsXCIjMzExQjkyXCIsXCIjMUEyMzdFXCIsXCIjMEQ0N0ExXCIsXCIjMDE1NzlCXCIsXCIjMDA2MDY0XCIsXCIjMDA0RDQwXCIsXCIjMUI1RTIwXCIsXCIjMzM2OTFFXCIsXCIjODI3NzE3XCIsXCIjRjU3RjE3XCIsXCIjRkY2RjAwXCIsXCIjRTY1MTAwXCIsXCIjQkYzNjBDXCIsXCIjM0UyNzIzXCIsXCIjMjEyMTIxXCIsXCIjMjYzMjM4XCJdLEExMDA6W1wiI0ZGOEE4MFwiLFwiI0ZGODBBQlwiLFwiI0VBODBGQ1wiLFwiI0IzODhGRlwiLFwiIzhDOUVGRlwiLFwiIzgyQjFGRlwiLFwiIzgwRDhGRlwiLFwiIzg0RkZGRlwiLFwiI0E3RkZFQlwiLFwiI0I5RjZDQVwiLFwiI0NDRkY5MFwiLFwiI0Y0RkY4MVwiLFwiI0ZGRkY4RFwiLFwiI0ZGRTU3RlwiLFwiI0ZGRDE4MFwiLFwiI0ZGOUU4MFwiXSxBMjAwOltcIiNGRjUyNTJcIixcIiNGRjQwODFcIixcIiNFMDQwRkJcIixcIiM3QzRERkZcIixcIiM1MzZERkVcIixcIiM0NDhBRkZcIixcIiM0MEM0RkZcIixcIiMxOEZGRkZcIixcIiM2NEZGREFcIixcIiM2OUYwQUVcIixcIiNCMkZGNTlcIixcIiNFRUZGNDFcIixcIiNGRkZGMDBcIixcIiNGRkQ3NDBcIixcIiNGRkFCNDBcIixcIiNGRjZFNDBcIl0sQTQwMDpbXCIjRkYxNzQ0XCIsXCIjRjUwMDU3XCIsXCIjRDUwMEY5XCIsXCIjNjUxRkZGXCIsXCIjM0Q1QUZFXCIsXCIjMjk3OUZGXCIsXCIjMDBCMEZGXCIsXCIjMDBFNUZGXCIsXCIjMURFOUI2XCIsXCIjMDBFNjc2XCIsXCIjNzZGRjAzXCIsXCIjQzZGRjAwXCIsXCIjRkZFQTAwXCIsXCIjRkZDNDAwXCIsXCIjRkY5MTAwXCIsXCIjRkYzRDAwXCJdLEE3MDA6W1wiI0Q1MDAwMFwiLFwiI0M1MTE2MlwiLFwiI0FBMDBGRlwiLFwiIzYyMDBFQVwiLFwiIzMwNEZGRVwiLFwiIzI5NjJGRlwiLFwiIzAwOTFFQVwiLFwiIzAwQjhENFwiLFwiIzAwQkZBNVwiLFwiIzAwQzg1M1wiLFwiIzY0REQxN1wiLFwiI0FFRUEwMFwiLFwiI0ZGRDYwMFwiLFwiI0ZGQUIwMFwiLFwiI0ZGNkQwMFwiLFwiI0REMkMwMFwiXX0sbXVybXVyPXJlcXVpcmUoXCJtdXJtdXJoYXNoLWpzXCIpO21vZHVsZS5leHBvcnRzPWZ1bmN0aW9uKCl7dmFyIEY9W10sRT17c2hhZGVzOltcIjUwMFwiXSxwYWxldHRlOmRlZmF1bHRQYWxldHRlLHRleHQ6bnVsbCxpZ25vcmVDb2xvcnM6W119LEM9ZnVuY3Rpb24oQyl7Q3x8KEM9RSksQy5wYWxldHRlfHwoQy5wYWxldHRlPWRlZmF1bHRQYWxldHRlKSxDLnNoYWRlc3x8KEMuc2hhZGVzPVtcIjUwMFwiXSk7Zm9yKHZhciBCLEQ9Ri5sZW5ndGgsdD0wO0Q+dDt0KyspaWYoQy50ZXh0JiZGW3RdLnRleHQ9PT1DLnRleHQpcmV0dXJuIEZbdF0uY29sb3I7cmV0dXJuIEI9QShDKSxDLnRleHQmJkYucHVzaCh7dGV4dDpDLnRleHQsY29sb3I6Qn0pLEJ9LEE9ZnVuY3Rpb24oRil7dmFyIEU9Ri5zaGFkZXNbQihGLnNoYWRlcy5sZW5ndGgpXSxDPVwiXCI7Zm9yKHZhciBBIGluIEYucGFsZXR0ZSlGLnBhbGV0dGUuaGFzT3duUHJvcGVydHkoQSkmJkE9PT1FJiYoQz1GLnRleHQ/Ri5wYWxldHRlW0FdW0QoRi50ZXh0LEYucGFsZXR0ZVtBXS5sZW5ndGgpXTpGLnBhbGV0dGVbQV1bQihGLnBhbGV0dGVbQV0ubGVuZ3RoKV0pO3JldHVybiBDfSxCPWZ1bmN0aW9uKEYpe3JldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqRil9LEQ9ZnVuY3Rpb24oRixFKXt2YXIgQz1tdXJtdXIubXVybXVyMyhGKS8xZTEwO3JldHVybi4xPkMmJihDPTEwKkMpLE1hdGguZmxvb3IoQypFKX07cmV0dXJue2dldENvbG9yOkN9fSgpOyIsIm1vZHVsZS5leHBvcnRzID0ge1xuICBTQVZFX0NBUkRTOiAnU0FWRV9DQVJEUycsXG4gIFNFTEVDVF9DQVJEOiAnU0VMRUNUX0NBUkQnLFxuICBSRVJFTkRFUjogJ1JFUkVOREVSJyxcbiAgTEVTU19QUklTVElORTogJ0xFU1NfUFJJU1RJTkUnLFxuICBBU0NJSToge1xuICAgIEVTQ0FQRV9LRVk6IDI3LFxuICAgIFRBQl9LRVk6IDksXG4gICAgQ19LRVk6IDY3LFxuICAgIERfS0VZOiA2OCxcbiAgICBFX0tFWTogNjksXG4gICAgUExVU19LRVk6IDE4NyxcbiAgICBNSU5VU19LRVk6IDE4OSxcbiAgICBET1RfS0VZOiAxOTAsXG4gICAgQV9LRVk6IDY1LFxuICAgIElfS0VZOiA3MyxcbiAgICBSX0tFWTogODIsXG4gICAgWl9LRVk6IDkwLFxuICAgIENNRF9LRVk6IDkxLFxuICAgIEtFWVNfQVJSQVk6IFsyNywgOSwgNjcsIDY4LCA2OSwgMTg3LCAxODksIDE5MCwgNjUsIDczLCA4MiwgOTAsIDkxXSxcbiAgfSxcbiAgREVGQVVMVF9DT05URU5UOiAnVzNzaWFXUWlPakFzSW5ScGRHeGxJam9pTVNJc0ltUmxjMk55YVhCMGFXOXVJam9pVlhObElIUmhZaUJoYm1RZ2MyaHBablFnZEdGaUlIUnZJR05wY21Oc1pTQmlaWFIzWldWdUlHTmhjbVJ6SURwRVhHNWNia1J5WVdkbmFXNW5JRzl5SUdOc2FXTnJhVzVuSUhSb1pXMGdkMmxzYkNCaGJITnZJRzFoY21zZ2RHaGxiU0JoY3lCelpXeGxZM1JsWkNJc0ltUmxjSFJvSWpvMUxDSjRJam94Tmprc0lua2lPamM1TENKamIyeHZjaUk2SWlOQk5VUTJRVGNpTENKelpXeGxZM1JsWkNJNmRISjFaU3dpYVhOQmNtTm9hWFpsWkNJNlptRnNjMlVzSW1selJHVnNaWFJsWkNJNlptRnNjMlVzSW1OeVpXRjBaV1JCZENJNk1UVXdOelkwTmpjMU9ERTROaXdpWVhKamFHbDJaV1JCZENJNmJuVnNiQ3dpYm05a1pTSTZleUpxVVhWbGNua3hOekl3TkRJME56RTRNVGcxTnpFeU9UWTBNRFVpT2pSOWZTeDdJbWxrSWpveExDSjBhWFJzWlNJNklqSWlMQ0prWlhOamNtbHdkR2x2YmlJNklrOXVJR0VnYldGeWEyVmtJR05oY21RZ2RYTmxJR04wY213Z0t6cGNiaWRqSnlCMGJ5QmpiM0I1SUhSb1pTQmpiMjUwWlc1MFhHNG5aQ2NnZEc4Z1pHVnNaWFJsSUdsMFhHNG5aU2NnZEc4Z1pXUnBkQ0JwZEZ4dUoyRW5JSFJ2SUdGeVkyaHBkbVVnYjNJZ1pHVmhjbU5vYVhabElHUmxJR05oY21RaUxDSmtaWEIwYUNJNk5Td2llQ0k2TXpneUxDSjVJam8zTml3aVkyOXNiM0lpT2lJalFVVkVOVGd4SWl3aWMyVnNaV04wWldRaU9tWmhiSE5sTENKcGMwRnlZMmhwZG1Wa0lqcG1ZV3h6WlN3aWFYTkVaV3hsZEdWa0lqcG1ZV3h6WlN3aVkzSmxZWFJsWkVGMElqb3hOVEEzTmpRMk56Y3hOelF3TENKaGNtTm9hWFpsWkVGMElqcHVkV3hzTENKdWIyUmxJanA3SW1wUmRXVnllVEUzTWpBME1qUTNNVGd4T0RVM01USTVOalF3TlNJNk9IMTlMSHNpYVdRaU9qSXNJblJwZEd4bElqb2laVzUwWlhKeklpd2laR1Z6WTNKcGNIUnBiMjRpT2lKWGFHbHNaU0JsWkdsMGFXNW5JSFZ6WlNCemFHbG1kQ0FySUdWdWRHVnlJSFJ2SUZ4dWFXNXpaWEowWEc1aFhHNXNhVzVsWEc1aWNtVmhhMXh1T2tRaUxDSmtaWEIwYUNJNk5Td2llQ0k2TVRVNUxDSjVJam96TVRJc0ltTnZiRzl5SWpvaUkwWkdRamMwUkNJc0luTmxiR1ZqZEdWa0lqcG1ZV3h6WlN3aWFYTkJjbU5vYVhabFpDSTZabUZzYzJVc0ltbHpSR1ZzWlhSbFpDSTZabUZzYzJVc0ltTnlaV0YwWldSQmRDSTZNVFV3TnpZME5qYzVNakk1Tnl3aVlYSmphR2wyWldSQmRDSTZiblZzYkN3aWJtOWtaU0k2ZXlKcVVYVmxjbmt4TnpJd05ESTBOekU0TVRnMU56RXlPVFkwTURVaU9qWjlmU3g3SW1sa0lqb3pMQ0owYVhSc1pTSTZJa2RsYm1WeWFXTWlMQ0prWlhOamNtbHdkR2x2YmlJNklsbHZkU0JqWVc0Z1lXeHpieUIxYzJVZ1oyVnVaWEpwWXlCamIyMXRZVzVrY3lCemRXTm9JR0Z6SUdOMGNtd3JYRzRuYVNjZ2RHOGdZM0psWVhSbElHRWdZMkZ5WkZ4dUozb25JSFJ2SUhKbGRtbDJaU0IwYUdVZ2JHRnpkQ0JrWld4bGRHVmtJR05oY21RaUxDSmtaWEIwYUNJNk5Td2llQ0k2TkRReExDSjVJam95T1RZc0ltTnZiRzl5SWpvaUkwWkdSVEE0TWlJc0luTmxiR1ZqZEdWa0lqcG1ZV3h6WlN3aWFYTkJjbU5vYVhabFpDSTZabUZzYzJVc0ltbHpSR1ZzWlhSbFpDSTZabUZzYzJVc0ltTnlaV0YwWldSQmRDSTZNVFV3TnpZME9EWXpPRE00Tml3aVlYSmphR2wyWldSQmRDSTZiblZzYkN3aWFYTlFjbWx6ZEdsdVpTSTZabUZzYzJVc0ltNXZaR1VpT25zaWFsRjFaWEo1TVRjeU1EUXlORGN4T0RFNE5UY3hNamsyTkRBMUlqb3hNSDE5WFEnLFxuICBWRVJTSU9OOiAnMC41LjAnLFxufTsiLCJjb25zdCBDT05GSUcgPSByZXF1aXJlKCcuLi9jb25maWcnKTtcblxubGV0IGNhcmRNYW5hZ2VyLFxuICAgIENhcmQgPSByZXF1aXJlKCcuLi9tb2RlbHMvQ2FyZCcpO1xuXG5sZXQgbWFpbkNvbnRhaW5lcixcbiAgICBlZGl0Q29udGFpbmVyLFxuICAgIGVkaXRJbnB1dCxcbiAgICB0aXRsZUlucHV0LFxuICAgIGltcG9ydENvbnRhaW5lcixcbiAgICBpbXBvcnRJbnB1dCxcbiAgICBleHBvcnRDb250YWluZXIsXG4gICAgZXhwb3J0Q29udGVudCxcbiAgICBpbXBvcnRCdXR0b247XG5cblxuZnVuY3Rpb24gaW5pdChvcHRpb25zKSB7XG4gICAgY2FyZE1hbmFnZXIgPSBvcHRpb25zLmNhcmRNYW5hZ2VyO1xuICAgIGJpbmRpbmdzKCk7XG59XG5cbmZ1bmN0aW9uIGJpbmRpbmdzKCkge1xuICAgIG1haW5Db250YWluZXIgPSAkKCcjbWFpbkNvbnRhaW5lcicpO1xuICAgIGVkaXRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdENvbnRhaW5lcicpO1xuICAgIGVkaXRJbnB1dCA9IGVkaXRDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGV4dGFyZWEnKVswXTtcbiAgICB0aXRsZUlucHV0ID0gZWRpdENvbnRhaW5lci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdpbnB1dCcpWzBdO1xuICAgIGltcG9ydENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbXBvcnRDb250YWluZXInKTtcbiAgICBpbXBvcnRJbnB1dCA9IGltcG9ydENvbnRhaW5lci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdpbnB1dCcpWzBdO1xuICAgIGltcG9ydEJ1dHRvbiA9IGltcG9ydENvbnRhaW5lci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdidXR0b24nKVswXTtcbiAgICBleHBvcnRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0Q29udGFpbmVyJyk7XG4gICAgZXhwb3J0Q29udGVudCA9IGV4cG9ydENvbnRhaW5lci5nZXRFbGVtZW50c0J5VGFnTmFtZSgnZGl2JylbMF07XG5cblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGtleUhhbmRsZXJVcCwgZmFsc2UpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5SGFuZGxlckRvd24sIGZhbHNlKTtcbiAgICBlZGl0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGVkaXRJbnB1dEtleUV2ZW50KTtcbiAgICB0aXRsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlZGl0SW5wdXRLZXlFdmVudCk7XG4gICAgZWRpdENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhpZGVFZGl0Q29udGFpbmVyKTtcbiAgICBlZGl0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdG9wUHJvcGFnYXRpb24pO1xuICAgIHRpdGxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdG9wUHJvcGFnYXRpb24pO1xuICAgIC8qXG4gICAgIE9uIGRvdWJsZSBjbGljayBlZGl0IHRoZSBjYXJkXG4gICAgICovXG4gICAgbWFpbkNvbnRhaW5lci5vbignZGJsY2xpY2snLCAnZGl2JywgZG91YmxlQ2xpY2tIYW5kbGVyKTtcbiAgICAvKlxuICAgICBPbiBjbGljayBwZXJmb3JtIHRoZSBjYXJkXG4gICAgICovXG4gICAgbWFpbkNvbnRhaW5lci5vbignY2xpY2snLCAnZGl2JywgY2FyZENsaWNrRXZlbnRzKTtcbiAgICBtYWluQ29udGFpbmVyLm9uKCdjbGljaycsICdkaXYgPiBkaXYnLCBjYXJkTWVudUV2ZW50cyk7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4cG9ydCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXhwb3J0Q2FyZHMpO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbXBvcnQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNob3dJbXBvcnRlcik7XG4gICAgaW1wb3J0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbG9hZEltcG9ydENhcmRzQ29kZSk7XG4gICAgaW1wb3J0Q29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGlkZUltcG9ydENvbnRhaW5lcik7XG4gICAgaW1wb3J0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGltcG9ydElucHV0S2V5RXZlbnQpO1xuICAgIGltcG9ydElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3RvcFByb3BhZ2F0aW9uKTtcbiAgICBleHBvcnRDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoaWRlRXhwb3J0Q29udGFpbmVyKTtcbiAgICBleHBvcnRDb250ZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3RvcFByb3BhZ2F0aW9uKTtcbn1cblxuZnVuY3Rpb24ga2V5SGFuZGxlckRvd24oZSkge1xuXG4gICAgaWYgKGUua2V5Q29kZSA9PT0gQ09ORklHLkFTQ0lJLlRBQl9LRVkpIHtcbiAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7XG4gICAgICAgIGlmIChldmVudC5zaGlmdEtleSkge1xuICAgICAgICAgICAgY2FyZE1hbmFnZXIucHJldmlvdXNDYXJkKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYXJkTWFuYWdlci5uZXh0Q2FyZCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gQ09ORklHLkFTQ0lJLkNNRF9LRVkpIHtcbiAgICAgICAgd2luZG93LmNtZFByZXNzID0gdHJ1ZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGtleUhhbmRsZXJVcChlKSB7XG4gICAgY29uc29sZS5sb2coZS5rZXlDb2RlKTtcbiAgICBjb25zb2xlLmxvZyhkb2N1bWVudC5hY3RpdmVFbGVtZW50KTtcbiAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAhPT0gZG9jdW1lbnQuYm9keSB8fCBDT05GSUcuQVNDSUkuS0VZU19BUlJBWS5pbmRleE9mKGUua2V5Q29kZSkgPT09IC0xKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xuICAgICAgICBjYXNlIENPTkZJRy5BU0NJSS5DX0tFWTpcbiAgICAgICAgICAgIGlmIChldmVudC5jdHJsS2V5IHx8IHdpbmRvdy5jbWRQcmVzcykge1xuICAgICAgICAgICAgICAgIGxldCBlbGVtID0gY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLm5vZGUsXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbjtcblxuICAgICAgICAgICAgICAgIHNlbGVjdGlvbiA9IHNlbGVjdFRleHQoZWxlbS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYXJkVGV4dCcpWzBdKTtcbiAgICAgICAgICAgICAgICBjb3B5U2VsZWN0aW9uVGV4dCgpO1xuICAgICAgICAgICAgICAgIHNlbGVjdGlvbi5lbXB0eSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBDT05GSUcuQVNDSUkuRF9LRVk6XG4gICAgICAgICAgICBpZiAoZXZlbnQuY3RybEtleSB8fCB3aW5kb3cuY21kUHJlc3MpIHtcbiAgICAgICAgICAgICAgICBsZXQgY2FyZCA9IGNhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZDtcbiAgICAgICAgICAgICAgICBjYXJkTWFuYWdlci5uZXh0Q2FyZCgpO1xuXG4gICAgICAgICAgICAgICAgY2FyZE1hbmFnZXIuZGVsZXRlQ2FyZChjYXJkKTtcblxuICAgICAgICAgICAgICAgIGNhcmRNYW5hZ2VyLnNhdmVDYXJkcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQ09ORklHLkFTQ0lJLkVfS0VZOlxuICAgICAgICAgICAgaWYgKGV2ZW50LmN0cmxLZXkgfHwgd2luZG93LmNtZFByZXNzKSB7XG4gICAgICAgICAgICAgICAgZG91YmxlQ2xpY2tIYW5kbGVyLmFwcGx5KGNhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5ub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIENPTkZJRy5BU0NJSS5BX0tFWTpcbiAgICAgICAgICAgIGlmIChldmVudC5jdHJsS2V5IHx8IHdpbmRvdy5jbWRQcmVzcykge1xuICAgICAgICAgICAgICAgIGNhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC50b2dnbGVBcmNoaXZlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQ09ORklHLkFTQ0lJLklfS0VZOlxuICAgICAgICAgICAgaWYgKGV2ZW50LmN0cmxLZXkgfHwgd2luZG93LmNtZFByZXNzKSB7XG4gICAgICAgICAgICAgICAgLy8gaW5wdXQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVDYXJkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBDT05GSUcuQVNDSUkuUExVU19LRVk6XG4gICAgICAgICAgICBjaGFuZ2VEZXB0aC5hcHBseShjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQubm9kZSwgW2NhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5pZCwgMV0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQ09ORklHLkFTQ0lJLk1JTlVTX0tFWTpcbiAgICAgICAgICAgIGNoYW5nZURlcHRoLmFwcGx5KGNhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5ub2RlLCBbY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLmlkLCAtMV0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQ09ORklHLkFTQ0lJLkRPVF9LRVk6XG4gICAgICAgICAgICBzZXREZXB0aC5hcHBseShjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQubm9kZSwgW2NhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5pZCwgNV0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQ09ORklHLkFTQ0lJLlJfS0VZOlxuICAgICAgICAgICAgY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLmNvbG9yID0gY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLmdldEJhY2tncm91bmRDb2xvcigpO1xuICAgICAgICAgICAgY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLmRlcmVuZGVyKCk7XG4gICAgICAgICAgICBjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQucmVuZGVyKCk7XG5cbiAgICAgICAgICAgIGNhcmRNYW5hZ2VyLnNhdmVDYXJkcygpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQ09ORklHLkFTQ0lJLlpfS0VZOlxuICAgICAgICAgICAgaWYgKGV2ZW50LmN0cmxLZXkgfHwgd2luZG93LmNtZFByZXNzKSB7XG4gICAgICAgICAgICAgICAgY2FyZE1hbmFnZXIudW5kZWxldGVMYXN0Q2FyZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQ09ORklHLkFTQ0lJLkNNRF9LRVk6XG4gICAgICAgICAgICB3aW5kb3cuY21kUHJlc3MgPSBmYWxzZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGhpZGVFeHBvcnRDb250YWluZXIoKSB7XG4gICAgZXhwb3J0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG59XG5cbmZ1bmN0aW9uIGhpZGVFZGl0Q29udGFpbmVyKCkge1xuICAgIGVkaXRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbn1cblxuZnVuY3Rpb24gaGlkZUltcG9ydENvbnRhaW5lcigpIHtcbiAgICBpbXBvcnRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbn1cblxuZnVuY3Rpb24gc3RvcFByb3BhZ2F0aW9uKGUpIHtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xufVxuXG5mdW5jdGlvbiBlZGl0SW5wdXRLZXlFdmVudChldmVudCkge1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIGxldCBjYXJkO1xuICAgIGlmIChldmVudC5rZXlDb2RlID09PSAxMyAmJiBldmVudC5zaGlmdEtleSkgcmV0dXJuO1xuICAgIGlmIChldmVudC5rZXlDb2RlID09PSAxMykge1xuICAgICAgICBjYXJkID0gY2FyZE1hbmFnZXIuY2FyZHNbZWRpdENvbnRhaW5lci5jYXJkSWRdO1xuICAgICAgICBjYXJkLnRpdGxlID0gdGl0bGVJbnB1dC52YWx1ZTtcbiAgICAgICAgY2FyZC5kZXNjcmlwdGlvbiA9IGVkaXRJbnB1dC52YWx1ZTtcbiAgICAgICAgY2FyZC5kZXJlbmRlcigpO1xuICAgICAgICBjYXJkLnJlbmRlcigpO1xuICAgICAgICB0aGlzLnZhbHVlID0gJyc7XG4gICAgICAgIGNhcmRNYW5hZ2VyLnNhdmVDYXJkcygpO1xuICAgICAgICBoaWRlRWRpdENvbnRhaW5lcigpO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMjcpIHtcbiAgICAgICAgaGlkZUVkaXRDb250YWluZXIoKTtcbiAgICB9XG5cbn1cblxuZnVuY3Rpb24gaW1wb3J0SW5wdXRLZXlFdmVudChldmVudCkge1xuICAgIGlmIChldmVudC5rZXlDb2RlID09PSAyNykge1xuICAgICAgICBoaWRlSW1wb3J0Q29udGFpbmVyKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkb3VibGVDbGlja0hhbmRsZXIoKSB7XG4gICAgbGV0IGVsZW0gPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkVGV4dCcpLFxuICAgICAgICBjYXJkSWQsXG4gICAgICAgIGNhcmQ7XG5cbiAgICBpZiAodGhpcy5pZCA9PT0gJycpIHtcbiAgICAgICAgY2FyZElkID0gcGFyc2VJbnQodGhpcy5wYXJlbnRFbGVtZW50LmlkLnNwbGl0KCdfJylbMV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNhcmRJZCA9IHBhcnNlSW50KHRoaXMuaWQuc3BsaXQoJ18nKVsxXSk7XG4gICAgfVxuXG4gICAgY2FyZCA9IGNhcmRNYW5hZ2VyLmNhcmRzW2NhcmRJZF07XG5cbiAgICB0aXRsZUlucHV0LnZhbHVlID0gY2FyZC50aXRsZTtcbiAgICBlZGl0SW5wdXQudmFsdWUgPSBjYXJkLmRlc2NyaXB0aW9uO1xuICAgIHRpdGxlSW5wdXQuc3R5bGUudG9wID0gY2FyZC55O1xuICAgIHRpdGxlSW5wdXQuc3R5bGUubGVmdCA9IGNhcmQueDtcbiAgICBlZGl0Q29udGFpbmVyLmNhcmRJZCA9IGNhcmRJZDtcbiAgICBlZGl0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIGVkaXRJbnB1dC5zdHlsZS50b3AgPSBjYXJkLnkgKyAyMztcbiAgICBlZGl0SW5wdXQuc3R5bGUubGVmdCA9IGNhcmQueDtcbiAgICB0aXRsZUlucHV0LmZvY3VzKCk7XG59XG5cbmZ1bmN0aW9uIGNhcmRDbGlja0V2ZW50cyhldmVudCkge1xuICAgIGxldCBlbGVtID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcuY2FyZFRleHQnKSxcbiAgICAgICAgY2FyZElkLFxuICAgICAgICBjYXJkO1xuXG4gICAgaWYgKHRoaXMuaWQgPT09IFwiXCIpIHtcbiAgICAgICAgY2FyZElkID0gcGFyc2VJbnQodGhpcy5wYXJlbnRFbGVtZW50LmlkLnNwbGl0KCdfJylbMV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNhcmRJZCA9IHBhcnNlSW50KHRoaXMuaWQuc3BsaXQoJ18nKVsxXSk7XG4gICAgfVxuXG4gICAgY2FyZCA9IGNhcmRNYW5hZ2VyLmNhcmRzW2NhcmRJZF07XG5cbiAgICBpZiAoY2FyZCA9PT0gdW5kZWZpbmVkKSByZXR1cm47XG5cbiAgICBjYXJkTWFuYWdlci5zZWxlY3RDYXJkKGNhcmQuaWQpO1xuXG4gICAgaWYgKGV2ZW50LmN0cmxLZXkpIHtcbiAgICB9XG4gICAgaWYgKGV2ZW50LmFsdEtleSkge1xuICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5jb3B5JykuY2xpY2soKTtcbiAgICB9XG4gICAgaWYgKGV2ZW50LnNoaWZ0S2V5KSB7XG5cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNhcmRNZW51RXZlbnRzKCkge1xuICAgIGxldCBvcHRpb24gPSAkKHRoaXMpLmh0bWwoKSxcbiAgICAgICAgc2VsZWN0aW9uLFxuICAgICAgICBjYXJkSWQgPSBnZXRQYXJlbnRDYXJkSWQodGhpcyk7XG5cbiAgICBzd2l0Y2ggKG9wdGlvbikge1xuICAgICAgICBjYXNlICcrJzpcbiAgICAgICAgICAgIGNoYW5nZURlcHRoLmFwcGx5KHRoaXMsIFtjYXJkSWQsIDFdKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICctJzpcbiAgICAgICAgICAgIGNoYW5nZURlcHRoLmFwcGx5KHRoaXMsIFtjYXJkSWQsIC0xXSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnQyc6XG4gICAgICAgICAgICBzZWxlY3Rpb24gPSBzZWxlY3RUZXh0KHRoaXMucGFyZW50RWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYXJkVGV4dCcpWzBdKTtcbiAgICAgICAgICAgIGNvcHlTZWxlY3Rpb25UZXh0KCk7XG4gICAgICAgICAgICBzZWxlY3Rpb24uZW1wdHkoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICd4JzpcbiAgICAgICAgICAgIGNhcmRNYW5hZ2VyLmRlbGV0ZUNhcmQoY2FyZE1hbmFnZXIuY2FyZHNbY2FyZElkXSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnVic6XG4gICAgICAgIGNhc2UgJ08nOlxuICAgICAgICAgICAgY2FyZE1hbmFnZXIuY2FyZHNbY2FyZElkXS50b2dnbGVBcmNoaXZlZCgpO1xuICAgIH1cbiAgICBjYXJkTWFuYWdlci5zYXZlQ2FyZHMoKTtcbn1cblxuZnVuY3Rpb24gZXhwb3J0Q2FyZHMoKSB7XG4gICAgZXhwb3J0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIGV4cG9ydENvbnRlbnQuaW5uZXJIVE1MID0gY2FyZE1hbmFnZXIuZXhwb3J0Q2FyZHMoKTtcbiAgICBzZWxlY3Rpb24gPSBzZWxlY3RUZXh0KGV4cG9ydENvbnRlbnQpO1xuICAgIGNvcHlTZWxlY3Rpb25UZXh0KCk7XG4gICAgc2VsZWN0aW9uLmVtcHR5KCk7XG59XG5cbmZ1bmN0aW9uIGxvYWRJbXBvcnRDYXJkc0NvZGUoKSB7XG4gICAgbGV0IGRhdGEgPSBpbXBvcnRJbnB1dC52YWx1ZTtcbiAgICBjYXJkTWFuYWdlci5pbXBvcnRDYXJkcyhkYXRhKTtcbiAgICBpbXBvcnRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbn1cblxuZnVuY3Rpb24gc2hvd0ltcG9ydGVyKCkge1xuICAgIGltcG9ydENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICBpbXBvcnRJbnB1dC5mb2N1cygpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKCkge1xuICAgIGNvbnN0IGNhcmQgPSBjYXJkTWFuYWdlci5hZGRDYXJkKE9iamVjdC5jcmVhdGUoQ2FyZCwge30pLmluaXQoJycpKTtcbiAgICBjYXJkLnJlbmRlcigpO1xuICAgIGNhcmRNYW5hZ2VyLnNlbGVjdENhcmQoY2FyZC5pZCk7XG5cbiAgICAvLyBhbmQgbm93IHdlIGF1dG9lZGl0IDpEXG4gICAgZG91YmxlQ2xpY2tIYW5kbGVyLmFwcGx5KGNhcmQubm9kZSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGluaXQ6IGluaXRcbn07IiwiXG52YXIgc3VicyA9IHt9O1xuXG5cbmZ1bmN0aW9uIHB1YihuYW1lLCBwYXJhbXMpIHtcbiAgc3Vic1tuYW1lXS5mb3JFYWNoKGZ1bmN0aW9uKGVsZW0pIHtcbiAgICBlbGVtLmNhbGxiYWNrLmFwcGx5KGVsZW0uY29udGV4dCwgcGFyYW1zKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHN1YihuYW1lLCBjYWxsYmFjaywgY29udGV4dCkge1xuICBpZiAoc3Vic1tuYW1lXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgc3Vic1tuYW1lXSA9IFtdO1xuICB9XG5cbiAgc3Vic1tuYW1lXS5wdXNoKHtcbiAgICBjYWxsYmFjazogY2FsbGJhY2ssXG4gICAgY29udGV4dDogY29udGV4dFxuICB9KTtcbn1cblxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgcHViOiBwdWIsXG4gIHN1Yjogc3ViXG59OyIsIndpbmRvdy5DT05GSUcgPSByZXF1aXJlKCcuL2NvbmZpZy5qcycpO1xuXG5sZXQga2V5SGFuZGxlciA9IHJlcXVpcmUoJy4vbGliL2tleUhhbmRsZXInKSxcbiAgY2FyZE1hbmFnZXIgPSByZXF1aXJlKCcuL21vZGVscy9DYXJkTWFuYWdlcicpLmdldEluc3RhbmNlKCksXG4gIHB1YnN1YiA9IHJlcXVpcmUoJy4vbGliL3B1YnN1YicpO1xuXG53aW5kb3cuY20gPSB7XG4gIGNhcmRNYW5hZ2VyOiBjYXJkTWFuYWdlclxufTtcblxuT2JqZWN0LmFzc2lnbih3aW5kb3csIHJlcXVpcmUoJy4vcHJvdG90eXBlcycpKTtcblxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICAnc3RyaWN0IG1vZGUnO1xuXG4gIGtleUhhbmRsZXIuaW5pdCh7XG4gICAgY2FyZE1hbmFnZXI6IGNhcmRNYW5hZ2VyXG4gIH0pO1xuXG4gIGNhcmRNYW5hZ2VyLmxvYWRDYXJkcygpO1xuICBjYXJkTWFuYWdlci5yZW5kZXJBbGxDYXJkcygpO1xufSk7XG4iLCJsZXQgcHVic3ViID0gcmVxdWlyZSgnLi4vbGliL3B1YnN1YicpLFxuICAgIHJhbmRvbU1DID0gcmVxdWlyZSgncmFuZG9tLW1hdGVyaWFsLWNvbG9yJyk7XG5cblxubGV0IENhcmQgPSB7XG4gICAgaW5pdDogZnVuY3Rpb24odGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlzdGluZSkge1xuICAgICAgICB0aGlzLmlkID0gLTE7XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICB0aGlzLmRlcHRoID0gNTtcbiAgICAgICAgdGhpcy54ID0gMTAwO1xuICAgICAgICB0aGlzLnkgPSAxMDA7XG4gICAgICAgIHRoaXMuY29sb3IgPSB0aGlzLmdldEJhY2tncm91bmRDb2xvcigpO1xuICAgICAgICB0aGlzLnNlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNBcmNoaXZlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzRGVsZXRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNyZWF0ZWRBdCA9ICtuZXcgRGF0ZSgpO1xuICAgICAgICB0aGlzLmFyY2hpdmVkQXQgPSBudWxsO1xuICAgICAgICB0aGlzLmlzUHJpc3RpbmUgPSB0cnVlO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgcmVuZGVyOiBmdW5jdGlvbihhbHdheXMgPSBmYWxzZSkge1xuICAgICAgICBpZiAodGhpcy5pc0RlbGV0ZWQgPT09IHRydWUgJiYgYWx3YXlzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcbiAgICAgICAgICAgIHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksXG4gICAgICAgICAgICB0ZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksXG4gICAgICAgICAgICBsaW5rID0gdGhpcy5maW5kTGluaygpLFxuICAgICAgICAgICAgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgaWYgKHRoaXMudGl0bGUpIHtcbiAgICAgICAgICAgIHRpdGxlLmlubmVySFRNTCA9IHRoaXMudGl0bGU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5kZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgdGV4dC5pbm5lckhUTUwgPSB0aGlzLmRlc2NyaXB0aW9uLnJlcGxhY2UoL1xccj9cXG4vZywgJzxici8+Jyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aXRsZS5jbGFzc05hbWUgPSAnY2FyZFRpdGxlJztcbiAgICAgICAgdGV4dC5jbGFzc05hbWUgPSAnY2FyZFRleHQnO1xuXG4gICAgICAgIG5vZGUuaWQgPSAndG9kb18nICsgdGhpcy5pZDtcbiAgICAgICAgbm9kZS5jbGFzc05hbWUgPSAnY2FyZCBjYXJkLTEnO1xuICAgICAgICBub2RlLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICAgICAgbm9kZS5zdHlsZS5sZWZ0ID0gdGhpcy54O1xuICAgICAgICBub2RlLnN0eWxlLnRvcCA9IHRoaXMueTtcbiAgICAgICAgbm9kZS5zdHlsZS5jdXJzb3IgPSAnLXdlYmtpdC1ncmFiJztcbiAgICAgICAgbm9kZS5zdHlsZS56SW5kZXggPSB0aGlzLmRlcHRoO1xuICAgICAgICBub2RlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHRoaXMuY29sb3I7XG5cbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250YWluZXInKS5hcHBlbmRDaGlsZChub2RlKTtcblxuICAgICAgICBub2RlLmFwcGVuZENoaWxkKGNyZWF0ZURpdigneCcsICdjb250cm9sIHJlbW92ZScpKTtcbiAgICAgICAgLy8gbm9kZS5hcHBlbmRDaGlsZChjcmVhdGVEaXYoJysnLCAnY29udHJvbCB1cCcpKTtcbiAgICAgICAgLy8gbm9kZS5hcHBlbmRDaGlsZChjcmVhdGVEaXYoJy0nLCAnY29udHJvbCBkb3duJykpO1xuICAgICAgICBub2RlLmFwcGVuZENoaWxkKGNyZWF0ZURpdignQycsICdjb250cm9sIGNvcHknKSk7XG4gICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQoY3JlYXRlRGl2KCdkZXB0aDogJyArIHRoaXMuZGVwdGgsICdkZXB0aCcpKTtcbiAgICAgICAgLy8gbm9kZS5hcHBlbmRDaGlsZChjcmVhdGVEaXYodGhpcy5pc0FyY2hpdmVkID8gJ1YnIDogJ08nLCAnaXNBcmNoaXZlZCcpKTtcbiAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChjcmVhdGVEaXYoJ2lkOiAnICsgdGhpcy5pZCwgJ2lkJykpO1xuICAgICAgICBpZiAobGluaykge1xuICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChjcmVhdGVEaXYoYDxhIHRhcmdldD1cIl9ibGFua1wiIGhyZWY9XCIke2xpbmt9XCI+TGluayE8L2E+YCwgJ2xpbmsnKSk7XG4gICAgICAgIH1cblxuICAgICAgICBub2RlLmFwcGVuZENoaWxkKHRpdGxlKTtcbiAgICAgICAgbm9kZS5hcHBlbmRDaGlsZCh0ZXh0KTtcblxuICAgICAgICAkKCcjdG9kb18nICsgdGhpcy5pZCkuZHJhZ2dhYmxlKHtcbiAgICAgICAgICAgIHN0b3A6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGxldCBjYXJkID0gJCgnI3RvZG9fJyArIHRoYXQuaWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoYXQuaXNQcmlzdGluZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0LmlzUHJpc3RpbmUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICBwdWJzdWIucHViKHdpbmRvdy5DT05GSUcuTEVTU19QUklTVElORSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhhdC54ID0gKyBjYXJkLmNzcygnbGVmdCcpLnJlcGxhY2UoJ3B4JywgJycpO1xuICAgICAgICAgICAgICAgIHRoYXQueSA9ICsgY2FyZC5jc3MoJ3RvcCcpLnJlcGxhY2UoJ3B4JywgJycpO1xuXG4gICAgICAgICAgICAgICAgcHVic3ViLnB1Yih3aW5kb3cuQ09ORklHLlNFTEVDVF9DQVJELCBbdGhhdC5pZF0pO1xuICAgICAgICAgICAgICAgIHB1YnN1Yi5wdWIod2luZG93LkNPTkZJRy5TQVZFX0NBUkRTKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZSA9IG5vZGU7XG5cblxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuaXNBcmNoaXZlZCkge1xuICAgICAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgZ2V0QmFja2dyb3VuZENvbG9yOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHJhbmRvbU1DLmdldENvbG9yKHtzaGFkZXM6IFsnMjAwJywgJzMwMCddfSk7XG4gICAgfSxcbiAgICBkZXJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCBub2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZG9fJyArIHRoaXMuaWQpO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbkNvbnRhaW5lcicpLnJlbW92ZUNoaWxkKG5vZGUpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgdG9nZ2xlQXJjaGl2ZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5pc0FyY2hpdmVkID09PSBmYWxzZSB8fCB0aGlzLmlzQXJjaGl2ZWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5ub2RlLmNsYXNzTGlzdC5yZW1vdmUoJ25vdENvbXBsZXRlZCcpO1xuICAgICAgICAgICAgdm9pZCB0aGlzLm5vZGUub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgICB0aGlzLm5vZGUuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7XG4gICAgICAgICAgICB0aGlzLmFyY2hpdmVkQXQgPSArbmV3IERhdGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjb21wbGV0ZWQnKTtcbiAgICAgICAgICAgIHZvaWQgdGhpcy5ub2RlLm9mZnNldFdpZHRoO1xuICAgICAgICAgICAgdGhpcy5ub2RlLmNsYXNzTGlzdC5hZGQoJ25vdENvbXBsZXRlZCcpO1xuICAgICAgICAgICAgdGhpcy5hcmNoaXZlZEF0ID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuaXNBcmNoaXZlZCA9ICF0aGlzLmlzQXJjaGl2ZWQ7XG5cbiAgICAgICAgcHVic3ViLnB1Yih3aW5kb3cuQ09ORklHLlNBVkVfQ0FSRFMpO1xuICAgIH0sXG4gICAgZGVsZXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5pc0RlbGV0ZWQgPSB0cnVlO1xuXG4gICAgICAgIHRoaXMuZGVyZW5kZXIoKTtcbiAgICB9LFxuICAgIHVuZGVsZXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5pc0RlbGV0ZWQgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLnJlbmRlcigpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgZmluZExpbms6IGZ1bmN0aW9uKCkge1xuICAgICAgICBjb25zdCByZWdleCA9IC8oaHR0cHM/OlxcL1xcL1teXFxzXSt8d3d3LlteXFxzXSspLztcbiAgICAgICAgY29uc3QgbGluayA9IHJlZ2V4LmV4ZWModGhpcy50aXRsZSk7XG5cbiAgICAgICAgaWYgKGxpbmspIHtcbiAgICAgICAgICAgIHJldHVybiBsaW5rWzBdO1xuICAgICAgICB9XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBDYXJkOyIsImNvbnN0IENhcmQgPSByZXF1aXJlKCcuL0NhcmQnKSxcbiAgICBwdWJzdWIgPSByZXF1aXJlKCcuLi9saWIvcHVic3ViJyksXG4gICAgQ09ORklHID0gcmVxdWlyZSgnLi4vY29uZmlnJyk7XG5cbmxldCBDYXJkTWFuYWdlciA9IHtcbiAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5jYXJkcyA9IFtdO1xuICAgICAgICB0aGlzLnNlbGVjdGVkQ2FyZCA9IHtpZDogLTF9O1xuICAgICAgICB0aGlzLmRlbGV0ZWRDYXJkcyA9IFtdO1xuICAgICAgICB0aGlzLnByaXN0aW5lID0gMDtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICAgIGFkZENhcmQ6IGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgdGhpcy5jYXJkcy5wdXNoKGNhcmQpO1xuICAgICAgICBjYXJkLmlkID0gdGhpcy5jYXJkcy5sZW5ndGggLSAxO1xuXG4gICAgICAgIGNhcmQueCA9IGNhcmQueCArIHRoaXMucHJpc3RpbmUgKiAxMDtcbiAgICAgICAgY2FyZC55ID0gY2FyZC55ICsgdGhpcy5wcmlzdGluZSAqIDEwO1xuXG4gICAgICAgIHRoaXMucHJpc3RpbmUrKztcblxuICAgICAgICByZXR1cm4gY2FyZDtcbiAgICB9LFxuICAgIHJlbW92ZUNhcmQ6IGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgIHRoaXMuY2FyZHNbaWRdLmRlcmVuZGVyKCk7XG4gICAgICAgIHRoaXMuY2FyZHNbaWRdID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgcmVkcmF3Q2FyZDogZnVuY3Rpb24oY2FyZElkLCB4LCB5KSB7XG4gICAgICAgIGxldCBjYXJkID0gdGhpcy5jYXJkc1tjYXJkSWRdO1xuICAgICAgICBjYXJkLnggPSB4O1xuICAgICAgICBjYXJkLnkgPSB5O1xuXG4gICAgICAgIGNhcmQuZGVyZW5kZXIoKTtcbiAgICAgICAgY2FyZC5yZW5kZXIoKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICAgIHNhdmVDYXJkczogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0eXBlb2YoU3RvcmFnZSkgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FyZHMnLCBKU09OLnN0cmluZ2lmeSh0aGlzLmNhcmRzKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygneW91IGRvblxcJ3QgaGF2ZSBsb2NhbCBzdG9yYWdlIDooJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnBlcnNpc3RTZWxlY3RlZENhcmQoKTtcbiAgICAgICAgdGhpcy5wZXJzaXN0RGVsZXRlZENhcmRzKCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBsb2FkQ2FyZHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLmNhcmRzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2FyZHMnKSk7XG5cbiAgICAgICAgaWYgKHRoaXMuY2FyZHMgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuY2FyZHMgPSBKU09OLnBhcnNlKGF0b2IoQ09ORklHLkRFRkFVTFRfQ09OVEVOVCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jbGVhckFycmF5KCk7XG5cbiAgICAgICAgdGhpcy5sb2FkU2VsZWN0ZWRDYXJkKCk7XG4gICAgICAgIHRoaXMubG9hZERlbGV0ZWRDYXJkcygpO1xuXG4gICAgICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgY2xlYXJBcnJheTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCBpO1xuXG4gICAgICAgIHRoaXMuY2FyZHMgPSB0aGlzLmNhcmRzLmZpbHRlcihmdW5jdGlvbihlbGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbSAhPT0gdW5kZWZpbmVkICYmIGVsZW0gIT09IG51bGw7XG4gICAgICAgIH0pO1xuICAgICAgICBmb3IgKGkgaW4gdGhpcy5jYXJkcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FyZHMuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhcmRzWytpXS5pZCA9ICtpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICByZVJlbmRlckFsbENhcmRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5jYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG4gICAgICAgICAgICBjYXJkLmRlcmVuZGVyKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnJlbmRlckFsbENhcmRzKCk7XG4gICAgfSxcbiAgICByZW5kZXJBbGxDYXJkczogZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgdGhpcy5jYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG4gICAgICAgICAgICAgICAgY2FyZC5zZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWRDYXJkICYmICh0aGlzLnNlbGVjdGVkQ2FyZC5pZCA9PT0gY2FyZC5pZCk7XG4gICAgICAgICAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGNhcmQsIENhcmQpO1xuICAgICAgICAgICAgICAgIGNhcmQucmVuZGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICBnZXRJbnN0YW5jZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChDYXJkTWFuYWdlci5pbnN0YW5jZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBDYXJkTWFuYWdlci5pbnN0YW5jZSA9IE9iamVjdC5jcmVhdGUoQ2FyZE1hbmFnZXIsIHt9KTtcbiAgICAgICAgICAgIENhcmRNYW5hZ2VyLmluc3RhbmNlLmluaXQoKTtcbiAgICAgICAgICAgIHB1YnN1Yi5zdWIod2luZG93LkNPTkZJRy5TQVZFX0NBUkRTLCBDYXJkTWFuYWdlci5pbnN0YW5jZS5zYXZlQ2FyZHMsIENhcmRNYW5hZ2VyLmluc3RhbmNlKTtcbiAgICAgICAgICAgIHB1YnN1Yi5zdWIod2luZG93LkNPTkZJRy5TRUxFQ1RfQ0FSRCwgQ2FyZE1hbmFnZXIuaW5zdGFuY2Uuc2VsZWN0Q2FyZCwgQ2FyZE1hbmFnZXIuaW5zdGFuY2UpO1xuICAgICAgICAgICAgcHVic3ViLnN1Yih3aW5kb3cuQ09ORklHLlJFUkVOREVSLCBDYXJkTWFuYWdlci5pbnN0YW5jZS5yZVJlbmRlckFsbENhcmRzLCBDYXJkTWFuYWdlci5pbnN0YW5jZSk7XG4gICAgICAgICAgICBwdWJzdWIuc3ViKHdpbmRvdy5DT05GSUcuTEVTU19QUklTVElORSwgQ2FyZE1hbmFnZXIuaW5zdGFuY2UubGVzc1ByaXN0aW5lLCBDYXJkTWFuYWdlci5pbnN0YW5jZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gQ2FyZE1hbmFnZXIuaW5zdGFuY2U7XG5cbiAgICB9LFxuICAgIGxlc3NQcmlzdGluZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMucHJpc3RpbmUtLTtcbiAgICB9LFxuICAgIGV4cG9ydENhcmRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGJ0b2EoSlNPTi5zdHJpbmdpZnkodGhpcy5jYXJkcykpO1xuICAgIH0sXG4gICAgaW1wb3J0Q2FyZHM6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhcmRzJywgYXRvYihkYXRhKSk7XG4gICAgICAgIHRoaXMubG9hZENhcmRzKCk7XG4gICAgICAgIHRoaXMucmVuZGVyQWxsQ2FyZHMoKTtcbiAgICB9LFxuICAgIHNlbGVjdENhcmQ6IGZ1bmN0aW9uKGNhcmRJZCkge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZENhcmQgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnNlbGVjdGVkQ2FyZC5ub2RlLmNsYXNzTGlzdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkQ2FyZC5ub2RlLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZWxlY3RlZENhcmQgPSB0aGlzLmNhcmRzW2NhcmRJZF07XG5cbiAgICAgICAgdGhpcy5zZWxlY3RlZENhcmQubm9kZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpO1xuXG4gICAgICAgIHRoaXMucGVyc2lzdFNlbGVjdGVkQ2FyZCgpO1xuICAgICAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTtcbiAgICB9LFxuICAgIG5leHRDYXJkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgbGV0IGl0ID0gK3RoaXMuc2VsZWN0ZWRDYXJkLmlkICsgMTtcblxuICAgICAgICB3aGlsZSAoaXQgIT09ICt0aGlzLnNlbGVjdGVkQ2FyZC5pZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FyZHNbaXRdICE9PSB1bmRlZmluZWQgJiYgdGhpcy5jYXJkc1tpdF0uaXNEZWxldGVkICE9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKytpdCA+PSB0aGlzLmNhcmRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGl0ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2VsZWN0Q2FyZChpdCk7XG4gICAgfSxcbiAgICBwcmV2aW91c0NhcmQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBsZXQgaXQgPSArdGhpcy5zZWxlY3RlZENhcmQuaWQgLSAxO1xuXG4gICAgICAgIHdoaWxlIChpdCAhPT0gK3RoaXMuc2VsZWN0ZWRDYXJkLmlkKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jYXJkc1tpdF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKC0taXQgPD0gMCkge1xuICAgICAgICAgICAgICAgIGl0ID0gdGhpcy5jYXJkcy5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNlbGVjdENhcmQoaXQpO1xuICAgIH0sXG4gICAgcGVyc2lzdFNlbGVjdGVkQ2FyZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkQ2FyZCAmJiB0aGlzLnNlbGVjdGVkQ2FyZC5pZCA+IC0xKSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc2VsZWN0ZWRDYXJkJywgdGhpcy5zZWxlY3RlZENhcmQuaWQpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBsb2FkU2VsZWN0ZWRDYXJkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgbGV0IHNlbGVjdGVkQ2FyZElkID0gK2xvY2FsU3RvcmFnZS5nZXRJdGVtKCdzZWxlY3RlZENhcmQnKTtcblxuICAgICAgICBpZiAoc2VsZWN0ZWRDYXJkSWQgIT09IHVuZGVmaW5lZCAmJiBzZWxlY3RlZENhcmRJZCA+IC0xKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkQ2FyZCA9IHRoaXMuY2FyZHNbc2VsZWN0ZWRDYXJkSWRdO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBwZXJzaXN0RGVsZXRlZENhcmRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2RlbGV0ZWRDYXJkcycsIEpTT04uc3RyaW5naWZ5KHRoaXMuZGVsZXRlZENhcmRzKSk7XG4gICAgfSxcbiAgICBsb2FkRGVsZXRlZENhcmRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc29sZS5sb2cobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2RlbGV0ZWRDYXJkcycpKTtcbiAgICAgICAgdGhpcy5kZWxldGVkQ2FyZHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdkZWxldGVkQ2FyZHMnKSkgfHwgW107XG5cbiAgICB9LFxuICAgIGRlbGV0ZUNhcmQ6IGZ1bmN0aW9uKGNhcmQpIHtcbiAgICAgICAgdGhpcy5kZWxldGVkQ2FyZHMucHVzaChjYXJkLmlkKTtcblxuICAgICAgICBjYXJkLmRlbGV0ZSgpO1xuICAgIH0sXG4gICAgdW5kZWxldGVMYXN0Q2FyZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGV0ZWRDYXJkcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2VsZWN0Q2FyZCh0aGlzLmNhcmRzW3RoaXMuZGVsZXRlZENhcmRzLnNwbGljZSh0aGlzLmRlbGV0ZWRDYXJkcy5sZW5ndGggLSAxKV0udW5kZWxldGUoKS5pZCk7XG5cbiAgICAgICAgdGhpcy5zYXZlQ2FyZHMoKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IENhcmRNYW5hZ2VyOyIsImxldCBjYXJkTWFuYWdlciA9IHJlcXVpcmUoJy4vbW9kZWxzL0NhcmRNYW5hZ2VyJykuZ2V0SW5zdGFuY2UoKTtcblxuZnVuY3Rpb24gY3JlYXRlRGl2KHRleHQsIGNsYXNzTmFtZSkge1xuICAgIGxldCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBkaXYuaW5uZXJIVE1MID0gdGV4dDtcbiAgICBkaXYuc3R5bGUuZmxvYXQgPSBcInJpZ2h0XCI7XG4gICAgZGl2LnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xuICAgIGRpdi5zdHlsZS53aWR0aCA9IFwiYXV0b1wiO1xuICAgIGRpdi5zdHlsZS50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xuICAgIGRpdi5zdHlsZS5tYXJnaW4gPSBcIjAgM3B4XCI7XG5cbiAgICBpZiAoY2xhc3NOYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZGl2LmNsYXNzTmFtZSA9IGNsYXNzTmFtZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGl2O1xufVxuXG5mdW5jdGlvbiBjb3B5U2VsZWN0aW9uVGV4dCgpIHtcbiAgICBsZXQgY29weXN1Y2Nlc3M7IC8vIGxldCB0byBjaGVjayB3aGV0aGVyIGV4ZWNDb21tYW5kIHN1Y2Nlc3NmdWxseSBleGVjdXRlZFxuICAgIHRyeSB7XG4gICAgICAgIGNvcHlzdWNjZXNzID0gZG9jdW1lbnQuZXhlY0NvbW1hbmQoXCJjb3B5XCIpOyAvLyBydW4gY29tbWFuZCB0byBjb3B5IHNlbGVjdGVkIHRleHQgdG8gY2xpcGJvYXJkXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb3B5c3VjY2VzcyA9IGZhbHNlXG4gICAgfVxuICAgIHJldHVybiBjb3B5c3VjY2Vzc1xufVxuXG5mdW5jdGlvbiBzZWxlY3RUZXh0KGVsZW1lbnQpIHtcbiAgICBsZXQgZG9jID0gZG9jdW1lbnRcbiAgICAgICAgLCB0ZXh0ID0gZWxlbWVudFxuICAgICAgICAsIHJhbmdlLCBzZWxlY3Rpb25cbiAgICA7XG4gICAgaWYgKGRvYy5ib2R5LmNyZWF0ZVRleHRSYW5nZSkge1xuICAgICAgICByYW5nZSA9IGRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgICAgIHJhbmdlLm1vdmVUb0VsZW1lbnRUZXh0KHRleHQpO1xuICAgICAgICByYW5nZS5zZWxlY3QoKTtcbiAgICB9IGVsc2UgaWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24pIHtcbiAgICAgICAgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpO1xuICAgICAgICByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XG4gICAgICAgIHJhbmdlLnNlbGVjdE5vZGVDb250ZW50cyh0ZXh0KTtcbiAgICAgICAgc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xuICAgICAgICByZXR1cm4gc2VsZWN0aW9uO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0UGFyZW50Q2FyZElkKGNvbnRleHQpIHtcbiAgICBpZiAoY29udGV4dC5wYXJlbnRFbGVtZW50ID09PSBudWxsKSByZXR1cm47XG4gICAgcmV0dXJuIHBhcnNlSW50KGNvbnRleHQucGFyZW50RWxlbWVudC5pZC5zcGxpdChcIl9cIilbMV0pO1xufVxuXG5mdW5jdGlvbiBnZXRTb21ldGhpbmdCeWNsYXNzTmFtZShjb250ZXh0LCBjbGFzc25hbWUpIHtcbiAgICBsZXQgcmVzID0gY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGNsYXNzbmFtZSk7XG5cbiAgICBpZiAocmVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXMgPSBjb250ZXh0LnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShjbGFzc25hbWUpO1xuICAgIH1cblxuICAgIHJldHVybiByZXM7XG59XG5cbmZ1bmN0aW9uIGNoYW5nZURlcHRoKGNhcmRJZCwgaW5jcmVtZW50KSB7XG4gICAgbGV0IGRlcHRoID0gY2FyZE1hbmFnZXIuY2FyZHNbY2FyZElkXS5kZXB0aCArIGluY3JlbWVudDtcblxuICAgIHRoaXMuc3R5bGUuekluZGV4ID0gZGVwdGg7XG4gICAgY2FyZE1hbmFnZXIuY2FyZHNbY2FyZElkXS5kZXB0aCA9IGRlcHRoO1xuXG4gICAgbGV0IGVsZW0gPSBnZXRTb21ldGhpbmdCeWNsYXNzTmFtZSh0aGlzLCAnZGVwdGgnKTtcbiAgICBlbGVtWzBdLmlubmVySFRNTCA9IGRlcHRoO1xufVxuXG5mdW5jdGlvbiBzZXREZXB0aChjYXJkSWQsIGRlcHRoKSB7XG4gICAgdGhpcy5zdHlsZS56SW5kZXggPSBkZXB0aDtcbiAgICBjYXJkTWFuYWdlci5jYXJkc1tjYXJkSWRdLmRlcHRoID0gZGVwdGg7XG5cbiAgICBsZXQgZWxlbSA9IGdldFNvbWV0aGluZ0J5Y2xhc3NOYW1lKHRoaXMsICdkZXB0aCcpO1xuICAgIGVsZW1bMF0uaW5uZXJIVE1MID0gZGVwdGg7XG59XG5cbmZ1bmN0aW9uIGdldENhcmRIVE1MQnlJZChtYWluQ29udGFpbmVyLCBpZCkge1xuICAgIHJldHVybiBtYWluQ29udGFpbmVyLmdldEVsZW1lbnRCeUlkKCd0b2RvXycgKyBpZCk7XG59XG5cbi8vIFBST1RPVFlQRVNcblxuLypcbiAqIFJldHVybnMgdGhlIHNpemUgb2YgYW4gYXJyYXlcbiAqL1xuQXJyYXkucHJvdG90eXBlLnNpemUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oYSkge1xuICAgICAgICByZXR1cm4gYSAhPT0gdW5kZWZpbmVkO1xuICAgIH0pLmxlbmd0aFxufTtcblxuLypcbiAqIFJldHVybnMgdGhlIHNpemUgb2YgYW4gb2JqZWN0XG4gKi9cbk9iamVjdC5zaXplID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgbGV0IHNpemUgPSAwLCBrZXkgPSBcIlwiO1xuXG4gICAgZm9yIChrZXkgaW4gb2JqKSB7XG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkgc2l6ZSsrO1xuICAgIH1cbiAgICByZXR1cm4gc2l6ZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGNyZWF0ZURpdjogY3JlYXRlRGl2LFxuICAgIGNvcHlTZWxlY3Rpb25UZXh0OiBjb3B5U2VsZWN0aW9uVGV4dCxcbiAgICBzZWxlY3RUZXh0OiBzZWxlY3RUZXh0LFxuICAgIGdldFBhcmVudENhcmRJZDogZ2V0UGFyZW50Q2FyZElkLFxuICAgIGNoYW5nZURlcHRoOiBjaGFuZ2VEZXB0aCxcbiAgICBzZXREZXB0aDogc2V0RGVwdGgsXG4gICAgZ2V0Q2FyZEhUTUxCeUlkOiBnZXRDYXJkSFRNTEJ5SWRcbn07Il19"}