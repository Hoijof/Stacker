{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","node_modules/random-material-color/dist/randomColor.js","node_modules/random-material-color/node_modules/murmurhash-js/index.js","node_modules/random-material-color/node_modules/murmurhash-js/murmurhash2_gc.js","node_modules/random-material-color/node_modules/murmurhash-js/murmurhash3_gc.js","src/js/config.js","src/js/lib/pubsub.js","src/js/main.js","src/js/models/Card.js","src/js/models/CardManager.js","src/js/prototypes.js"],"names":[],"mappings":"AAAA;ACAA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnEA;AACA;AACA;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var defaultPalette={50:[\"#FFEBEE\",\"#FCE4EC\",\"#F3E5F5\",\"#EDE7F6\",\"#E8EAF6\",\"#E3F2FD\",\"#E1F5FE\",\"#E0F7FA\",\"#E0F2F1\",\"#E8F5E9\",\"#F1F8E9\",\"#F9FBE7\",\"#FFFDE7\",\"#FFF8E1\",\"#FFF3E0\",\"#FBE9E7\",\"#EFEBE9\",\"#FAFAFA\",\"#ECEFF1\"],100:[\"#FFCDD2\",\"#F8BBD0\",\"#E1BEE7\",\"#D1C4E9\",\"#C5CAE9\",\"#BBDEFB\",\"#B3E5FC\",\"#B2EBF2\",\"#B2DFDB\",\"#C8E6C9\",\"#DCEDC8\",\"#F0F4C3\",\"#FFF9C4\",\"#FFECB3\",\"#FFE0B2\",\"#FFCCBC\",\"#D7CCC8\",\"#F5F5F5\",\"#CFD8DC\"],200:[\"#EF9A9A\",\"#F48FB1\",\"#CE93D8\",\"#B39DDB\",\"#9FA8DA\",\"#90CAF9\",\"#81D4FA\",\"#80DEEA\",\"#80CBC4\",\"#A5D6A7\",\"#C5E1A5\",\"#E6EE9C\",\"#FFF59D\",\"#FFE082\",\"#FFCC80\",\"#FFAB91\",\"#BCAAA4\",\"#EEEEEE\",\"#B0BEC5\"],300:[\"#E57373\",\"#F06292\",\"#BA68C8\",\"#9575CD\",\"#7986CB\",\"#64B5F6\",\"#4FC3F7\",\"#4DD0E1\",\"#4DB6AC\",\"#81C784\",\"#AED581\",\"#DCE775\",\"#FFF176\",\"#FFD54F\",\"#FFB74D\",\"#FF8A65\",\"#A1887F\",\"#E0E0E0\",\"#90A4AE\"],400:[\"#EF5350\",\"#EC407A\",\"#AB47BC\",\"#7E57C2\",\"#5C6BC0\",\"#42A5F5\",\"#29B6F6\",\"#26C6DA\",\"#26A69A\",\"#66BB6A\",\"#9CCC65\",\"#D4E157\",\"#FFEE58\",\"#FFCA28\",\"#FFA726\",\"#FF7043\",\"#8D6E63\",\"#BDBDBD\",\"#78909C\"],500:[\"#F44336\",\"#E91E63\",\"#9C27B0\",\"#673AB7\",\"#3F51B5\",\"#2196F3\",\"#03A9F4\",\"#00BCD4\",\"#009688\",\"#4CAF50\",\"#8BC34A\",\"#CDDC39\",\"#FFEB3B\",\"#FFC107\",\"#FF9800\",\"#FF5722\",\"#795548\",\"#9E9E9E\",\"#607D8B\"],600:[\"#E53935\",\"#D81B60\",\"#8E24AA\",\"#5E35B1\",\"#3949AB\",\"#1E88E5\",\"#039BE5\",\"#00ACC1\",\"#00897B\",\"#43A047\",\"#7CB342\",\"#C0CA33\",\"#FDD835\",\"#FFB300\",\"#FB8C00\",\"#F4511E\",\"#6D4C41\",\"#757575\",\"#546E7A\"],700:[\"#D32F2F\",\"#C2185B\",\"#7B1FA2\",\"#512DA8\",\"#303F9F\",\"#1976D2\",\"#0288D1\",\"#0097A7\",\"#00796B\",\"#388E3C\",\"#689F38\",\"#AFB42B\",\"#FBC02D\",\"#FFA000\",\"#F57C00\",\"#E64A19\",\"#5D4037\",\"#616161\",\"#455A64\"],800:[\"#C62828\",\"#AD1457\",\"#6A1B9A\",\"#4527A0\",\"#283593\",\"#1565C0\",\"#0277BD\",\"#00838F\",\"#00695C\",\"#2E7D32\",\"#558B2F\",\"#9E9D24\",\"#F9A825\",\"#FF8F00\",\"#EF6C00\",\"#D84315\",\"#4E342E\",\"#424242\",\"#37474F\"],900:[\"#B71C1C\",\"#880E4F\",\"#4A148C\",\"#311B92\",\"#1A237E\",\"#0D47A1\",\"#01579B\",\"#006064\",\"#004D40\",\"#1B5E20\",\"#33691E\",\"#827717\",\"#F57F17\",\"#FF6F00\",\"#E65100\",\"#BF360C\",\"#3E2723\",\"#212121\",\"#263238\"],A100:[\"#FF8A80\",\"#FF80AB\",\"#EA80FC\",\"#B388FF\",\"#8C9EFF\",\"#82B1FF\",\"#80D8FF\",\"#84FFFF\",\"#A7FFEB\",\"#B9F6CA\",\"#CCFF90\",\"#F4FF81\",\"#FFFF8D\",\"#FFE57F\",\"#FFD180\",\"#FF9E80\"],A200:[\"#FF5252\",\"#FF4081\",\"#E040FB\",\"#7C4DFF\",\"#536DFE\",\"#448AFF\",\"#40C4FF\",\"#18FFFF\",\"#64FFDA\",\"#69F0AE\",\"#B2FF59\",\"#EEFF41\",\"#FFFF00\",\"#FFD740\",\"#FFAB40\",\"#FF6E40\"],A400:[\"#FF1744\",\"#F50057\",\"#D500F9\",\"#651FFF\",\"#3D5AFE\",\"#2979FF\",\"#00B0FF\",\"#00E5FF\",\"#1DE9B6\",\"#00E676\",\"#76FF03\",\"#C6FF00\",\"#FFEA00\",\"#FFC400\",\"#FF9100\",\"#FF3D00\"],A700:[\"#D50000\",\"#C51162\",\"#AA00FF\",\"#6200EA\",\"#304FFE\",\"#2962FF\",\"#0091EA\",\"#00B8D4\",\"#00BFA5\",\"#00C853\",\"#64DD17\",\"#AEEA00\",\"#FFD600\",\"#FFAB00\",\"#FF6D00\",\"#DD2C00\"]},murmur=require(\"murmurhash-js\");module.exports=function(){var F=[],E={shades:[\"500\"],palette:defaultPalette,text:null,ignoreColors:[]},C=function(C){C||(C=E),C.palette||(C.palette=defaultPalette),C.shades||(C.shades=[\"500\"]);for(var B,D=F.length,t=0;D>t;t++)if(C.text&&F[t].text===C.text)return F[t].color;return B=A(C),C.text&&F.push({text:C.text,color:B}),B},A=function(F){var E=F.shades[B(F.shades.length)],C=\"\";for(var A in F.palette)F.palette.hasOwnProperty(A)&&A===E&&(C=F.text?F.palette[A][D(F.text,F.palette[A].length)]:F.palette[A][B(F.palette[A].length)]);return C},B=function(F){return Math.floor(Math.random()*F)},D=function(F,E){var C=murmur.murmur3(F)/1e10;return.1>C&&(C=10*C),Math.floor(C*E)};return{getColor:C}}();","var murmur3 = require(\"./murmurhash3_gc.js\")\nvar murmur2 = require(\"./murmurhash2_gc.js\")\n\nmodule.exports = murmur3\nmodule.exports.murmur3 = murmur3\nmodule.exports.murmur2 = murmur2\n","/**\n * JS Implementation of MurmurHash2\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} str ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash\n */\n\nfunction murmurhash2_32_gc(str, seed) {\n  var\n    l = str.length,\n    h = seed ^ l,\n    i = 0,\n    k;\n  \n  while (l >= 4) {\n  \tk = \n  \t  ((str.charCodeAt(i) & 0xff)) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 8) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 16) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 24);\n    \n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n    k ^= k >>> 24;\n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n\n\th = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16)) ^ k;\n\n    l -= 4;\n    ++i;\n  }\n  \n  switch (l) {\n  case 3: h ^= (str.charCodeAt(i + 2) & 0xff) << 16;\n  case 2: h ^= (str.charCodeAt(i + 1) & 0xff) << 8;\n  case 1: h ^= (str.charCodeAt(i) & 0xff);\n          h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  }\n\n  h ^= h >>> 13;\n  h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  h ^= h >>> 15;\n\n  return h >>> 0;\n}\n\nif(typeof module !== undefined) {\n  module.exports = murmurhash2_32_gc\n}\n","/**\n * JS Implementation of MurmurHash3 (r136) (as of May 20, 2011)\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} key ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash \n */\n\nfunction murmurhash3_32_gc(key, seed) {\n\tvar remainder, bytes, h1, h1b, c1, c1b, c2, c2b, k1, i;\n\t\n\tremainder = key.length & 3; // key.length % 4\n\tbytes = key.length - remainder;\n\th1 = seed;\n\tc1 = 0xcc9e2d51;\n\tc2 = 0x1b873593;\n\ti = 0;\n\t\n\twhile (i < bytes) {\n\t  \tk1 = \n\t  \t  ((key.charCodeAt(i) & 0xff)) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 8) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 16) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 24);\n\t\t++i;\n\t\t\n\t\tk1 = ((((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16))) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = ((((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16))) & 0xffffffff;\n\n\t\th1 ^= k1;\n        h1 = (h1 << 13) | (h1 >>> 19);\n\t\th1b = ((((h1 & 0xffff) * 5) + ((((h1 >>> 16) * 5) & 0xffff) << 16))) & 0xffffffff;\n\t\th1 = (((h1b & 0xffff) + 0x6b64) + ((((h1b >>> 16) + 0xe654) & 0xffff) << 16));\n\t}\n\t\n\tk1 = 0;\n\t\n\tswitch (remainder) {\n\t\tcase 3: k1 ^= (key.charCodeAt(i + 2) & 0xff) << 16;\n\t\tcase 2: k1 ^= (key.charCodeAt(i + 1) & 0xff) << 8;\n\t\tcase 1: k1 ^= (key.charCodeAt(i) & 0xff);\n\t\t\n\t\tk1 = (((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16)) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = (((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16)) & 0xffffffff;\n\t\th1 ^= k1;\n\t}\n\t\n\th1 ^= key.length;\n\n\th1 ^= h1 >>> 16;\n\th1 = (((h1 & 0xffff) * 0x85ebca6b) + ((((h1 >>> 16) * 0x85ebca6b) & 0xffff) << 16)) & 0xffffffff;\n\th1 ^= h1 >>> 13;\n\th1 = ((((h1 & 0xffff) * 0xc2b2ae35) + ((((h1 >>> 16) * 0xc2b2ae35) & 0xffff) << 16))) & 0xffffffff;\n\th1 ^= h1 >>> 16;\n\n\treturn h1 >>> 0;\n}\n\nif(typeof module !== \"undefined\") {\n  module.exports = murmurhash3_32_gc\n}","module.exports = {\n  SAVE_CARDS: 'SAVE_CARDS'\n}","\nvar subs = {};\n\n\nfunction pub(name, params) {\n  subs[name].forEach(function(elem) {\n    elem.callback.apply(elem.context, params);\n  });\n}\n\nfunction sub(name, callback, context) {\n  if (subs[name] === undefined) {\n    subs[name] = [];\n  }\n\n  subs[name].push({\n    callback: callback,\n    context: context\n  });\n}\n\n\nmodule.exports = {\n  pub: pub,\n  sub: sub\n};","window.CONFIG = require('./config.js');\n\nlet prototypes = require('./prototypes'),\n  Card = require('./models/Card'),\n  CardManager = require('./models/CardManager');\n\nlet mainContainer,\n  input,\n  editContainer,\n  editInput;\n\n\nlet cardManager = CardManager.getInstance();\n\nObject.assign(window, require('./prototypes'));\n\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  'strict mode';\n\n  mainContainer = $('#mainContainer');\n  input = document.querySelector('#formContainer input');\n  editContainer = document.getElementById('editContainer');\n  editInput = editContainer.getElementsByClassName('textarea')[0];\n\n\n  window.addEventListener('keydown', keyHandler, false);\n  input.addEventListener('keydown', mainInputKeyEvent);\n  editInput.addEventListener('keydown', editInputKeyEvent);\n  editContainer.addEventListener('click', hideEditContainer);\n  editInput.addEventListener('click', stopPropagation);\n  /*\n   On double click edit the card\n   */\n  mainContainer.on('dblclick', 'div', doubleClickHandler);\n  /*\n   On click perform the card\n   */\n  mainContainer.on('click', 'div', cardClickEvents);\n  mainContainer.on('click', 'div > div', cardMenuEvents);\n\n\n  cardManager.loadCards();\n  cardManager.renderAllCards();\n  input.focus();\n});\n\nfunction hideEditContainer() {\n  editContainer.style.display = 'none';\n}\n\nfunction stopPropagation (e) {\n  e.stopPropagation();\n}\n\nfunction mainInputKeyEvent (event) {\n  event.stopPropagation();\n  let card;\n\n  if (event.keyCode === 13) {\n    card = cardManager.addCard(Object.create(Card, {}).init(input.value));\n    card.render();\n    this.value = '';\n    cardManager.saveCards();\n  }\n}\n\nfunction editInputKeyEvent (event) {\n  event.stopPropagation();\n  let card;\n  if (event.keyCode === 13 && event.shiftKey) return;\n  if (event.keyCode === 13) {\n    card = cardManager.cards[editContainer.cardId];\n    card.name = editInput.value;\n    card.derender();\n    card.render();\n    this.value = '';\n    cardManager.saveCards();\n    hideEditContainer();\n  } else if (event.keyCode === 27) {\n    hideEditContainer()\n  }\n\n}\n\nfunction keyHandler (e) {\n  let TABKEY = 9;\n  if (e.keyCode === TABKEY) {\n    if (event.shiftKey) {\n      console.log('MoveToPreviousCard');\n    } else {\n      console.log('MoveToNextCard');\n    }\n    if (e.preventDefault) {\n      e.preventDefault();\n    }\n    return false;\n  } else if (event.keyCode === 27) {\n    hideEditContainer()\n  }\n}\n\nfunction doubleClickHandler () {\n  let elem = this.querySelector('.cardText'),\n    cardId,\n    card;\n\n  if (this.id === '') {\n    cardId = parseInt(this.parentElement.id.split('_')[1]);\n  } else {\n    cardId = parseInt(this.id.split('_')[1]);\n  }\n\n  card = cardManager.cards[cardId];\n\n  editInput.value = card.name;\n  editContainer.cardId = cardId;\n  editContainer.style.display = 'block';\n  editInput.style.top = card.y;\n  editInput.style.left = card.x;\n  editInput.style[\"padding-top\"] = '23px';\n  editInput.focus();\n}\n\nfunction cardClickEvents (event) {\n  let elem = this.querySelector('.cardText'),\n    cardId = parseInt(this.id.split('_')[1]),\n    card = cardManager.cards[cardId];\n\n  if (event.ctrlKey) {\n  }\n  if (event.altKey) {\n    this.querySelector('.copy').click();\n  }\n  if (event.shiftKey) {\n\n  }\n}\n\nfunction cardMenuEvents () {\n  let option = $(this).html(),\n    selection,\n    cardId = getParentCardId(this);\n\n  switch (option) {\n    case '+':\n      changeDepth.apply(this, [cardId, 1]);\n      break;\n    case '-':\n      changeDepth.apply(this, [cardId, -1]);\n      break;\n    case 'C':\n      selection = selectText(this.parentElement.getElementsByClassName('cardText')[0]);\n      copySelectionText();\n      selection.empty();\n      break;\n    case 'x':\n      cardManager.removeCard(cardId, -1);\n      break;\n  }\n  cardManager.saveCards();\n}","let pubsub = require('../lib/pubsub'),\n  randomMC = require('random-material-color');\n\n\nlet Card = {\n  init: function (name) {\n    this.id = -1;\n    this.name = name;\n    this.depth = 5;\n    this.x = 100;\n    this.y = 100;\n    this.color = this.getBackgroundColor();\n\n    return this;\n  },\n  render: function () {\n    let node = document.createElement('div'),\n      text = document.createElement('div'),\n      that = this;\n\n    text.innerHTML = this.name.replace(/\\r?\\n/g,'<br/>');\n    text.className = 'cardText';\n\n    node.id = 'todo_' + this.id;\n    node.className = 'card card-1';\n    node.style.position = 'fixed';\n    node.style.left = this.x;\n    node.style.top = this.y;\n    node.style.cursor = '-webkit-grab';\n    node.style.zIndex = this.depth;\n    node.style.backgroundColor = this.color;\n\n    document.getElementById('mainContainer').appendChild(node);\n\n    node.appendChild(createDiv('x', 'control remove'));\n    node.appendChild(createDiv('+', 'control up'));\n    node.appendChild(createDiv('-', 'control down'));\n    node.appendChild(createDiv('C', 'control copy'));\n    node.appendChild(createDiv(this.depth, 'depth'));\n\n    node.appendChild(text);\n\n    $('#todo_' + this.id).draggable({\n      stop: function () {\n        let card = $('#todo_' + that.id);\n        that.x = card.css('left');\n        that.y = card.css('top');\n\n        // cardManager.saveCards();\n        pubsub.pub(window.CONFIG.SAVE_CARDS);\n      },\n    });\n\n    return this;\n  },\n  getBackgroundColor2: function () {\n    let c = Math.floor(Math.random() * 16777215).toString(16),  // strip #\n     rgb = parseInt(c, 16),   // convert rrggbb to decimal\n     r = (rgb >> 16) & 0xff,  // extract red\n     g = (rgb >>  8) & 0xff, // extract green\n     b = (rgb >>  0) & 0xff,  // extract blue\n     // luma = 0.2126 * r + 0.7152 * g + 0.0722 * b; // per ITU-R BT.709\n     luma =(r + g + b)/3;\n\n    if (luma < 128) {\n      console.log (\"not enough luma! \" + luma);\n      return this.getBackgroundColor();\n    }\n    return \"#\" + c;\n  },\n  getBackgroundColor: function () {\n    return randomMC.getColor({ shades: ['200', '300']});\n  },\n  derender: function () {\n    let node = document.getElementById('todo_' + this.id);\n    document.getElementById('mainContainer').removeChild(node);\n\n    return this;\n  },\n};\n\nmodule.exports = Card;","const Card = require('./Card'),\n  pubsub = require('../lib/pubsub');\n\nlet CardManager = {\n  init: function () {\n    this.cards = [];\n\n    return this;\n  },\n  addCard: function (card) {\n    this.cards.push(card);\n    card.id = this.cards.length - 1;\n\n    return card;\n  },\n  removeCard: function (id) {\n    this.cards[id].derender();\n    this.cards[id] = undefined;\n\n    return this;\n  },\n  redrawCard: function (cardId, x, y) {\n    let card = this.cards[cardId];\n    card.x = x;\n    card.y = y;\n\n    card.derender();\n    card.render();\n\n    return this;\n  },\n  saveCards: function () {\n    if (typeof(Storage) !== 'undefined') {\n      localStorage.setItem('cards', JSON.stringify(this.cards));\n    } else {\n      console.log('you don\\'t have local storage :(');\n    }\n\n    return this;\n  },\n  loadCards: function () {\n    this.cards = JSON.parse(localStorage.getItem('cards'));\n    if (this.cards === null) this.cards = [];\n\n    this.clearArray();\n\n    return this;\n  },\n  clearArray: function () {\n    let i;\n\n    this.cards = this.cards.filter(function (elem) {\n      return elem !== undefined && elem !== null;\n    });\n    for (i in this.cards) {\n      if (this.cards.hasOwnProperty(i)) {\n        this.cards[i].id = i;\n      }\n    }\n\n    return this;\n  },\n  renderAllCards: function () {\n    this.cards.forEach(function (card) {\n      Object.setPrototypeOf(card, Card);\n      card.render();\n    });\n\n    return this;\n  },\n  getInstance: function () {\n    if (CardManager.instance === undefined) {\n      CardManager.instance = Object.create(CardManager, {});\n      pubsub.sub(window.CONFIG.SAVE_CARDS, CardManager.instance.saveCards, CardManager.instance);\n    }\n\n    return CardManager.instance;\n\n  },\n};\n\nmodule.exports = CardManager;","let cardManager = require('./models/CardManager').getInstance();\n\nfunction createDiv(text, className) {\n  let div = document.createElement('div');\n  div.innerHTML = text;\n  div.style.float = \"right\";\n  div.style.cursor = \"pointer\";\n  div.style.width = \"16px\";\n  div.style.textAlign = \"center\";\n\n  if (className !== undefined) {\n    div.className = className;\n  }\n\n  return div;\n}\n\nfunction copySelectionText() {\n  let copysuccess; // let to check whether execCommand successfully executed\n  try {\n    copysuccess = document.execCommand(\"copy\"); // run command to copy selected text to clipboard\n  } catch (e) {\n    copysuccess = false\n  }\n  return copysuccess\n}\n\nfunction selectText(element) {\n  let doc = document\n    , text = element\n    , range, selection\n    ;\n  if (doc.body.createTextRange) {\n    range = document.body.createTextRange();\n    range.moveToElementText(text);\n    range.select();\n  } else if (window.getSelection) {\n    selection = window.getSelection();\n    range = document.createRange();\n    range.selectNodeContents(text);\n    selection.removeAllRanges();\n    selection.addRange(range);\n    return selection;\n  }\n}\n\nfunction getParentCardId(context) {\n  if (context.parentElement === null) return;\n  return parseInt(context.parentElement.id.split(\"_\")[1]);\n}\n\nfunction changeDepth(cardId, increment) {\n  let depth = parseInt(this.parentElement.style.zIndex) + increment;\n\n  this.parentElement.style.zIndex = depth;\n  cardManager.cards[cardId].depth = depth;\n  this.parentElement.getElementsByClassName(\"depth\")[0].innerHTML = depth;\n}\n\n// PROTOTYPES\n\n/*\n * Returns the size of an array\n */\nArray.prototype.size = function () {\n  return this.filter(function (a) {\n    return a !== undefined;\n  }).length\n};\n\n/*\n * Returns the size of an object\n */\nObject.size = function (obj) {\n  let size = 0, key = \"\";\n\n  for (key in obj) {\n    if (obj.hasOwnProperty(key)) size++;\n  }\n  return size;\n};\n\nmodule.exports = {\n  createDiv: createDiv,\n  copySelectionText: copySelectionText,\n  selectText: selectText,\n  getParentCardId: getParentCardId,\n  changeDepth: changeDepth\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvcmFuZG9tLW1hdGVyaWFsLWNvbG9yL2Rpc3QvcmFuZG9tQ29sb3IuanMiLCJub2RlX21vZHVsZXMvcmFuZG9tLW1hdGVyaWFsLWNvbG9yL25vZGVfbW9kdWxlcy9tdXJtdXJoYXNoLWpzL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3JhbmRvbS1tYXRlcmlhbC1jb2xvci9ub2RlX21vZHVsZXMvbXVybXVyaGFzaC1qcy9tdXJtdXJoYXNoMl9nYy5qcyIsIm5vZGVfbW9kdWxlcy9yYW5kb20tbWF0ZXJpYWwtY29sb3Ivbm9kZV9tb2R1bGVzL211cm11cmhhc2gtanMvbXVybXVyaGFzaDNfZ2MuanMiLCJzcmMvanMvY29uZmlnLmpzIiwic3JjL2pzL2xpYi9wdWJzdWIuanMiLCJzcmMvanMvbWFpbi5qcyIsInNyYy9qcy9tb2RlbHMvQ2FyZC5qcyIsInNyYy9qcy9tb2RlbHMvQ2FyZE1hbmFnZXIuanMiLCJzcmMvanMvcHJvdG90eXBlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3REQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25FQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwidmFyIGRlZmF1bHRQYWxldHRlPXs1MDpbXCIjRkZFQkVFXCIsXCIjRkNFNEVDXCIsXCIjRjNFNUY1XCIsXCIjRURFN0Y2XCIsXCIjRThFQUY2XCIsXCIjRTNGMkZEXCIsXCIjRTFGNUZFXCIsXCIjRTBGN0ZBXCIsXCIjRTBGMkYxXCIsXCIjRThGNUU5XCIsXCIjRjFGOEU5XCIsXCIjRjlGQkU3XCIsXCIjRkZGREU3XCIsXCIjRkZGOEUxXCIsXCIjRkZGM0UwXCIsXCIjRkJFOUU3XCIsXCIjRUZFQkU5XCIsXCIjRkFGQUZBXCIsXCIjRUNFRkYxXCJdLDEwMDpbXCIjRkZDREQyXCIsXCIjRjhCQkQwXCIsXCIjRTFCRUU3XCIsXCIjRDFDNEU5XCIsXCIjQzVDQUU5XCIsXCIjQkJERUZCXCIsXCIjQjNFNUZDXCIsXCIjQjJFQkYyXCIsXCIjQjJERkRCXCIsXCIjQzhFNkM5XCIsXCIjRENFREM4XCIsXCIjRjBGNEMzXCIsXCIjRkZGOUM0XCIsXCIjRkZFQ0IzXCIsXCIjRkZFMEIyXCIsXCIjRkZDQ0JDXCIsXCIjRDdDQ0M4XCIsXCIjRjVGNUY1XCIsXCIjQ0ZEOERDXCJdLDIwMDpbXCIjRUY5QTlBXCIsXCIjRjQ4RkIxXCIsXCIjQ0U5M0Q4XCIsXCIjQjM5RERCXCIsXCIjOUZBOERBXCIsXCIjOTBDQUY5XCIsXCIjODFENEZBXCIsXCIjODBERUVBXCIsXCIjODBDQkM0XCIsXCIjQTVENkE3XCIsXCIjQzVFMUE1XCIsXCIjRTZFRTlDXCIsXCIjRkZGNTlEXCIsXCIjRkZFMDgyXCIsXCIjRkZDQzgwXCIsXCIjRkZBQjkxXCIsXCIjQkNBQUE0XCIsXCIjRUVFRUVFXCIsXCIjQjBCRUM1XCJdLDMwMDpbXCIjRTU3MzczXCIsXCIjRjA2MjkyXCIsXCIjQkE2OEM4XCIsXCIjOTU3NUNEXCIsXCIjNzk4NkNCXCIsXCIjNjRCNUY2XCIsXCIjNEZDM0Y3XCIsXCIjNEREMEUxXCIsXCIjNERCNkFDXCIsXCIjODFDNzg0XCIsXCIjQUVENTgxXCIsXCIjRENFNzc1XCIsXCIjRkZGMTc2XCIsXCIjRkZENTRGXCIsXCIjRkZCNzREXCIsXCIjRkY4QTY1XCIsXCIjQTE4ODdGXCIsXCIjRTBFMEUwXCIsXCIjOTBBNEFFXCJdLDQwMDpbXCIjRUY1MzUwXCIsXCIjRUM0MDdBXCIsXCIjQUI0N0JDXCIsXCIjN0U1N0MyXCIsXCIjNUM2QkMwXCIsXCIjNDJBNUY1XCIsXCIjMjlCNkY2XCIsXCIjMjZDNkRBXCIsXCIjMjZBNjlBXCIsXCIjNjZCQjZBXCIsXCIjOUNDQzY1XCIsXCIjRDRFMTU3XCIsXCIjRkZFRTU4XCIsXCIjRkZDQTI4XCIsXCIjRkZBNzI2XCIsXCIjRkY3MDQzXCIsXCIjOEQ2RTYzXCIsXCIjQkRCREJEXCIsXCIjNzg5MDlDXCJdLDUwMDpbXCIjRjQ0MzM2XCIsXCIjRTkxRTYzXCIsXCIjOUMyN0IwXCIsXCIjNjczQUI3XCIsXCIjM0Y1MUI1XCIsXCIjMjE5NkYzXCIsXCIjMDNBOUY0XCIsXCIjMDBCQ0Q0XCIsXCIjMDA5Njg4XCIsXCIjNENBRjUwXCIsXCIjOEJDMzRBXCIsXCIjQ0REQzM5XCIsXCIjRkZFQjNCXCIsXCIjRkZDMTA3XCIsXCIjRkY5ODAwXCIsXCIjRkY1NzIyXCIsXCIjNzk1NTQ4XCIsXCIjOUU5RTlFXCIsXCIjNjA3RDhCXCJdLDYwMDpbXCIjRTUzOTM1XCIsXCIjRDgxQjYwXCIsXCIjOEUyNEFBXCIsXCIjNUUzNUIxXCIsXCIjMzk0OUFCXCIsXCIjMUU4OEU1XCIsXCIjMDM5QkU1XCIsXCIjMDBBQ0MxXCIsXCIjMDA4OTdCXCIsXCIjNDNBMDQ3XCIsXCIjN0NCMzQyXCIsXCIjQzBDQTMzXCIsXCIjRkREODM1XCIsXCIjRkZCMzAwXCIsXCIjRkI4QzAwXCIsXCIjRjQ1MTFFXCIsXCIjNkQ0QzQxXCIsXCIjNzU3NTc1XCIsXCIjNTQ2RTdBXCJdLDcwMDpbXCIjRDMyRjJGXCIsXCIjQzIxODVCXCIsXCIjN0IxRkEyXCIsXCIjNTEyREE4XCIsXCIjMzAzRjlGXCIsXCIjMTk3NkQyXCIsXCIjMDI4OEQxXCIsXCIjMDA5N0E3XCIsXCIjMDA3OTZCXCIsXCIjMzg4RTNDXCIsXCIjNjg5RjM4XCIsXCIjQUZCNDJCXCIsXCIjRkJDMDJEXCIsXCIjRkZBMDAwXCIsXCIjRjU3QzAwXCIsXCIjRTY0QTE5XCIsXCIjNUQ0MDM3XCIsXCIjNjE2MTYxXCIsXCIjNDU1QTY0XCJdLDgwMDpbXCIjQzYyODI4XCIsXCIjQUQxNDU3XCIsXCIjNkExQjlBXCIsXCIjNDUyN0EwXCIsXCIjMjgzNTkzXCIsXCIjMTU2NUMwXCIsXCIjMDI3N0JEXCIsXCIjMDA4MzhGXCIsXCIjMDA2OTVDXCIsXCIjMkU3RDMyXCIsXCIjNTU4QjJGXCIsXCIjOUU5RDI0XCIsXCIjRjlBODI1XCIsXCIjRkY4RjAwXCIsXCIjRUY2QzAwXCIsXCIjRDg0MzE1XCIsXCIjNEUzNDJFXCIsXCIjNDI0MjQyXCIsXCIjMzc0NzRGXCJdLDkwMDpbXCIjQjcxQzFDXCIsXCIjODgwRTRGXCIsXCIjNEExNDhDXCIsXCIjMzExQjkyXCIsXCIjMUEyMzdFXCIsXCIjMEQ0N0ExXCIsXCIjMDE1NzlCXCIsXCIjMDA2MDY0XCIsXCIjMDA0RDQwXCIsXCIjMUI1RTIwXCIsXCIjMzM2OTFFXCIsXCIjODI3NzE3XCIsXCIjRjU3RjE3XCIsXCIjRkY2RjAwXCIsXCIjRTY1MTAwXCIsXCIjQkYzNjBDXCIsXCIjM0UyNzIzXCIsXCIjMjEyMTIxXCIsXCIjMjYzMjM4XCJdLEExMDA6W1wiI0ZGOEE4MFwiLFwiI0ZGODBBQlwiLFwiI0VBODBGQ1wiLFwiI0IzODhGRlwiLFwiIzhDOUVGRlwiLFwiIzgyQjFGRlwiLFwiIzgwRDhGRlwiLFwiIzg0RkZGRlwiLFwiI0E3RkZFQlwiLFwiI0I5RjZDQVwiLFwiI0NDRkY5MFwiLFwiI0Y0RkY4MVwiLFwiI0ZGRkY4RFwiLFwiI0ZGRTU3RlwiLFwiI0ZGRDE4MFwiLFwiI0ZGOUU4MFwiXSxBMjAwOltcIiNGRjUyNTJcIixcIiNGRjQwODFcIixcIiNFMDQwRkJcIixcIiM3QzRERkZcIixcIiM1MzZERkVcIixcIiM0NDhBRkZcIixcIiM0MEM0RkZcIixcIiMxOEZGRkZcIixcIiM2NEZGREFcIixcIiM2OUYwQUVcIixcIiNCMkZGNTlcIixcIiNFRUZGNDFcIixcIiNGRkZGMDBcIixcIiNGRkQ3NDBcIixcIiNGRkFCNDBcIixcIiNGRjZFNDBcIl0sQTQwMDpbXCIjRkYxNzQ0XCIsXCIjRjUwMDU3XCIsXCIjRDUwMEY5XCIsXCIjNjUxRkZGXCIsXCIjM0Q1QUZFXCIsXCIjMjk3OUZGXCIsXCIjMDBCMEZGXCIsXCIjMDBFNUZGXCIsXCIjMURFOUI2XCIsXCIjMDBFNjc2XCIsXCIjNzZGRjAzXCIsXCIjQzZGRjAwXCIsXCIjRkZFQTAwXCIsXCIjRkZDNDAwXCIsXCIjRkY5MTAwXCIsXCIjRkYzRDAwXCJdLEE3MDA6W1wiI0Q1MDAwMFwiLFwiI0M1MTE2MlwiLFwiI0FBMDBGRlwiLFwiIzYyMDBFQVwiLFwiIzMwNEZGRVwiLFwiIzI5NjJGRlwiLFwiIzAwOTFFQVwiLFwiIzAwQjhENFwiLFwiIzAwQkZBNVwiLFwiIzAwQzg1M1wiLFwiIzY0REQxN1wiLFwiI0FFRUEwMFwiLFwiI0ZGRDYwMFwiLFwiI0ZGQUIwMFwiLFwiI0ZGNkQwMFwiLFwiI0REMkMwMFwiXX0sbXVybXVyPXJlcXVpcmUoXCJtdXJtdXJoYXNoLWpzXCIpO21vZHVsZS5leHBvcnRzPWZ1bmN0aW9uKCl7dmFyIEY9W10sRT17c2hhZGVzOltcIjUwMFwiXSxwYWxldHRlOmRlZmF1bHRQYWxldHRlLHRleHQ6bnVsbCxpZ25vcmVDb2xvcnM6W119LEM9ZnVuY3Rpb24oQyl7Q3x8KEM9RSksQy5wYWxldHRlfHwoQy5wYWxldHRlPWRlZmF1bHRQYWxldHRlKSxDLnNoYWRlc3x8KEMuc2hhZGVzPVtcIjUwMFwiXSk7Zm9yKHZhciBCLEQ9Ri5sZW5ndGgsdD0wO0Q+dDt0KyspaWYoQy50ZXh0JiZGW3RdLnRleHQ9PT1DLnRleHQpcmV0dXJuIEZbdF0uY29sb3I7cmV0dXJuIEI9QShDKSxDLnRleHQmJkYucHVzaCh7dGV4dDpDLnRleHQsY29sb3I6Qn0pLEJ9LEE9ZnVuY3Rpb24oRil7dmFyIEU9Ri5zaGFkZXNbQihGLnNoYWRlcy5sZW5ndGgpXSxDPVwiXCI7Zm9yKHZhciBBIGluIEYucGFsZXR0ZSlGLnBhbGV0dGUuaGFzT3duUHJvcGVydHkoQSkmJkE9PT1FJiYoQz1GLnRleHQ/Ri5wYWxldHRlW0FdW0QoRi50ZXh0LEYucGFsZXR0ZVtBXS5sZW5ndGgpXTpGLnBhbGV0dGVbQV1bQihGLnBhbGV0dGVbQV0ubGVuZ3RoKV0pO3JldHVybiBDfSxCPWZ1bmN0aW9uKEYpe3JldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqRil9LEQ9ZnVuY3Rpb24oRixFKXt2YXIgQz1tdXJtdXIubXVybXVyMyhGKS8xZTEwO3JldHVybi4xPkMmJihDPTEwKkMpLE1hdGguZmxvb3IoQypFKX07cmV0dXJue2dldENvbG9yOkN9fSgpOyIsInZhciBtdXJtdXIzID0gcmVxdWlyZShcIi4vbXVybXVyaGFzaDNfZ2MuanNcIilcbnZhciBtdXJtdXIyID0gcmVxdWlyZShcIi4vbXVybXVyaGFzaDJfZ2MuanNcIilcblxubW9kdWxlLmV4cG9ydHMgPSBtdXJtdXIzXG5tb2R1bGUuZXhwb3J0cy5tdXJtdXIzID0gbXVybXVyM1xubW9kdWxlLmV4cG9ydHMubXVybXVyMiA9IG11cm11cjJcbiIsIi8qKlxuICogSlMgSW1wbGVtZW50YXRpb24gb2YgTXVybXVySGFzaDJcbiAqIFxuICogQGF1dGhvciA8YSBocmVmPVwibWFpbHRvOmdhcnkuY291cnRAZ21haWwuY29tXCI+R2FyeSBDb3VydDwvYT5cbiAqIEBzZWUgaHR0cDovL2dpdGh1Yi5jb20vZ2FyeWNvdXJ0L211cm11cmhhc2gtanNcbiAqIEBhdXRob3IgPGEgaHJlZj1cIm1haWx0bzphYXBwbGVieUBnbWFpbC5jb21cIj5BdXN0aW4gQXBwbGVieTwvYT5cbiAqIEBzZWUgaHR0cDovL3NpdGVzLmdvb2dsZS5jb20vc2l0ZS9tdXJtdXJoYXNoL1xuICogXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyIEFTQ0lJIG9ubHlcbiAqIEBwYXJhbSB7bnVtYmVyfSBzZWVkIFBvc2l0aXZlIGludGVnZXIgb25seVxuICogQHJldHVybiB7bnVtYmVyfSAzMi1iaXQgcG9zaXRpdmUgaW50ZWdlciBoYXNoXG4gKi9cblxuZnVuY3Rpb24gbXVybXVyaGFzaDJfMzJfZ2Moc3RyLCBzZWVkKSB7XG4gIHZhclxuICAgIGwgPSBzdHIubGVuZ3RoLFxuICAgIGggPSBzZWVkIF4gbCxcbiAgICBpID0gMCxcbiAgICBrO1xuICBcbiAgd2hpbGUgKGwgPj0gNCkge1xuICBcdGsgPSBcbiAgXHQgICgoc3RyLmNoYXJDb2RlQXQoaSkgJiAweGZmKSkgfFxuICBcdCAgKChzdHIuY2hhckNvZGVBdCgrK2kpICYgMHhmZikgPDwgOCkgfFxuICBcdCAgKChzdHIuY2hhckNvZGVBdCgrK2kpICYgMHhmZikgPDwgMTYpIHxcbiAgXHQgICgoc3RyLmNoYXJDb2RlQXQoKytpKSAmIDB4ZmYpIDw8IDI0KTtcbiAgICBcbiAgICBrID0gKCgoayAmIDB4ZmZmZikgKiAweDViZDFlOTk1KSArICgoKChrID4+PiAxNikgKiAweDViZDFlOTk1KSAmIDB4ZmZmZikgPDwgMTYpKTtcbiAgICBrIF49IGsgPj4+IDI0O1xuICAgIGsgPSAoKChrICYgMHhmZmZmKSAqIDB4NWJkMWU5OTUpICsgKCgoKGsgPj4+IDE2KSAqIDB4NWJkMWU5OTUpICYgMHhmZmZmKSA8PCAxNikpO1xuXG5cdGggPSAoKChoICYgMHhmZmZmKSAqIDB4NWJkMWU5OTUpICsgKCgoKGggPj4+IDE2KSAqIDB4NWJkMWU5OTUpICYgMHhmZmZmKSA8PCAxNikpIF4gaztcblxuICAgIGwgLT0gNDtcbiAgICArK2k7XG4gIH1cbiAgXG4gIHN3aXRjaCAobCkge1xuICBjYXNlIDM6IGggXj0gKHN0ci5jaGFyQ29kZUF0KGkgKyAyKSAmIDB4ZmYpIDw8IDE2O1xuICBjYXNlIDI6IGggXj0gKHN0ci5jaGFyQ29kZUF0KGkgKyAxKSAmIDB4ZmYpIDw8IDg7XG4gIGNhc2UgMTogaCBePSAoc3RyLmNoYXJDb2RlQXQoaSkgJiAweGZmKTtcbiAgICAgICAgICBoID0gKCgoaCAmIDB4ZmZmZikgKiAweDViZDFlOTk1KSArICgoKChoID4+PiAxNikgKiAweDViZDFlOTk1KSAmIDB4ZmZmZikgPDwgMTYpKTtcbiAgfVxuXG4gIGggXj0gaCA+Pj4gMTM7XG4gIGggPSAoKChoICYgMHhmZmZmKSAqIDB4NWJkMWU5OTUpICsgKCgoKGggPj4+IDE2KSAqIDB4NWJkMWU5OTUpICYgMHhmZmZmKSA8PCAxNikpO1xuICBoIF49IGggPj4+IDE1O1xuXG4gIHJldHVybiBoID4+PiAwO1xufVxuXG5pZih0eXBlb2YgbW9kdWxlICE9PSB1bmRlZmluZWQpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSBtdXJtdXJoYXNoMl8zMl9nY1xufVxuIiwiLyoqXG4gKiBKUyBJbXBsZW1lbnRhdGlvbiBvZiBNdXJtdXJIYXNoMyAocjEzNikgKGFzIG9mIE1heSAyMCwgMjAxMSlcbiAqIFxuICogQGF1dGhvciA8YSBocmVmPVwibWFpbHRvOmdhcnkuY291cnRAZ21haWwuY29tXCI+R2FyeSBDb3VydDwvYT5cbiAqIEBzZWUgaHR0cDovL2dpdGh1Yi5jb20vZ2FyeWNvdXJ0L211cm11cmhhc2gtanNcbiAqIEBhdXRob3IgPGEgaHJlZj1cIm1haWx0bzphYXBwbGVieUBnbWFpbC5jb21cIj5BdXN0aW4gQXBwbGVieTwvYT5cbiAqIEBzZWUgaHR0cDovL3NpdGVzLmdvb2dsZS5jb20vc2l0ZS9tdXJtdXJoYXNoL1xuICogXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IEFTQ0lJIG9ubHlcbiAqIEBwYXJhbSB7bnVtYmVyfSBzZWVkIFBvc2l0aXZlIGludGVnZXIgb25seVxuICogQHJldHVybiB7bnVtYmVyfSAzMi1iaXQgcG9zaXRpdmUgaW50ZWdlciBoYXNoIFxuICovXG5cbmZ1bmN0aW9uIG11cm11cmhhc2gzXzMyX2djKGtleSwgc2VlZCkge1xuXHR2YXIgcmVtYWluZGVyLCBieXRlcywgaDEsIGgxYiwgYzEsIGMxYiwgYzIsIGMyYiwgazEsIGk7XG5cdFxuXHRyZW1haW5kZXIgPSBrZXkubGVuZ3RoICYgMzsgLy8ga2V5Lmxlbmd0aCAlIDRcblx0Ynl0ZXMgPSBrZXkubGVuZ3RoIC0gcmVtYWluZGVyO1xuXHRoMSA9IHNlZWQ7XG5cdGMxID0gMHhjYzllMmQ1MTtcblx0YzIgPSAweDFiODczNTkzO1xuXHRpID0gMDtcblx0XG5cdHdoaWxlIChpIDwgYnl0ZXMpIHtcblx0ICBcdGsxID0gXG5cdCAgXHQgICgoa2V5LmNoYXJDb2RlQXQoaSkgJiAweGZmKSkgfFxuXHQgIFx0ICAoKGtleS5jaGFyQ29kZUF0KCsraSkgJiAweGZmKSA8PCA4KSB8XG5cdCAgXHQgICgoa2V5LmNoYXJDb2RlQXQoKytpKSAmIDB4ZmYpIDw8IDE2KSB8XG5cdCAgXHQgICgoa2V5LmNoYXJDb2RlQXQoKytpKSAmIDB4ZmYpIDw8IDI0KTtcblx0XHQrK2k7XG5cdFx0XG5cdFx0azEgPSAoKCgoazEgJiAweGZmZmYpICogYzEpICsgKCgoKGsxID4+PiAxNikgKiBjMSkgJiAweGZmZmYpIDw8IDE2KSkpICYgMHhmZmZmZmZmZjtcblx0XHRrMSA9IChrMSA8PCAxNSkgfCAoazEgPj4+IDE3KTtcblx0XHRrMSA9ICgoKChrMSAmIDB4ZmZmZikgKiBjMikgKyAoKCgoazEgPj4+IDE2KSAqIGMyKSAmIDB4ZmZmZikgPDwgMTYpKSkgJiAweGZmZmZmZmZmO1xuXG5cdFx0aDEgXj0gazE7XG4gICAgICAgIGgxID0gKGgxIDw8IDEzKSB8IChoMSA+Pj4gMTkpO1xuXHRcdGgxYiA9ICgoKChoMSAmIDB4ZmZmZikgKiA1KSArICgoKChoMSA+Pj4gMTYpICogNSkgJiAweGZmZmYpIDw8IDE2KSkpICYgMHhmZmZmZmZmZjtcblx0XHRoMSA9ICgoKGgxYiAmIDB4ZmZmZikgKyAweDZiNjQpICsgKCgoKGgxYiA+Pj4gMTYpICsgMHhlNjU0KSAmIDB4ZmZmZikgPDwgMTYpKTtcblx0fVxuXHRcblx0azEgPSAwO1xuXHRcblx0c3dpdGNoIChyZW1haW5kZXIpIHtcblx0XHRjYXNlIDM6IGsxIF49IChrZXkuY2hhckNvZGVBdChpICsgMikgJiAweGZmKSA8PCAxNjtcblx0XHRjYXNlIDI6IGsxIF49IChrZXkuY2hhckNvZGVBdChpICsgMSkgJiAweGZmKSA8PCA4O1xuXHRcdGNhc2UgMTogazEgXj0gKGtleS5jaGFyQ29kZUF0KGkpICYgMHhmZik7XG5cdFx0XG5cdFx0azEgPSAoKChrMSAmIDB4ZmZmZikgKiBjMSkgKyAoKCgoazEgPj4+IDE2KSAqIGMxKSAmIDB4ZmZmZikgPDwgMTYpKSAmIDB4ZmZmZmZmZmY7XG5cdFx0azEgPSAoazEgPDwgMTUpIHwgKGsxID4+PiAxNyk7XG5cdFx0azEgPSAoKChrMSAmIDB4ZmZmZikgKiBjMikgKyAoKCgoazEgPj4+IDE2KSAqIGMyKSAmIDB4ZmZmZikgPDwgMTYpKSAmIDB4ZmZmZmZmZmY7XG5cdFx0aDEgXj0gazE7XG5cdH1cblx0XG5cdGgxIF49IGtleS5sZW5ndGg7XG5cblx0aDEgXj0gaDEgPj4+IDE2O1xuXHRoMSA9ICgoKGgxICYgMHhmZmZmKSAqIDB4ODVlYmNhNmIpICsgKCgoKGgxID4+PiAxNikgKiAweDg1ZWJjYTZiKSAmIDB4ZmZmZikgPDwgMTYpKSAmIDB4ZmZmZmZmZmY7XG5cdGgxIF49IGgxID4+PiAxMztcblx0aDEgPSAoKCgoaDEgJiAweGZmZmYpICogMHhjMmIyYWUzNSkgKyAoKCgoaDEgPj4+IDE2KSAqIDB4YzJiMmFlMzUpICYgMHhmZmZmKSA8PCAxNikpKSAmIDB4ZmZmZmZmZmY7XG5cdGgxIF49IGgxID4+PiAxNjtcblxuXHRyZXR1cm4gaDEgPj4+IDA7XG59XG5cbmlmKHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSBtdXJtdXJoYXNoM18zMl9nY1xufSIsIm1vZHVsZS5leHBvcnRzID0ge1xuICBTQVZFX0NBUkRTOiAnU0FWRV9DQVJEUydcbn0iLCJcbnZhciBzdWJzID0ge307XG5cblxuZnVuY3Rpb24gcHViKG5hbWUsIHBhcmFtcykge1xuICBzdWJzW25hbWVdLmZvckVhY2goZnVuY3Rpb24oZWxlbSkge1xuICAgIGVsZW0uY2FsbGJhY2suYXBwbHkoZWxlbS5jb250ZXh0LCBwYXJhbXMpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gc3ViKG5hbWUsIGNhbGxiYWNrLCBjb250ZXh0KSB7XG4gIGlmIChzdWJzW25hbWVdID09PSB1bmRlZmluZWQpIHtcbiAgICBzdWJzW25hbWVdID0gW107XG4gIH1cblxuICBzdWJzW25hbWVdLnB1c2goe1xuICAgIGNhbGxiYWNrOiBjYWxsYmFjayxcbiAgICBjb250ZXh0OiBjb250ZXh0XG4gIH0pO1xufVxuXG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBwdWI6IHB1YixcbiAgc3ViOiBzdWJcbn07Iiwid2luZG93LkNPTkZJRyA9IHJlcXVpcmUoJy4vY29uZmlnLmpzJyk7XG5cbmxldCBwcm90b3R5cGVzID0gcmVxdWlyZSgnLi9wcm90b3R5cGVzJyksXG4gIENhcmQgPSByZXF1aXJlKCcuL21vZGVscy9DYXJkJyksXG4gIENhcmRNYW5hZ2VyID0gcmVxdWlyZSgnLi9tb2RlbHMvQ2FyZE1hbmFnZXInKTtcblxubGV0IG1haW5Db250YWluZXIsXG4gIGlucHV0LFxuICBlZGl0Q29udGFpbmVyLFxuICBlZGl0SW5wdXQ7XG5cblxubGV0IGNhcmRNYW5hZ2VyID0gQ2FyZE1hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcblxuT2JqZWN0LmFzc2lnbih3aW5kb3csIHJlcXVpcmUoJy4vcHJvdG90eXBlcycpKTtcblxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICAnc3RyaWN0IG1vZGUnO1xuXG4gIG1haW5Db250YWluZXIgPSAkKCcjbWFpbkNvbnRhaW5lcicpO1xuICBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNmb3JtQ29udGFpbmVyIGlucHV0Jyk7XG4gIGVkaXRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdENvbnRhaW5lcicpO1xuICBlZGl0SW5wdXQgPSBlZGl0Q29udGFpbmVyLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3RleHRhcmVhJylbMF07XG5cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGtleUhhbmRsZXIsIGZhbHNlKTtcbiAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIG1haW5JbnB1dEtleUV2ZW50KTtcbiAgZWRpdElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlZGl0SW5wdXRLZXlFdmVudCk7XG4gIGVkaXRDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoaWRlRWRpdENvbnRhaW5lcik7XG4gIGVkaXRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN0b3BQcm9wYWdhdGlvbik7XG4gIC8qXG4gICBPbiBkb3VibGUgY2xpY2sgZWRpdCB0aGUgY2FyZFxuICAgKi9cbiAgbWFpbkNvbnRhaW5lci5vbignZGJsY2xpY2snLCAnZGl2JywgZG91YmxlQ2xpY2tIYW5kbGVyKTtcbiAgLypcbiAgIE9uIGNsaWNrIHBlcmZvcm0gdGhlIGNhcmRcbiAgICovXG4gIG1haW5Db250YWluZXIub24oJ2NsaWNrJywgJ2RpdicsIGNhcmRDbGlja0V2ZW50cyk7XG4gIG1haW5Db250YWluZXIub24oJ2NsaWNrJywgJ2RpdiA+IGRpdicsIGNhcmRNZW51RXZlbnRzKTtcblxuXG4gIGNhcmRNYW5hZ2VyLmxvYWRDYXJkcygpO1xuICBjYXJkTWFuYWdlci5yZW5kZXJBbGxDYXJkcygpO1xuICBpbnB1dC5mb2N1cygpO1xufSk7XG5cbmZ1bmN0aW9uIGhpZGVFZGl0Q29udGFpbmVyKCkge1xuICBlZGl0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG59XG5cbmZ1bmN0aW9uIHN0b3BQcm9wYWdhdGlvbiAoZSkge1xuICBlLnN0b3BQcm9wYWdhdGlvbigpO1xufVxuXG5mdW5jdGlvbiBtYWluSW5wdXRLZXlFdmVudCAoZXZlbnQpIHtcbiAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIGxldCBjYXJkO1xuXG4gIGlmIChldmVudC5rZXlDb2RlID09PSAxMykge1xuICAgIGNhcmQgPSBjYXJkTWFuYWdlci5hZGRDYXJkKE9iamVjdC5jcmVhdGUoQ2FyZCwge30pLmluaXQoaW5wdXQudmFsdWUpKTtcbiAgICBjYXJkLnJlbmRlcigpO1xuICAgIHRoaXMudmFsdWUgPSAnJztcbiAgICBjYXJkTWFuYWdlci5zYXZlQ2FyZHMoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBlZGl0SW5wdXRLZXlFdmVudCAoZXZlbnQpIHtcbiAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIGxldCBjYXJkO1xuICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMgJiYgZXZlbnQuc2hpZnRLZXkpIHJldHVybjtcbiAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzKSB7XG4gICAgY2FyZCA9IGNhcmRNYW5hZ2VyLmNhcmRzW2VkaXRDb250YWluZXIuY2FyZElkXTtcbiAgICBjYXJkLm5hbWUgPSBlZGl0SW5wdXQudmFsdWU7XG4gICAgY2FyZC5kZXJlbmRlcigpO1xuICAgIGNhcmQucmVuZGVyKCk7XG4gICAgdGhpcy52YWx1ZSA9ICcnO1xuICAgIGNhcmRNYW5hZ2VyLnNhdmVDYXJkcygpO1xuICAgIGhpZGVFZGl0Q29udGFpbmVyKCk7XG4gIH0gZWxzZSBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMjcpIHtcbiAgICBoaWRlRWRpdENvbnRhaW5lcigpXG4gIH1cblxufVxuXG5mdW5jdGlvbiBrZXlIYW5kbGVyIChlKSB7XG4gIGxldCBUQUJLRVkgPSA5O1xuICBpZiAoZS5rZXlDb2RlID09PSBUQUJLRVkpIHtcbiAgICBpZiAoZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdNb3ZlVG9QcmV2aW91c0NhcmQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coJ01vdmVUb05leHRDYXJkJyk7XG4gICAgfVxuICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSBlbHNlIGlmIChldmVudC5rZXlDb2RlID09PSAyNykge1xuICAgIGhpZGVFZGl0Q29udGFpbmVyKClcbiAgfVxufVxuXG5mdW5jdGlvbiBkb3VibGVDbGlja0hhbmRsZXIgKCkge1xuICBsZXQgZWxlbSA9IHRoaXMucXVlcnlTZWxlY3RvcignLmNhcmRUZXh0JyksXG4gICAgY2FyZElkLFxuICAgIGNhcmQ7XG5cbiAgaWYgKHRoaXMuaWQgPT09ICcnKSB7XG4gICAgY2FyZElkID0gcGFyc2VJbnQodGhpcy5wYXJlbnRFbGVtZW50LmlkLnNwbGl0KCdfJylbMV0pO1xuICB9IGVsc2Uge1xuICAgIGNhcmRJZCA9IHBhcnNlSW50KHRoaXMuaWQuc3BsaXQoJ18nKVsxXSk7XG4gIH1cblxuICBjYXJkID0gY2FyZE1hbmFnZXIuY2FyZHNbY2FyZElkXTtcblxuICBlZGl0SW5wdXQudmFsdWUgPSBjYXJkLm5hbWU7XG4gIGVkaXRDb250YWluZXIuY2FyZElkID0gY2FyZElkO1xuICBlZGl0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICBlZGl0SW5wdXQuc3R5bGUudG9wID0gY2FyZC55O1xuICBlZGl0SW5wdXQuc3R5bGUubGVmdCA9IGNhcmQueDtcbiAgZWRpdElucHV0LnN0eWxlW1wicGFkZGluZy10b3BcIl0gPSAnMjNweCc7XG4gIGVkaXRJbnB1dC5mb2N1cygpO1xufVxuXG5mdW5jdGlvbiBjYXJkQ2xpY2tFdmVudHMgKGV2ZW50KSB7XG4gIGxldCBlbGVtID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcuY2FyZFRleHQnKSxcbiAgICBjYXJkSWQgPSBwYXJzZUludCh0aGlzLmlkLnNwbGl0KCdfJylbMV0pLFxuICAgIGNhcmQgPSBjYXJkTWFuYWdlci5jYXJkc1tjYXJkSWRdO1xuXG4gIGlmIChldmVudC5jdHJsS2V5KSB7XG4gIH1cbiAgaWYgKGV2ZW50LmFsdEtleSkge1xuICAgIHRoaXMucXVlcnlTZWxlY3RvcignLmNvcHknKS5jbGljaygpO1xuICB9XG4gIGlmIChldmVudC5zaGlmdEtleSkge1xuXG4gIH1cbn1cblxuZnVuY3Rpb24gY2FyZE1lbnVFdmVudHMgKCkge1xuICBsZXQgb3B0aW9uID0gJCh0aGlzKS5odG1sKCksXG4gICAgc2VsZWN0aW9uLFxuICAgIGNhcmRJZCA9IGdldFBhcmVudENhcmRJZCh0aGlzKTtcblxuICBzd2l0Y2ggKG9wdGlvbikge1xuICAgIGNhc2UgJysnOlxuICAgICAgY2hhbmdlRGVwdGguYXBwbHkodGhpcywgW2NhcmRJZCwgMV0pO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnLSc6XG4gICAgICBjaGFuZ2VEZXB0aC5hcHBseSh0aGlzLCBbY2FyZElkLCAtMV0pO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnQyc6XG4gICAgICBzZWxlY3Rpb24gPSBzZWxlY3RUZXh0KHRoaXMucGFyZW50RWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYXJkVGV4dCcpWzBdKTtcbiAgICAgIGNvcHlTZWxlY3Rpb25UZXh0KCk7XG4gICAgICBzZWxlY3Rpb24uZW1wdHkoKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3gnOlxuICAgICAgY2FyZE1hbmFnZXIucmVtb3ZlQ2FyZChjYXJkSWQsIC0xKTtcbiAgICAgIGJyZWFrO1xuICB9XG4gIGNhcmRNYW5hZ2VyLnNhdmVDYXJkcygpO1xufSIsImxldCBwdWJzdWIgPSByZXF1aXJlKCcuLi9saWIvcHVic3ViJyksXG4gIHJhbmRvbU1DID0gcmVxdWlyZSgncmFuZG9tLW1hdGVyaWFsLWNvbG9yJyk7XG5cblxubGV0IENhcmQgPSB7XG4gIGluaXQ6IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhpcy5pZCA9IC0xO1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5kZXB0aCA9IDU7XG4gICAgdGhpcy54ID0gMTAwO1xuICAgIHRoaXMueSA9IDEwMDtcbiAgICB0aGlzLmNvbG9yID0gdGhpcy5nZXRCYWNrZ3JvdW5kQ29sb3IoKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLFxuICAgICAgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLFxuICAgICAgdGhhdCA9IHRoaXM7XG5cbiAgICB0ZXh0LmlubmVySFRNTCA9IHRoaXMubmFtZS5yZXBsYWNlKC9cXHI/XFxuL2csJzxici8+Jyk7XG4gICAgdGV4dC5jbGFzc05hbWUgPSAnY2FyZFRleHQnO1xuXG4gICAgbm9kZS5pZCA9ICd0b2RvXycgKyB0aGlzLmlkO1xuICAgIG5vZGUuY2xhc3NOYW1lID0gJ2NhcmQgY2FyZC0xJztcbiAgICBub2RlLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICBub2RlLnN0eWxlLmxlZnQgPSB0aGlzLng7XG4gICAgbm9kZS5zdHlsZS50b3AgPSB0aGlzLnk7XG4gICAgbm9kZS5zdHlsZS5jdXJzb3IgPSAnLXdlYmtpdC1ncmFiJztcbiAgICBub2RlLnN0eWxlLnpJbmRleCA9IHRoaXMuZGVwdGg7XG4gICAgbm9kZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB0aGlzLmNvbG9yO1xuXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250YWluZXInKS5hcHBlbmRDaGlsZChub2RlKTtcblxuICAgIG5vZGUuYXBwZW5kQ2hpbGQoY3JlYXRlRGl2KCd4JywgJ2NvbnRyb2wgcmVtb3ZlJykpO1xuICAgIG5vZGUuYXBwZW5kQ2hpbGQoY3JlYXRlRGl2KCcrJywgJ2NvbnRyb2wgdXAnKSk7XG4gICAgbm9kZS5hcHBlbmRDaGlsZChjcmVhdGVEaXYoJy0nLCAnY29udHJvbCBkb3duJykpO1xuICAgIG5vZGUuYXBwZW5kQ2hpbGQoY3JlYXRlRGl2KCdDJywgJ2NvbnRyb2wgY29weScpKTtcbiAgICBub2RlLmFwcGVuZENoaWxkKGNyZWF0ZURpdih0aGlzLmRlcHRoLCAnZGVwdGgnKSk7XG5cbiAgICBub2RlLmFwcGVuZENoaWxkKHRleHQpO1xuXG4gICAgJCgnI3RvZG9fJyArIHRoaXMuaWQpLmRyYWdnYWJsZSh7XG4gICAgICBzdG9wOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCBjYXJkID0gJCgnI3RvZG9fJyArIHRoYXQuaWQpO1xuICAgICAgICB0aGF0LnggPSBjYXJkLmNzcygnbGVmdCcpO1xuICAgICAgICB0aGF0LnkgPSBjYXJkLmNzcygndG9wJyk7XG5cbiAgICAgICAgLy8gY2FyZE1hbmFnZXIuc2F2ZUNhcmRzKCk7XG4gICAgICAgIHB1YnN1Yi5wdWIod2luZG93LkNPTkZJRy5TQVZFX0NBUkRTKTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgZ2V0QmFja2dyb3VuZENvbG9yMjogZnVuY3Rpb24gKCkge1xuICAgIGxldCBjID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTY3NzcyMTUpLnRvU3RyaW5nKDE2KSwgIC8vIHN0cmlwICNcbiAgICAgcmdiID0gcGFyc2VJbnQoYywgMTYpLCAgIC8vIGNvbnZlcnQgcnJnZ2JiIHRvIGRlY2ltYWxcbiAgICAgciA9IChyZ2IgPj4gMTYpICYgMHhmZiwgIC8vIGV4dHJhY3QgcmVkXG4gICAgIGcgPSAocmdiID4+ICA4KSAmIDB4ZmYsIC8vIGV4dHJhY3QgZ3JlZW5cbiAgICAgYiA9IChyZ2IgPj4gIDApICYgMHhmZiwgIC8vIGV4dHJhY3QgYmx1ZVxuICAgICAvLyBsdW1hID0gMC4yMTI2ICogciArIDAuNzE1MiAqIGcgKyAwLjA3MjIgKiBiOyAvLyBwZXIgSVRVLVIgQlQuNzA5XG4gICAgIGx1bWEgPShyICsgZyArIGIpLzM7XG5cbiAgICBpZiAobHVtYSA8IDEyOCkge1xuICAgICAgY29uc29sZS5sb2cgKFwibm90IGVub3VnaCBsdW1hISBcIiArIGx1bWEpO1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0QmFja2dyb3VuZENvbG9yKCk7XG4gICAgfVxuICAgIHJldHVybiBcIiNcIiArIGM7XG4gIH0sXG4gIGdldEJhY2tncm91bmRDb2xvcjogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiByYW5kb21NQy5nZXRDb2xvcih7IHNoYWRlczogWycyMDAnLCAnMzAwJ119KTtcbiAgfSxcbiAgZGVyZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgbm9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2RvXycgKyB0aGlzLmlkKTtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbkNvbnRhaW5lcicpLnJlbW92ZUNoaWxkKG5vZGUpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IENhcmQ7IiwiY29uc3QgQ2FyZCA9IHJlcXVpcmUoJy4vQ2FyZCcpLFxuICBwdWJzdWIgPSByZXF1aXJlKCcuLi9saWIvcHVic3ViJyk7XG5cbmxldCBDYXJkTWFuYWdlciA9IHtcbiAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY2FyZHMgPSBbXTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICBhZGRDYXJkOiBmdW5jdGlvbiAoY2FyZCkge1xuICAgIHRoaXMuY2FyZHMucHVzaChjYXJkKTtcbiAgICBjYXJkLmlkID0gdGhpcy5jYXJkcy5sZW5ndGggLSAxO1xuXG4gICAgcmV0dXJuIGNhcmQ7XG4gIH0sXG4gIHJlbW92ZUNhcmQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHRoaXMuY2FyZHNbaWRdLmRlcmVuZGVyKCk7XG4gICAgdGhpcy5jYXJkc1tpZF0gPSB1bmRlZmluZWQ7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgcmVkcmF3Q2FyZDogZnVuY3Rpb24gKGNhcmRJZCwgeCwgeSkge1xuICAgIGxldCBjYXJkID0gdGhpcy5jYXJkc1tjYXJkSWRdO1xuICAgIGNhcmQueCA9IHg7XG4gICAgY2FyZC55ID0geTtcblxuICAgIGNhcmQuZGVyZW5kZXIoKTtcbiAgICBjYXJkLnJlbmRlcigpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIHNhdmVDYXJkczogZnVuY3Rpb24gKCkge1xuICAgIGlmICh0eXBlb2YoU3RvcmFnZSkgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FyZHMnLCBKU09OLnN0cmluZ2lmeSh0aGlzLmNhcmRzKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCd5b3UgZG9uXFwndCBoYXZlIGxvY2FsIHN0b3JhZ2UgOignKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgbG9hZENhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5jYXJkcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NhcmRzJykpO1xuICAgIGlmICh0aGlzLmNhcmRzID09PSBudWxsKSB0aGlzLmNhcmRzID0gW107XG5cbiAgICB0aGlzLmNsZWFyQXJyYXkoKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICBjbGVhckFycmF5OiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IGk7XG5cbiAgICB0aGlzLmNhcmRzID0gdGhpcy5jYXJkcy5maWx0ZXIoZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgIHJldHVybiBlbGVtICE9PSB1bmRlZmluZWQgJiYgZWxlbSAhPT0gbnVsbDtcbiAgICB9KTtcbiAgICBmb3IgKGkgaW4gdGhpcy5jYXJkcykge1xuICAgICAgaWYgKHRoaXMuY2FyZHMuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgdGhpcy5jYXJkc1tpXS5pZCA9IGk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIHJlbmRlckFsbENhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5jYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoY2FyZCwgQ2FyZCk7XG4gICAgICBjYXJkLnJlbmRlcigpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGdldEluc3RhbmNlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKENhcmRNYW5hZ2VyLmluc3RhbmNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIENhcmRNYW5hZ2VyLmluc3RhbmNlID0gT2JqZWN0LmNyZWF0ZShDYXJkTWFuYWdlciwge30pO1xuICAgICAgcHVic3ViLnN1Yih3aW5kb3cuQ09ORklHLlNBVkVfQ0FSRFMsIENhcmRNYW5hZ2VyLmluc3RhbmNlLnNhdmVDYXJkcywgQ2FyZE1hbmFnZXIuaW5zdGFuY2UpO1xuICAgIH1cblxuICAgIHJldHVybiBDYXJkTWFuYWdlci5pbnN0YW5jZTtcblxuICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBDYXJkTWFuYWdlcjsiLCJsZXQgY2FyZE1hbmFnZXIgPSByZXF1aXJlKCcuL21vZGVscy9DYXJkTWFuYWdlcicpLmdldEluc3RhbmNlKCk7XG5cbmZ1bmN0aW9uIGNyZWF0ZURpdih0ZXh0LCBjbGFzc05hbWUpIHtcbiAgbGV0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBkaXYuaW5uZXJIVE1MID0gdGV4dDtcbiAgZGl2LnN0eWxlLmZsb2F0ID0gXCJyaWdodFwiO1xuICBkaXYuc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG4gIGRpdi5zdHlsZS53aWR0aCA9IFwiMTZweFwiO1xuICBkaXYuc3R5bGUudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcblxuICBpZiAoY2xhc3NOYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICBkaXYuY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xuICB9XG5cbiAgcmV0dXJuIGRpdjtcbn1cblxuZnVuY3Rpb24gY29weVNlbGVjdGlvblRleHQoKSB7XG4gIGxldCBjb3B5c3VjY2VzczsgLy8gbGV0IHRvIGNoZWNrIHdoZXRoZXIgZXhlY0NvbW1hbmQgc3VjY2Vzc2Z1bGx5IGV4ZWN1dGVkXG4gIHRyeSB7XG4gICAgY29weXN1Y2Nlc3MgPSBkb2N1bWVudC5leGVjQ29tbWFuZChcImNvcHlcIik7IC8vIHJ1biBjb21tYW5kIHRvIGNvcHkgc2VsZWN0ZWQgdGV4dCB0byBjbGlwYm9hcmRcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvcHlzdWNjZXNzID0gZmFsc2VcbiAgfVxuICByZXR1cm4gY29weXN1Y2Nlc3Ncbn1cblxuZnVuY3Rpb24gc2VsZWN0VGV4dChlbGVtZW50KSB7XG4gIGxldCBkb2MgPSBkb2N1bWVudFxuICAgICwgdGV4dCA9IGVsZW1lbnRcbiAgICAsIHJhbmdlLCBzZWxlY3Rpb25cbiAgICA7XG4gIGlmIChkb2MuYm9keS5jcmVhdGVUZXh0UmFuZ2UpIHtcbiAgICByYW5nZSA9IGRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgcmFuZ2UubW92ZVRvRWxlbWVudFRleHQodGV4dCk7XG4gICAgcmFuZ2Uuc2VsZWN0KCk7XG4gIH0gZWxzZSBpZiAod2luZG93LmdldFNlbGVjdGlvbikge1xuICAgIHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcbiAgICByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XG4gICAgcmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKHRleHQpO1xuICAgIHNlbGVjdGlvbi5yZW1vdmVBbGxSYW5nZXMoKTtcbiAgICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xuICAgIHJldHVybiBzZWxlY3Rpb247XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0UGFyZW50Q2FyZElkKGNvbnRleHQpIHtcbiAgaWYgKGNvbnRleHQucGFyZW50RWxlbWVudCA9PT0gbnVsbCkgcmV0dXJuO1xuICByZXR1cm4gcGFyc2VJbnQoY29udGV4dC5wYXJlbnRFbGVtZW50LmlkLnNwbGl0KFwiX1wiKVsxXSk7XG59XG5cbmZ1bmN0aW9uIGNoYW5nZURlcHRoKGNhcmRJZCwgaW5jcmVtZW50KSB7XG4gIGxldCBkZXB0aCA9IHBhcnNlSW50KHRoaXMucGFyZW50RWxlbWVudC5zdHlsZS56SW5kZXgpICsgaW5jcmVtZW50O1xuXG4gIHRoaXMucGFyZW50RWxlbWVudC5zdHlsZS56SW5kZXggPSBkZXB0aDtcbiAgY2FyZE1hbmFnZXIuY2FyZHNbY2FyZElkXS5kZXB0aCA9IGRlcHRoO1xuICB0aGlzLnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImRlcHRoXCIpWzBdLmlubmVySFRNTCA9IGRlcHRoO1xufVxuXG4vLyBQUk9UT1RZUEVTXG5cbi8qXG4gKiBSZXR1cm5zIHRoZSBzaXplIG9mIGFuIGFycmF5XG4gKi9cbkFycmF5LnByb3RvdHlwZS5zaXplID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24gKGEpIHtcbiAgICByZXR1cm4gYSAhPT0gdW5kZWZpbmVkO1xuICB9KS5sZW5ndGhcbn07XG5cbi8qXG4gKiBSZXR1cm5zIHRoZSBzaXplIG9mIGFuIG9iamVjdFxuICovXG5PYmplY3Quc2l6ZSA9IGZ1bmN0aW9uIChvYmopIHtcbiAgbGV0IHNpemUgPSAwLCBrZXkgPSBcIlwiO1xuXG4gIGZvciAoa2V5IGluIG9iaikge1xuICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkgc2l6ZSsrO1xuICB9XG4gIHJldHVybiBzaXplO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGNyZWF0ZURpdjogY3JlYXRlRGl2LFxuICBjb3B5U2VsZWN0aW9uVGV4dDogY29weVNlbGVjdGlvblRleHQsXG4gIHNlbGVjdFRleHQ6IHNlbGVjdFRleHQsXG4gIGdldFBhcmVudENhcmRJZDogZ2V0UGFyZW50Q2FyZElkLFxuICBjaGFuZ2VEZXB0aDogY2hhbmdlRGVwdGhcbn0iXX0="}