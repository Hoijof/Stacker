{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","node_modules/random-material-color/dist/randomColor.js","node_modules/random-material-color/node_modules/murmurhash-js/index.js","node_modules/random-material-color/node_modules/murmurhash-js/murmurhash2_gc.js","node_modules/random-material-color/node_modules/murmurhash-js/murmurhash3_gc.js","src/js/config.js","src/js/lib/keyHandler.js","src/js/lib/pubsub.js","src/js/main.js","src/js/models/Card.js","src/js/models/CardManager.js","src/js/prototypes.js"],"names":[],"mappings":"AAAA;ACAA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var defaultPalette={50:[\"#FFEBEE\",\"#FCE4EC\",\"#F3E5F5\",\"#EDE7F6\",\"#E8EAF6\",\"#E3F2FD\",\"#E1F5FE\",\"#E0F7FA\",\"#E0F2F1\",\"#E8F5E9\",\"#F1F8E9\",\"#F9FBE7\",\"#FFFDE7\",\"#FFF8E1\",\"#FFF3E0\",\"#FBE9E7\",\"#EFEBE9\",\"#FAFAFA\",\"#ECEFF1\"],100:[\"#FFCDD2\",\"#F8BBD0\",\"#E1BEE7\",\"#D1C4E9\",\"#C5CAE9\",\"#BBDEFB\",\"#B3E5FC\",\"#B2EBF2\",\"#B2DFDB\",\"#C8E6C9\",\"#DCEDC8\",\"#F0F4C3\",\"#FFF9C4\",\"#FFECB3\",\"#FFE0B2\",\"#FFCCBC\",\"#D7CCC8\",\"#F5F5F5\",\"#CFD8DC\"],200:[\"#EF9A9A\",\"#F48FB1\",\"#CE93D8\",\"#B39DDB\",\"#9FA8DA\",\"#90CAF9\",\"#81D4FA\",\"#80DEEA\",\"#80CBC4\",\"#A5D6A7\",\"#C5E1A5\",\"#E6EE9C\",\"#FFF59D\",\"#FFE082\",\"#FFCC80\",\"#FFAB91\",\"#BCAAA4\",\"#EEEEEE\",\"#B0BEC5\"],300:[\"#E57373\",\"#F06292\",\"#BA68C8\",\"#9575CD\",\"#7986CB\",\"#64B5F6\",\"#4FC3F7\",\"#4DD0E1\",\"#4DB6AC\",\"#81C784\",\"#AED581\",\"#DCE775\",\"#FFF176\",\"#FFD54F\",\"#FFB74D\",\"#FF8A65\",\"#A1887F\",\"#E0E0E0\",\"#90A4AE\"],400:[\"#EF5350\",\"#EC407A\",\"#AB47BC\",\"#7E57C2\",\"#5C6BC0\",\"#42A5F5\",\"#29B6F6\",\"#26C6DA\",\"#26A69A\",\"#66BB6A\",\"#9CCC65\",\"#D4E157\",\"#FFEE58\",\"#FFCA28\",\"#FFA726\",\"#FF7043\",\"#8D6E63\",\"#BDBDBD\",\"#78909C\"],500:[\"#F44336\",\"#E91E63\",\"#9C27B0\",\"#673AB7\",\"#3F51B5\",\"#2196F3\",\"#03A9F4\",\"#00BCD4\",\"#009688\",\"#4CAF50\",\"#8BC34A\",\"#CDDC39\",\"#FFEB3B\",\"#FFC107\",\"#FF9800\",\"#FF5722\",\"#795548\",\"#9E9E9E\",\"#607D8B\"],600:[\"#E53935\",\"#D81B60\",\"#8E24AA\",\"#5E35B1\",\"#3949AB\",\"#1E88E5\",\"#039BE5\",\"#00ACC1\",\"#00897B\",\"#43A047\",\"#7CB342\",\"#C0CA33\",\"#FDD835\",\"#FFB300\",\"#FB8C00\",\"#F4511E\",\"#6D4C41\",\"#757575\",\"#546E7A\"],700:[\"#D32F2F\",\"#C2185B\",\"#7B1FA2\",\"#512DA8\",\"#303F9F\",\"#1976D2\",\"#0288D1\",\"#0097A7\",\"#00796B\",\"#388E3C\",\"#689F38\",\"#AFB42B\",\"#FBC02D\",\"#FFA000\",\"#F57C00\",\"#E64A19\",\"#5D4037\",\"#616161\",\"#455A64\"],800:[\"#C62828\",\"#AD1457\",\"#6A1B9A\",\"#4527A0\",\"#283593\",\"#1565C0\",\"#0277BD\",\"#00838F\",\"#00695C\",\"#2E7D32\",\"#558B2F\",\"#9E9D24\",\"#F9A825\",\"#FF8F00\",\"#EF6C00\",\"#D84315\",\"#4E342E\",\"#424242\",\"#37474F\"],900:[\"#B71C1C\",\"#880E4F\",\"#4A148C\",\"#311B92\",\"#1A237E\",\"#0D47A1\",\"#01579B\",\"#006064\",\"#004D40\",\"#1B5E20\",\"#33691E\",\"#827717\",\"#F57F17\",\"#FF6F00\",\"#E65100\",\"#BF360C\",\"#3E2723\",\"#212121\",\"#263238\"],A100:[\"#FF8A80\",\"#FF80AB\",\"#EA80FC\",\"#B388FF\",\"#8C9EFF\",\"#82B1FF\",\"#80D8FF\",\"#84FFFF\",\"#A7FFEB\",\"#B9F6CA\",\"#CCFF90\",\"#F4FF81\",\"#FFFF8D\",\"#FFE57F\",\"#FFD180\",\"#FF9E80\"],A200:[\"#FF5252\",\"#FF4081\",\"#E040FB\",\"#7C4DFF\",\"#536DFE\",\"#448AFF\",\"#40C4FF\",\"#18FFFF\",\"#64FFDA\",\"#69F0AE\",\"#B2FF59\",\"#EEFF41\",\"#FFFF00\",\"#FFD740\",\"#FFAB40\",\"#FF6E40\"],A400:[\"#FF1744\",\"#F50057\",\"#D500F9\",\"#651FFF\",\"#3D5AFE\",\"#2979FF\",\"#00B0FF\",\"#00E5FF\",\"#1DE9B6\",\"#00E676\",\"#76FF03\",\"#C6FF00\",\"#FFEA00\",\"#FFC400\",\"#FF9100\",\"#FF3D00\"],A700:[\"#D50000\",\"#C51162\",\"#AA00FF\",\"#6200EA\",\"#304FFE\",\"#2962FF\",\"#0091EA\",\"#00B8D4\",\"#00BFA5\",\"#00C853\",\"#64DD17\",\"#AEEA00\",\"#FFD600\",\"#FFAB00\",\"#FF6D00\",\"#DD2C00\"]},murmur=require(\"murmurhash-js\");module.exports=function(){var F=[],E={shades:[\"500\"],palette:defaultPalette,text:null,ignoreColors:[]},C=function(C){C||(C=E),C.palette||(C.palette=defaultPalette),C.shades||(C.shades=[\"500\"]);for(var B,D=F.length,t=0;D>t;t++)if(C.text&&F[t].text===C.text)return F[t].color;return B=A(C),C.text&&F.push({text:C.text,color:B}),B},A=function(F){var E=F.shades[B(F.shades.length)],C=\"\";for(var A in F.palette)F.palette.hasOwnProperty(A)&&A===E&&(C=F.text?F.palette[A][D(F.text,F.palette[A].length)]:F.palette[A][B(F.palette[A].length)]);return C},B=function(F){return Math.floor(Math.random()*F)},D=function(F,E){var C=murmur.murmur3(F)/1e10;return.1>C&&(C=10*C),Math.floor(C*E)};return{getColor:C}}();","var murmur3 = require(\"./murmurhash3_gc.js\")\nvar murmur2 = require(\"./murmurhash2_gc.js\")\n\nmodule.exports = murmur3\nmodule.exports.murmur3 = murmur3\nmodule.exports.murmur2 = murmur2\n","/**\n * JS Implementation of MurmurHash2\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} str ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash\n */\n\nfunction murmurhash2_32_gc(str, seed) {\n  var\n    l = str.length,\n    h = seed ^ l,\n    i = 0,\n    k;\n  \n  while (l >= 4) {\n  \tk = \n  \t  ((str.charCodeAt(i) & 0xff)) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 8) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 16) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 24);\n    \n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n    k ^= k >>> 24;\n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n\n\th = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16)) ^ k;\n\n    l -= 4;\n    ++i;\n  }\n  \n  switch (l) {\n  case 3: h ^= (str.charCodeAt(i + 2) & 0xff) << 16;\n  case 2: h ^= (str.charCodeAt(i + 1) & 0xff) << 8;\n  case 1: h ^= (str.charCodeAt(i) & 0xff);\n          h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  }\n\n  h ^= h >>> 13;\n  h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  h ^= h >>> 15;\n\n  return h >>> 0;\n}\n\nif(typeof module !== undefined) {\n  module.exports = murmurhash2_32_gc\n}\n","/**\n * JS Implementation of MurmurHash3 (r136) (as of May 20, 2011)\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} key ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash \n */\n\nfunction murmurhash3_32_gc(key, seed) {\n\tvar remainder, bytes, h1, h1b, c1, c1b, c2, c2b, k1, i;\n\t\n\tremainder = key.length & 3; // key.length % 4\n\tbytes = key.length - remainder;\n\th1 = seed;\n\tc1 = 0xcc9e2d51;\n\tc2 = 0x1b873593;\n\ti = 0;\n\t\n\twhile (i < bytes) {\n\t  \tk1 = \n\t  \t  ((key.charCodeAt(i) & 0xff)) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 8) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 16) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 24);\n\t\t++i;\n\t\t\n\t\tk1 = ((((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16))) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = ((((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16))) & 0xffffffff;\n\n\t\th1 ^= k1;\n        h1 = (h1 << 13) | (h1 >>> 19);\n\t\th1b = ((((h1 & 0xffff) * 5) + ((((h1 >>> 16) * 5) & 0xffff) << 16))) & 0xffffffff;\n\t\th1 = (((h1b & 0xffff) + 0x6b64) + ((((h1b >>> 16) + 0xe654) & 0xffff) << 16));\n\t}\n\t\n\tk1 = 0;\n\t\n\tswitch (remainder) {\n\t\tcase 3: k1 ^= (key.charCodeAt(i + 2) & 0xff) << 16;\n\t\tcase 2: k1 ^= (key.charCodeAt(i + 1) & 0xff) << 8;\n\t\tcase 1: k1 ^= (key.charCodeAt(i) & 0xff);\n\t\t\n\t\tk1 = (((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16)) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = (((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16)) & 0xffffffff;\n\t\th1 ^= k1;\n\t}\n\t\n\th1 ^= key.length;\n\n\th1 ^= h1 >>> 16;\n\th1 = (((h1 & 0xffff) * 0x85ebca6b) + ((((h1 >>> 16) * 0x85ebca6b) & 0xffff) << 16)) & 0xffffffff;\n\th1 ^= h1 >>> 13;\n\th1 = ((((h1 & 0xffff) * 0xc2b2ae35) + ((((h1 >>> 16) * 0xc2b2ae35) & 0xffff) << 16))) & 0xffffffff;\n\th1 ^= h1 >>> 16;\n\n\treturn h1 >>> 0;\n}\n\nif(typeof module !== \"undefined\") {\n  module.exports = murmurhash3_32_gc\n}","module.exports = {\n  SAVE_CARDS: 'SAVE_CARDS',\n  SELECT_CARD: 'SELECT_CARD',\n  ASCII: {\n    ESCAPE_KEY : 27,\n    TAB_KEY : 9,\n    C_KEY : 67,\n    D_KEY : 68,\n    E_KEY : 69,\n    PLUS_KEY : 187,\n    MINUS_KEY : 189,\n    DOT_KEY : 190,\n    A_KEY : 65,\n    KEYS_ARRAY :[27, 9, 67, 68, 69, 187, 189, 190, 65]\n  },\n  DEFAULT_CONTENT: 'W3siaWQiOjAsIm5hbWUiOiJVc2UgdGFiIGFuZCBzaGlmdCB0YWIgdG8gY2lyY2xlIGJldHdlZW4gY2FyZHMgOkRcblxuRHJhZ2dpbmcgb3IgY2xpY2tpbmcgdGhlbSB3aWxsIGFsc28gbWFyayB0aGVtIGFzIHNlbGVjdGVkIiwiZGVwdGgiOjUsIngiOiIxMjNweCIsInkiOiI1OXB4IiwiY29sb3IiOiIjNEREMEUxIiwic2VsZWN0ZWQiOmZhbHNlLCJub2RlIjp7ImpRdWVyeTE3MjA4MDc0NDM4ODQ5MDk2MTUzIjo5fX0seyJpZCI6MSwibmFtZSI6Ik9uIGEgbWFya2VkIGNhcmQgdXNlOlxuJ2MnIHRvIGNvcHkgdGhlIGNvbnRlbnRcbidkJyB0byBkZWxldGUgaXRcbidlJyB0byBlZGl0IGl0XG4nKycgYW5kICctJyB0byBtb2RpZnkgdGhlIGRlcHRoIG9mIHRoZSBjYXJkIGFuZCAnLicgdG8gcmVzZXQgaXQiLCJkZXB0aCI6NiwieCI6IjM0MnB4IiwieSI6IjU0cHgiLCJjb2xvciI6IiM4MENCQzQiLCJzZWxlY3RlZCI6ZmFsc2UsIm5vZGUiOnsialF1ZXJ5MTcyMDgwNzQ0Mzg4NDkwOTYxNTMiOjEzfX0seyJpZCI6MiwibmFtZSI6IldoaWxlIGVkaXRpbmcgdXNlIHNoaWZ0ICsgZW50ZXIgdG8gXG5pbnNlcnRcbmFcbmxpbmVcbmJyZWFrXG46RCIsImRlcHRoIjo1LCJ4IjoiMTIxcHgiLCJ5IjoiMjczcHgiLCJjb2xvciI6IiM2NEI1RjYiLCJzZWxlY3RlZCI6ZmFsc2UsIm5vZGUiOnsialF1ZXJ5MTcyMDgwNzQ0Mzg4NDkwOTYxNTMiOjE1fX1d',\n  VERSION: '0.3.3'\n};","const CONFIG = require('../config');\n\nlet cardManager,\n    Card = require('../models/Card');\n\nlet mainContainer,\n  input,\n  editContainer,\n  editInput,\n  importContainer,\n  importInput,\n  exportContainer,\n  exportContent,\n  importButton;\n\n\nfunction init(options) {\n  cardManager = options.cardManager;\n  bindings();\n}\n\nfunction bindings() {\n  mainContainer = $('#mainContainer');\n  input = document.querySelector('#formContainer input');\n  editContainer = document.getElementById('editContainer');\n  editInput = editContainer.getElementsByClassName('textarea')[0];\n  importContainer = document.getElementById('importContainer');\n  importInput = importContainer.getElementsByClassName('input')[0];\n  importButton = importContainer.getElementsByClassName('button')[0];\n  exportContainer = document.getElementById('exportContainer');\n  exportContent = exportContainer.getElementsByTagName('div')[0];\n\n\n  window.addEventListener('keyup', keyHandlerUp, false);\n  window.addEventListener('keydown', keyHandlerDown, false);\n  input.addEventListener('keydown', mainInputKeyEvent);\n  editInput.addEventListener('keydown', editInputKeyEvent);\n  editContainer.addEventListener('click', hideEditContainer);\n  editInput.addEventListener('click', stopPropagation);\n  /*\n   On double click edit the card\n   */\n  mainContainer.on('dblclick', 'div', doubleClickHandler);\n  /*\n   On click perform the card\n   */\n  mainContainer.on('click', 'div', cardClickEvents);\n  mainContainer.on('click', 'div > div', cardMenuEvents);\n  document.getElementById('export').addEventListener('click', exportCards);\n  document.getElementById('import').addEventListener('click', showImporter);\n  importButton.addEventListener('click', loadImportCardsCode);\n  importContainer.addEventListener('click', hideImportContainer);\n  importInput.addEventListener('keydown', importInputKeyEvent);\n  importInput.addEventListener('click', stopPropagation);\n  exportContainer.addEventListener('click', hideExportContainer);\n  exportContent.addEventListener('click', stopPropagation);\n}\n\nfunction keyHandlerDown (e) {\n\n  if (e.keyCode === CONFIG.ASCII.TAB_KEY) {\n    document.activeElement.blur();\n    if (event.shiftKey) {\n      cardManager.previousCard();\n    } else {\n      cardManager.nextCard();\n    }\n    if (e.preventDefault) {\n      e.preventDefault();\n    }\n  }\n}\n\nfunction keyHandlerUp (e) {\n\n  if (document.activeElement !== document.body || CONFIG.ASCII.KEYS_ARRAY.indexOf(e.keyCode) === -1) {\n    return;\n  }\n\n  e.stopPropagation();\n  e.preventDefault();\n\n  switch (e.keyCode) {\n    case CONFIG.ASCII.C_KEY:\n      let elem = cardManager.selectedCard.node,\n        selection;\n\n      selection = selectText(elem.getElementsByClassName('cardText')[0]);\n      copySelectionText();\n      selection.empty();\n      break;\n    case CONFIG.ASCII.D_KEY:\n      let card = cardManager.selectedCard;\n      cardManager.nextCard();\n      cardManager.removeCard(card.id);\n      cardManager.saveCards();\n      break;\n    case CONFIG.ASCII.E_KEY:\n      doubleClickHandler.apply(cardManager.selectedCard.node);\n      break;\n    case CONFIG.ASCII.PLUS_KEY:\n      changeDepth.apply(cardManager.selectedCard.node, [cardManager.selectedCard.id, 1]);\n      break;\n    case CONFIG.ASCII.MINUS_KEY:\n      changeDepth.apply(cardManager.selectedCard.node, [cardManager.selectedCard.id, -1]);\n      break;\n    case CONFIG.ASCII.A_KEY:\n      input.focus();\n      break;\n    case CONFIG.ASCII.DOT_KEY:\n      setDepth.apply(cardManager.selectedCard.node, [cardManager.selectedCard.id, 5]);\n      break;\n  }\n}\n\nfunction hideExportContainer () {\n  exportContainer.style.display = 'none';\n}\n\nfunction hideEditContainer () {\n  editContainer.style.display = 'none';\n}\n\nfunction hideImportContainer () {\n  importContainer.style.display = 'none';\n}\n\nfunction stopPropagation (e) {\n  e.stopPropagation();\n}\n\nfunction mainInputKeyEvent (event) {\n  let card;\n\n  if (event.keyCode === 13) {\n    card = cardManager.addCard(Object.create(Card, {}).init(input.value));\n    card.render();\n    this.value = '';\n    cardManager.saveCards();\n  }\n}\n\nfunction editInputKeyEvent (event) {\n  event.stopPropagation();\n  let card;\n  if (event.keyCode === 13 && event.shiftKey) return;\n  if (event.keyCode === 13) {\n    card = cardManager.cards[editContainer.cardId];\n    card.name = editInput.value;\n    card.derender();\n    card.render();\n    this.value = '';\n    cardManager.saveCards();\n    hideEditContainer();\n  } else if (event.keyCode === 27) {\n    hideEditContainer();\n  }\n\n}\n\nfunction importInputKeyEvent (event) {\n  if (event.keyCode === 27) {\n    hideImportContainer();\n  }\n}\n\nfunction doubleClickHandler () {\n  let elem = this.querySelector('.cardText'),\n    cardId,\n    card;\n\n  if (this.id === '') {\n    cardId = parseInt(this.parentElement.id.split('_')[1]);\n  } else {\n    cardId = parseInt(this.id.split('_')[1]);\n  }\n\n  card = cardManager.cards[cardId];\n\n  editInput.value = card.name;\n  editContainer.cardId = cardId;\n  editContainer.style.display = 'block';\n  editInput.style.top = card.y;\n  editInput.style.left = card.x;\n  editInput.style['padding-top'] = '23px';\n  editInput.focus();\n}\n\nfunction cardClickEvents (event) {\n  let elem = this.querySelector('.cardText'),\n    cardId,\n    card;\n\n  if (this.id === \"\") {\n    cardId = parseInt(this.parentElement.id.split('_')[1]);\n  } else {\n    cardId = parseInt(this.id.split('_')[1]);\n  }\n\n  card = cardManager.cards[cardId];\n\n  if (card === undefined) return;\n\n  cardManager.selectCard(card.id);\n\n  if (event.ctrlKey) {\n  }\n  if (event.altKey) {\n    this.querySelector('.copy').click();\n  }\n  if (event.shiftKey) {\n\n  }\n}\n\nfunction cardMenuEvents () {\n  let option = $(this).html(),\n    selection,\n    cardId = getParentCardId(this);\n\n  switch (option) {\n    case '+':\n      changeDepth.apply(this, [cardId, 1]);\n      break;\n    case '-':\n      changeDepth.apply(this, [cardId, -1]);\n      break;\n    case 'C':\n      selection = selectText(this.parentElement.getElementsByClassName('cardText')[0]);\n      copySelectionText();\n      selection.empty();\n      break;\n    case 'x':\n      cardManager.removeCard(cardId, -1);\n      break;\n  }\n  cardManager.saveCards();\n}\n\nfunction exportCards () {\n  exportContainer.style.display = 'block';\n  exportContent.innerHTML = cardManager.exportCards();\n  selection = selectText(exportContent);\n  copySelectionText();\n  selection.empty();\n}\n\nfunction loadImportCardsCode () {\n  let data = importInput.value;\n  cardManager.importCards(data);\n  importContainer.style.display = 'none';\n}\n\nfunction showImporter () {\n  importContainer.style.display = 'block';\n  importInput.focus();\n}\n\nmodule.exports = {\n  init: init\n};","\nvar subs = {};\n\n\nfunction pub(name, params) {\n  subs[name].forEach(function(elem) {\n    elem.callback.apply(elem.context, params);\n  });\n}\n\nfunction sub(name, callback, context) {\n  if (subs[name] === undefined) {\n    subs[name] = [];\n  }\n\n  subs[name].push({\n    callback: callback,\n    context: context\n  });\n}\n\n\nmodule.exports = {\n  pub: pub,\n  sub: sub\n};","window.CONFIG = require('./config.js');\n\nlet keyHandler = require('./lib/keyHandler'),\n  cardManager = require('./models/CardManager').getInstance();\n\nObject.assign(window, require('./prototypes'));\n\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  'strict mode';\n\n  keyHandler.init({\n    cardManager: cardManager\n  });\n\n  cardManager.loadCards();\n  cardManager.renderAllCards();\n});\n","let pubsub = require('../lib/pubsub'),\n  randomMC = require('random-material-color');\n\n\nlet Card = {\n  init: function (name) {\n    this.id = -1;\n    this.name = name;\n    this.depth = 5;\n    this.x = 100;\n    this.y = 100;\n    this.color = this.getBackgroundColor();\n    this.selected = false;\n\n    return this;\n  },\n  render: function () {\n    let node = document.createElement('div'),\n      text = document.createElement('div'),\n      that = this;\n\n    text.innerHTML = this.name.replace(/\\r?\\n/g,'<br/>');\n    text.className = 'cardText';\n\n    node.id = 'todo_' + this.id;\n    node.className = 'card card-1';\n    node.style.position = 'fixed';\n    node.style.left = this.x;\n    node.style.top = this.y;\n    node.style.cursor = '-webkit-grab';\n    node.style.zIndex = this.depth;\n    node.style.backgroundColor = this.color;\n\n    if (this.selected === true) {\n      node.classList.add('selected');\n    }\n\n    document.getElementById('mainContainer').appendChild(node);\n\n    node.appendChild(createDiv('x', 'control remove'));\n    node.appendChild(createDiv('+', 'control up'));\n    node.appendChild(createDiv('-', 'control down'));\n    node.appendChild(createDiv('C', 'control copy'));\n    node.appendChild(createDiv(this.depth, 'depth'));\n\n    node.appendChild(text);\n\n    $('#todo_' + this.id).draggable({\n      stop: function () {\n        let card = $('#todo_' + that.id);\n\n        that.x = card.css('left');\n        that.y = card.css('top');\n\n        pubsub.pub(window.CONFIG.SELECT_CARD, [that.id]);\n        pubsub.pub(window.CONFIG.SAVE_CARDS);\n      },\n    });\n\n    this.node = node;\n\n    return this;\n  },\n  getBackgroundColor: function () {\n    return randomMC.getColor({ shades: ['200', '300']});\n  },\n  derender: function () {\n    let node = document.getElementById('todo_' + this.id);\n    document.getElementById('mainContainer').removeChild(node);\n\n    return this;\n  },\n};\n\nmodule.exports = Card;","const Card = require('./Card'),\n  pubsub = require('../lib/pubsub'),\n  CONFIG = require('../config');\n\nlet CardManager = {\n  init: function () {\n    this.cards = [];\n    this.selectedCard = {id:-1};\n\n    return this;\n  },\n  addCard: function (card) {\n    this.cards.push(card);\n    card.id = this.cards.length - 1;\n\n    return card;\n  },\n  removeCard: function (id) {\n    this.cards[id].derender();\n    this.cards[id] = undefined;\n\n    return this;\n  },\n  redrawCard: function (cardId, x, y) {\n    let card = this.cards[cardId];\n    card.x = x;\n    card.y = y;\n\n    card.derender();\n    card.render();\n\n    return this;\n  },\n  saveCards: function () {\n    if (typeof(Storage) !== 'undefined') {\n      localStorage.setItem('cards', JSON.stringify(this.cards));\n    } else {\n      console.log('you don\\'t have local storage :(');\n    }\n\n    this.persistSelectedCard();\n\n    return this;\n  },\n  loadCards: function () {\n    this.cards = JSON.parse(localStorage.getItem('cards'));\n    if (this.cards === null) {\n      this.cards = JSON.parse(atob(CONFIG.DEFAULT_CONTENT));\n    }\n\n    this.clearArray();\n\n    this.loadSelectedCard();\n\n    document.activeElement.blur();\n\n    return this;\n  },\n  clearArray: function () {\n    let i;\n\n    this.cards = this.cards.filter(function (elem) {\n      return elem !== undefined && elem !== null;\n    });\n    for (i in this.cards) {\n      if (this.cards.hasOwnProperty(i)) {\n        this.cards[i].id = i;\n      }\n    }\n\n    return this;\n  },\n  renderAllCards: function () {\n\n    this.cards.forEach( (card) => {\n        card.selected = this.selectedCard && (this.selectedCard.id === card.id);\n        Object.setPrototypeOf(card, Card);\n        card.render();\n      }\n    );\n\n    return this;\n  },\n  getInstance: function () {\n    if (CardManager.instance === undefined) {\n      CardManager.instance = Object.create(CardManager, {});\n      CardManager.instance.init();\n      pubsub.sub(window.CONFIG.SAVE_CARDS, CardManager.instance.saveCards, CardManager.instance);\n      pubsub.sub(window.CONFIG.SELECT_CARD, CardManager.instance.selectCard, CardManager.instance);\n    }\n\n    return CardManager.instance;\n\n  },\n  exportCards: function () {\n    return btoa(JSON.stringify(this.cards));\n  },\n  importCards: function (data) {\n    localStorage.setItem('cards', atob(data));\n    this.loadCards();\n    this.renderAllCards();\n  },\n  selectCard: function (cardId) {\n    if (this.selectedCard !== undefined) {\n      this.selectedCard.node.classList.remove('selected');\n    }\n    this.selectedCard = this.cards[cardId];\n\n    this.selectedCard.node.classList.add('selected');\n\n    this.persistSelectedCard();\n    document.activeElement.blur();\n  },\n  nextCard: function () {\n    let it = +this.selectedCard.id + 1;\n\n    while (it !== +this.selectedCard.id) {\n      if (this.cards[it] !== undefined) {\n        break;\n      }\n      if (++it >= this.cards.length) {\n        it = 0;\n      }\n    }\n\n    this.selectCard (it);\n  },\n  previousCard: function() {\n    let it = +this.selectedCard.id - 1;\n\n    while (it !== +this.selectedCard.id) {\n      if (this.cards[it] !== undefined) {\n        break;\n      }\n      if (--it <= 0) {\n        it = this.cards.length;\n      }\n    }\n\n    this.selectCard (it);\n  },\n  persistSelectedCard: function() {\n    if (this.selectedCard && this.selectedCard.id > -1) {\n      localStorage.setItem('selectedCard', this.selectedCard.id);\n    }\n  },\n  loadSelectedCard: function() {\n    let selectedCardId = +localStorage.getItem('selectedCard');\n\n    if (selectedCardId !== undefined && selectedCardId > -1) {\n      this.selectedCard = this.cards[selectedCardId];\n    }\n  }\n};\n\nmodule.exports = CardManager;","let cardManager = require('./models/CardManager').getInstance();\n\nfunction createDiv(text, className) {\n  let div = document.createElement('div');\n  div.innerHTML = text;\n  div.style.float = \"right\";\n  div.style.cursor = \"pointer\";\n  div.style.width = \"16px\";\n  div.style.textAlign = \"center\";\n\n  if (className !== undefined) {\n    div.className = className;\n  }\n\n  return div;\n}\n\nfunction copySelectionText() {\n  let copysuccess; // let to check whether execCommand successfully executed\n  try {\n    copysuccess = document.execCommand(\"copy\"); // run command to copy selected text to clipboard\n  } catch (e) {\n    copysuccess = false\n  }\n  return copysuccess\n}\n\nfunction selectText(element) {\n  let doc = document\n    , text = element\n    , range, selection\n    ;\n  if (doc.body.createTextRange) {\n    range = document.body.createTextRange();\n    range.moveToElementText(text);\n    range.select();\n  } else if (window.getSelection) {\n    selection = window.getSelection();\n    range = document.createRange();\n    range.selectNodeContents(text);\n    selection.removeAllRanges();\n    selection.addRange(range);\n    return selection;\n  }\n}\n\nfunction getParentCardId(context) {\n  if (context.parentElement === null) return;\n  return parseInt(context.parentElement.id.split(\"_\")[1]);\n}\n\nfunction changeDepth(cardId, increment) {\n  let depth = cardManager.cards[cardId].depth + increment;\n\n  this.style.zIndex = depth;\n  cardManager.cards[cardId].depth = depth;\n  this.getElementsByClassName(\"depth\")[0].innerHTML = depth;\n}\n\nfunction setDepth(cardId, depth) {\n  this.style.zIndex = depth;\n  cardManager.cards[cardId].depth = depth;\n  this.getElementsByClassName(\"depth\")[0].innerHTML = depth;\n}\n\nfunction getCardHTMLById (mainContainer, id) {\n  return mainContainer.getElementById('todo_' + id);\n}\n\n// PROTOTYPES\n\n/*\n * Returns the size of an array\n */\nArray.prototype.size = function () {\n  return this.filter(function (a) {\n    return a !== undefined;\n  }).length\n};\n\n/*\n * Returns the size of an object\n */\nObject.size = function (obj) {\n  let size = 0, key = \"\";\n\n  for (key in obj) {\n    if (obj.hasOwnProperty(key)) size++;\n  }\n  return size;\n};\n\nmodule.exports = {\n  createDiv: createDiv,\n  copySelectionText: copySelectionText,\n  selectText: selectText,\n  getParentCardId: getParentCardId,\n  changeDepth: changeDepth,\n  setDepth: setDepth,\n  getCardHTMLById: getCardHTMLById\n};"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvcmFuZG9tLW1hdGVyaWFsLWNvbG9yL2Rpc3QvcmFuZG9tQ29sb3IuanMiLCJub2RlX21vZHVsZXMvcmFuZG9tLW1hdGVyaWFsLWNvbG9yL25vZGVfbW9kdWxlcy9tdXJtdXJoYXNoLWpzL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3JhbmRvbS1tYXRlcmlhbC1jb2xvci9ub2RlX21vZHVsZXMvbXVybXVyaGFzaC1qcy9tdXJtdXJoYXNoMl9nYy5qcyIsIm5vZGVfbW9kdWxlcy9yYW5kb20tbWF0ZXJpYWwtY29sb3Ivbm9kZV9tb2R1bGVzL211cm11cmhhc2gtanMvbXVybXVyaGFzaDNfZ2MuanMiLCJzcmMvanMvY29uZmlnLmpzIiwic3JjL2pzL2xpYi9rZXlIYW5kbGVyLmpzIiwic3JjL2pzL2xpYi9wdWJzdWIuanMiLCJzcmMvanMvbWFpbi5qcyIsInNyYy9qcy9tb2RlbHMvQ2FyZC5qcyIsInNyYy9qcy9tb2RlbHMvQ2FyZE1hbmFnZXIuanMiLCJzcmMvanMvcHJvdG90eXBlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3REQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBkZWZhdWx0UGFsZXR0ZT17NTA6W1wiI0ZGRUJFRVwiLFwiI0ZDRTRFQ1wiLFwiI0YzRTVGNVwiLFwiI0VERTdGNlwiLFwiI0U4RUFGNlwiLFwiI0UzRjJGRFwiLFwiI0UxRjVGRVwiLFwiI0UwRjdGQVwiLFwiI0UwRjJGMVwiLFwiI0U4RjVFOVwiLFwiI0YxRjhFOVwiLFwiI0Y5RkJFN1wiLFwiI0ZGRkRFN1wiLFwiI0ZGRjhFMVwiLFwiI0ZGRjNFMFwiLFwiI0ZCRTlFN1wiLFwiI0VGRUJFOVwiLFwiI0ZBRkFGQVwiLFwiI0VDRUZGMVwiXSwxMDA6W1wiI0ZGQ0REMlwiLFwiI0Y4QkJEMFwiLFwiI0UxQkVFN1wiLFwiI0QxQzRFOVwiLFwiI0M1Q0FFOVwiLFwiI0JCREVGQlwiLFwiI0IzRTVGQ1wiLFwiI0IyRUJGMlwiLFwiI0IyREZEQlwiLFwiI0M4RTZDOVwiLFwiI0RDRURDOFwiLFwiI0YwRjRDM1wiLFwiI0ZGRjlDNFwiLFwiI0ZGRUNCM1wiLFwiI0ZGRTBCMlwiLFwiI0ZGQ0NCQ1wiLFwiI0Q3Q0NDOFwiLFwiI0Y1RjVGNVwiLFwiI0NGRDhEQ1wiXSwyMDA6W1wiI0VGOUE5QVwiLFwiI0Y0OEZCMVwiLFwiI0NFOTNEOFwiLFwiI0IzOUREQlwiLFwiIzlGQThEQVwiLFwiIzkwQ0FGOVwiLFwiIzgxRDRGQVwiLFwiIzgwREVFQVwiLFwiIzgwQ0JDNFwiLFwiI0E1RDZBN1wiLFwiI0M1RTFBNVwiLFwiI0U2RUU5Q1wiLFwiI0ZGRjU5RFwiLFwiI0ZGRTA4MlwiLFwiI0ZGQ0M4MFwiLFwiI0ZGQUI5MVwiLFwiI0JDQUFBNFwiLFwiI0VFRUVFRVwiLFwiI0IwQkVDNVwiXSwzMDA6W1wiI0U1NzM3M1wiLFwiI0YwNjI5MlwiLFwiI0JBNjhDOFwiLFwiIzk1NzVDRFwiLFwiIzc5ODZDQlwiLFwiIzY0QjVGNlwiLFwiIzRGQzNGN1wiLFwiIzRERDBFMVwiLFwiIzREQjZBQ1wiLFwiIzgxQzc4NFwiLFwiI0FFRDU4MVwiLFwiI0RDRTc3NVwiLFwiI0ZGRjE3NlwiLFwiI0ZGRDU0RlwiLFwiI0ZGQjc0RFwiLFwiI0ZGOEE2NVwiLFwiI0ExODg3RlwiLFwiI0UwRTBFMFwiLFwiIzkwQTRBRVwiXSw0MDA6W1wiI0VGNTM1MFwiLFwiI0VDNDA3QVwiLFwiI0FCNDdCQ1wiLFwiIzdFNTdDMlwiLFwiIzVDNkJDMFwiLFwiIzQyQTVGNVwiLFwiIzI5QjZGNlwiLFwiIzI2QzZEQVwiLFwiIzI2QTY5QVwiLFwiIzY2QkI2QVwiLFwiIzlDQ0M2NVwiLFwiI0Q0RTE1N1wiLFwiI0ZGRUU1OFwiLFwiI0ZGQ0EyOFwiLFwiI0ZGQTcyNlwiLFwiI0ZGNzA0M1wiLFwiIzhENkU2M1wiLFwiI0JEQkRCRFwiLFwiIzc4OTA5Q1wiXSw1MDA6W1wiI0Y0NDMzNlwiLFwiI0U5MUU2M1wiLFwiIzlDMjdCMFwiLFwiIzY3M0FCN1wiLFwiIzNGNTFCNVwiLFwiIzIxOTZGM1wiLFwiIzAzQTlGNFwiLFwiIzAwQkNENFwiLFwiIzAwOTY4OFwiLFwiIzRDQUY1MFwiLFwiIzhCQzM0QVwiLFwiI0NEREMzOVwiLFwiI0ZGRUIzQlwiLFwiI0ZGQzEwN1wiLFwiI0ZGOTgwMFwiLFwiI0ZGNTcyMlwiLFwiIzc5NTU0OFwiLFwiIzlFOUU5RVwiLFwiIzYwN0Q4QlwiXSw2MDA6W1wiI0U1MzkzNVwiLFwiI0Q4MUI2MFwiLFwiIzhFMjRBQVwiLFwiIzVFMzVCMVwiLFwiIzM5NDlBQlwiLFwiIzFFODhFNVwiLFwiIzAzOUJFNVwiLFwiIzAwQUNDMVwiLFwiIzAwODk3QlwiLFwiIzQzQTA0N1wiLFwiIzdDQjM0MlwiLFwiI0MwQ0EzM1wiLFwiI0ZERDgzNVwiLFwiI0ZGQjMwMFwiLFwiI0ZCOEMwMFwiLFwiI0Y0NTExRVwiLFwiIzZENEM0MVwiLFwiIzc1NzU3NVwiLFwiIzU0NkU3QVwiXSw3MDA6W1wiI0QzMkYyRlwiLFwiI0MyMTg1QlwiLFwiIzdCMUZBMlwiLFwiIzUxMkRBOFwiLFwiIzMwM0Y5RlwiLFwiIzE5NzZEMlwiLFwiIzAyODhEMVwiLFwiIzAwOTdBN1wiLFwiIzAwNzk2QlwiLFwiIzM4OEUzQ1wiLFwiIzY4OUYzOFwiLFwiI0FGQjQyQlwiLFwiI0ZCQzAyRFwiLFwiI0ZGQTAwMFwiLFwiI0Y1N0MwMFwiLFwiI0U2NEExOVwiLFwiIzVENDAzN1wiLFwiIzYxNjE2MVwiLFwiIzQ1NUE2NFwiXSw4MDA6W1wiI0M2MjgyOFwiLFwiI0FEMTQ1N1wiLFwiIzZBMUI5QVwiLFwiIzQ1MjdBMFwiLFwiIzI4MzU5M1wiLFwiIzE1NjVDMFwiLFwiIzAyNzdCRFwiLFwiIzAwODM4RlwiLFwiIzAwNjk1Q1wiLFwiIzJFN0QzMlwiLFwiIzU1OEIyRlwiLFwiIzlFOUQyNFwiLFwiI0Y5QTgyNVwiLFwiI0ZGOEYwMFwiLFwiI0VGNkMwMFwiLFwiI0Q4NDMxNVwiLFwiIzRFMzQyRVwiLFwiIzQyNDI0MlwiLFwiIzM3NDc0RlwiXSw5MDA6W1wiI0I3MUMxQ1wiLFwiIzg4MEU0RlwiLFwiIzRBMTQ4Q1wiLFwiIzMxMUI5MlwiLFwiIzFBMjM3RVwiLFwiIzBENDdBMVwiLFwiIzAxNTc5QlwiLFwiIzAwNjA2NFwiLFwiIzAwNEQ0MFwiLFwiIzFCNUUyMFwiLFwiIzMzNjkxRVwiLFwiIzgyNzcxN1wiLFwiI0Y1N0YxN1wiLFwiI0ZGNkYwMFwiLFwiI0U2NTEwMFwiLFwiI0JGMzYwQ1wiLFwiIzNFMjcyM1wiLFwiIzIxMjEyMVwiLFwiIzI2MzIzOFwiXSxBMTAwOltcIiNGRjhBODBcIixcIiNGRjgwQUJcIixcIiNFQTgwRkNcIixcIiNCMzg4RkZcIixcIiM4QzlFRkZcIixcIiM4MkIxRkZcIixcIiM4MEQ4RkZcIixcIiM4NEZGRkZcIixcIiNBN0ZGRUJcIixcIiNCOUY2Q0FcIixcIiNDQ0ZGOTBcIixcIiNGNEZGODFcIixcIiNGRkZGOERcIixcIiNGRkU1N0ZcIixcIiNGRkQxODBcIixcIiNGRjlFODBcIl0sQTIwMDpbXCIjRkY1MjUyXCIsXCIjRkY0MDgxXCIsXCIjRTA0MEZCXCIsXCIjN0M0REZGXCIsXCIjNTM2REZFXCIsXCIjNDQ4QUZGXCIsXCIjNDBDNEZGXCIsXCIjMThGRkZGXCIsXCIjNjRGRkRBXCIsXCIjNjlGMEFFXCIsXCIjQjJGRjU5XCIsXCIjRUVGRjQxXCIsXCIjRkZGRjAwXCIsXCIjRkZENzQwXCIsXCIjRkZBQjQwXCIsXCIjRkY2RTQwXCJdLEE0MDA6W1wiI0ZGMTc0NFwiLFwiI0Y1MDA1N1wiLFwiI0Q1MDBGOVwiLFwiIzY1MUZGRlwiLFwiIzNENUFGRVwiLFwiIzI5NzlGRlwiLFwiIzAwQjBGRlwiLFwiIzAwRTVGRlwiLFwiIzFERTlCNlwiLFwiIzAwRTY3NlwiLFwiIzc2RkYwM1wiLFwiI0M2RkYwMFwiLFwiI0ZGRUEwMFwiLFwiI0ZGQzQwMFwiLFwiI0ZGOTEwMFwiLFwiI0ZGM0QwMFwiXSxBNzAwOltcIiNENTAwMDBcIixcIiNDNTExNjJcIixcIiNBQTAwRkZcIixcIiM2MjAwRUFcIixcIiMzMDRGRkVcIixcIiMyOTYyRkZcIixcIiMwMDkxRUFcIixcIiMwMEI4RDRcIixcIiMwMEJGQTVcIixcIiMwMEM4NTNcIixcIiM2NEREMTdcIixcIiNBRUVBMDBcIixcIiNGRkQ2MDBcIixcIiNGRkFCMDBcIixcIiNGRjZEMDBcIixcIiNERDJDMDBcIl19LG11cm11cj1yZXF1aXJlKFwibXVybXVyaGFzaC1qc1wiKTttb2R1bGUuZXhwb3J0cz1mdW5jdGlvbigpe3ZhciBGPVtdLEU9e3NoYWRlczpbXCI1MDBcIl0scGFsZXR0ZTpkZWZhdWx0UGFsZXR0ZSx0ZXh0Om51bGwsaWdub3JlQ29sb3JzOltdfSxDPWZ1bmN0aW9uKEMpe0N8fChDPUUpLEMucGFsZXR0ZXx8KEMucGFsZXR0ZT1kZWZhdWx0UGFsZXR0ZSksQy5zaGFkZXN8fChDLnNoYWRlcz1bXCI1MDBcIl0pO2Zvcih2YXIgQixEPUYubGVuZ3RoLHQ9MDtEPnQ7dCsrKWlmKEMudGV4dCYmRlt0XS50ZXh0PT09Qy50ZXh0KXJldHVybiBGW3RdLmNvbG9yO3JldHVybiBCPUEoQyksQy50ZXh0JiZGLnB1c2goe3RleHQ6Qy50ZXh0LGNvbG9yOkJ9KSxCfSxBPWZ1bmN0aW9uKEYpe3ZhciBFPUYuc2hhZGVzW0IoRi5zaGFkZXMubGVuZ3RoKV0sQz1cIlwiO2Zvcih2YXIgQSBpbiBGLnBhbGV0dGUpRi5wYWxldHRlLmhhc093blByb3BlcnR5KEEpJiZBPT09RSYmKEM9Ri50ZXh0P0YucGFsZXR0ZVtBXVtEKEYudGV4dCxGLnBhbGV0dGVbQV0ubGVuZ3RoKV06Ri5wYWxldHRlW0FdW0IoRi5wYWxldHRlW0FdLmxlbmd0aCldKTtyZXR1cm4gQ30sQj1mdW5jdGlvbihGKXtyZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKkYpfSxEPWZ1bmN0aW9uKEYsRSl7dmFyIEM9bXVybXVyLm11cm11cjMoRikvMWUxMDtyZXR1cm4uMT5DJiYoQz0xMCpDKSxNYXRoLmZsb29yKEMqRSl9O3JldHVybntnZXRDb2xvcjpDfX0oKTsiLCJ2YXIgbXVybXVyMyA9IHJlcXVpcmUoXCIuL211cm11cmhhc2gzX2djLmpzXCIpXG52YXIgbXVybXVyMiA9IHJlcXVpcmUoXCIuL211cm11cmhhc2gyX2djLmpzXCIpXG5cbm1vZHVsZS5leHBvcnRzID0gbXVybXVyM1xubW9kdWxlLmV4cG9ydHMubXVybXVyMyA9IG11cm11cjNcbm1vZHVsZS5leHBvcnRzLm11cm11cjIgPSBtdXJtdXIyXG4iLCIvKipcbiAqIEpTIEltcGxlbWVudGF0aW9uIG9mIE11cm11ckhhc2gyXG4gKiBcbiAqIEBhdXRob3IgPGEgaHJlZj1cIm1haWx0bzpnYXJ5LmNvdXJ0QGdtYWlsLmNvbVwiPkdhcnkgQ291cnQ8L2E+XG4gKiBAc2VlIGh0dHA6Ly9naXRodWIuY29tL2dhcnljb3VydC9tdXJtdXJoYXNoLWpzXG4gKiBAYXV0aG9yIDxhIGhyZWY9XCJtYWlsdG86YWFwcGxlYnlAZ21haWwuY29tXCI+QXVzdGluIEFwcGxlYnk8L2E+XG4gKiBAc2VlIGh0dHA6Ly9zaXRlcy5nb29nbGUuY29tL3NpdGUvbXVybXVyaGFzaC9cbiAqIFxuICogQHBhcmFtIHtzdHJpbmd9IHN0ciBBU0NJSSBvbmx5XG4gKiBAcGFyYW0ge251bWJlcn0gc2VlZCBQb3NpdGl2ZSBpbnRlZ2VyIG9ubHlcbiAqIEByZXR1cm4ge251bWJlcn0gMzItYml0IHBvc2l0aXZlIGludGVnZXIgaGFzaFxuICovXG5cbmZ1bmN0aW9uIG11cm11cmhhc2gyXzMyX2djKHN0ciwgc2VlZCkge1xuICB2YXJcbiAgICBsID0gc3RyLmxlbmd0aCxcbiAgICBoID0gc2VlZCBeIGwsXG4gICAgaSA9IDAsXG4gICAgaztcbiAgXG4gIHdoaWxlIChsID49IDQpIHtcbiAgXHRrID0gXG4gIFx0ICAoKHN0ci5jaGFyQ29kZUF0KGkpICYgMHhmZikpIHxcbiAgXHQgICgoc3RyLmNoYXJDb2RlQXQoKytpKSAmIDB4ZmYpIDw8IDgpIHxcbiAgXHQgICgoc3RyLmNoYXJDb2RlQXQoKytpKSAmIDB4ZmYpIDw8IDE2KSB8XG4gIFx0ICAoKHN0ci5jaGFyQ29kZUF0KCsraSkgJiAweGZmKSA8PCAyNCk7XG4gICAgXG4gICAgayA9ICgoKGsgJiAweGZmZmYpICogMHg1YmQxZTk5NSkgKyAoKCgoayA+Pj4gMTYpICogMHg1YmQxZTk5NSkgJiAweGZmZmYpIDw8IDE2KSk7XG4gICAgayBePSBrID4+PiAyNDtcbiAgICBrID0gKCgoayAmIDB4ZmZmZikgKiAweDViZDFlOTk1KSArICgoKChrID4+PiAxNikgKiAweDViZDFlOTk1KSAmIDB4ZmZmZikgPDwgMTYpKTtcblxuXHRoID0gKCgoaCAmIDB4ZmZmZikgKiAweDViZDFlOTk1KSArICgoKChoID4+PiAxNikgKiAweDViZDFlOTk1KSAmIDB4ZmZmZikgPDwgMTYpKSBeIGs7XG5cbiAgICBsIC09IDQ7XG4gICAgKytpO1xuICB9XG4gIFxuICBzd2l0Y2ggKGwpIHtcbiAgY2FzZSAzOiBoIF49IChzdHIuY2hhckNvZGVBdChpICsgMikgJiAweGZmKSA8PCAxNjtcbiAgY2FzZSAyOiBoIF49IChzdHIuY2hhckNvZGVBdChpICsgMSkgJiAweGZmKSA8PCA4O1xuICBjYXNlIDE6IGggXj0gKHN0ci5jaGFyQ29kZUF0KGkpICYgMHhmZik7XG4gICAgICAgICAgaCA9ICgoKGggJiAweGZmZmYpICogMHg1YmQxZTk5NSkgKyAoKCgoaCA+Pj4gMTYpICogMHg1YmQxZTk5NSkgJiAweGZmZmYpIDw8IDE2KSk7XG4gIH1cblxuICBoIF49IGggPj4+IDEzO1xuICBoID0gKCgoaCAmIDB4ZmZmZikgKiAweDViZDFlOTk1KSArICgoKChoID4+PiAxNikgKiAweDViZDFlOTk1KSAmIDB4ZmZmZikgPDwgMTYpKTtcbiAgaCBePSBoID4+PiAxNTtcblxuICByZXR1cm4gaCA+Pj4gMDtcbn1cblxuaWYodHlwZW9mIG1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG4gIG1vZHVsZS5leHBvcnRzID0gbXVybXVyaGFzaDJfMzJfZ2Ncbn1cbiIsIi8qKlxuICogSlMgSW1wbGVtZW50YXRpb24gb2YgTXVybXVySGFzaDMgKHIxMzYpIChhcyBvZiBNYXkgMjAsIDIwMTEpXG4gKiBcbiAqIEBhdXRob3IgPGEgaHJlZj1cIm1haWx0bzpnYXJ5LmNvdXJ0QGdtYWlsLmNvbVwiPkdhcnkgQ291cnQ8L2E+XG4gKiBAc2VlIGh0dHA6Ly9naXRodWIuY29tL2dhcnljb3VydC9tdXJtdXJoYXNoLWpzXG4gKiBAYXV0aG9yIDxhIGhyZWY9XCJtYWlsdG86YWFwcGxlYnlAZ21haWwuY29tXCI+QXVzdGluIEFwcGxlYnk8L2E+XG4gKiBAc2VlIGh0dHA6Ly9zaXRlcy5nb29nbGUuY29tL3NpdGUvbXVybXVyaGFzaC9cbiAqIFxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBBU0NJSSBvbmx5XG4gKiBAcGFyYW0ge251bWJlcn0gc2VlZCBQb3NpdGl2ZSBpbnRlZ2VyIG9ubHlcbiAqIEByZXR1cm4ge251bWJlcn0gMzItYml0IHBvc2l0aXZlIGludGVnZXIgaGFzaCBcbiAqL1xuXG5mdW5jdGlvbiBtdXJtdXJoYXNoM18zMl9nYyhrZXksIHNlZWQpIHtcblx0dmFyIHJlbWFpbmRlciwgYnl0ZXMsIGgxLCBoMWIsIGMxLCBjMWIsIGMyLCBjMmIsIGsxLCBpO1xuXHRcblx0cmVtYWluZGVyID0ga2V5Lmxlbmd0aCAmIDM7IC8vIGtleS5sZW5ndGggJSA0XG5cdGJ5dGVzID0ga2V5Lmxlbmd0aCAtIHJlbWFpbmRlcjtcblx0aDEgPSBzZWVkO1xuXHRjMSA9IDB4Y2M5ZTJkNTE7XG5cdGMyID0gMHgxYjg3MzU5Mztcblx0aSA9IDA7XG5cdFxuXHR3aGlsZSAoaSA8IGJ5dGVzKSB7XG5cdCAgXHRrMSA9IFxuXHQgIFx0ICAoKGtleS5jaGFyQ29kZUF0KGkpICYgMHhmZikpIHxcblx0ICBcdCAgKChrZXkuY2hhckNvZGVBdCgrK2kpICYgMHhmZikgPDwgOCkgfFxuXHQgIFx0ICAoKGtleS5jaGFyQ29kZUF0KCsraSkgJiAweGZmKSA8PCAxNikgfFxuXHQgIFx0ICAoKGtleS5jaGFyQ29kZUF0KCsraSkgJiAweGZmKSA8PCAyNCk7XG5cdFx0KytpO1xuXHRcdFxuXHRcdGsxID0gKCgoKGsxICYgMHhmZmZmKSAqIGMxKSArICgoKChrMSA+Pj4gMTYpICogYzEpICYgMHhmZmZmKSA8PCAxNikpKSAmIDB4ZmZmZmZmZmY7XG5cdFx0azEgPSAoazEgPDwgMTUpIHwgKGsxID4+PiAxNyk7XG5cdFx0azEgPSAoKCgoazEgJiAweGZmZmYpICogYzIpICsgKCgoKGsxID4+PiAxNikgKiBjMikgJiAweGZmZmYpIDw8IDE2KSkpICYgMHhmZmZmZmZmZjtcblxuXHRcdGgxIF49IGsxO1xuICAgICAgICBoMSA9IChoMSA8PCAxMykgfCAoaDEgPj4+IDE5KTtcblx0XHRoMWIgPSAoKCgoaDEgJiAweGZmZmYpICogNSkgKyAoKCgoaDEgPj4+IDE2KSAqIDUpICYgMHhmZmZmKSA8PCAxNikpKSAmIDB4ZmZmZmZmZmY7XG5cdFx0aDEgPSAoKChoMWIgJiAweGZmZmYpICsgMHg2YjY0KSArICgoKChoMWIgPj4+IDE2KSArIDB4ZTY1NCkgJiAweGZmZmYpIDw8IDE2KSk7XG5cdH1cblx0XG5cdGsxID0gMDtcblx0XG5cdHN3aXRjaCAocmVtYWluZGVyKSB7XG5cdFx0Y2FzZSAzOiBrMSBePSAoa2V5LmNoYXJDb2RlQXQoaSArIDIpICYgMHhmZikgPDwgMTY7XG5cdFx0Y2FzZSAyOiBrMSBePSAoa2V5LmNoYXJDb2RlQXQoaSArIDEpICYgMHhmZikgPDwgODtcblx0XHRjYXNlIDE6IGsxIF49IChrZXkuY2hhckNvZGVBdChpKSAmIDB4ZmYpO1xuXHRcdFxuXHRcdGsxID0gKCgoazEgJiAweGZmZmYpICogYzEpICsgKCgoKGsxID4+PiAxNikgKiBjMSkgJiAweGZmZmYpIDw8IDE2KSkgJiAweGZmZmZmZmZmO1xuXHRcdGsxID0gKGsxIDw8IDE1KSB8IChrMSA+Pj4gMTcpO1xuXHRcdGsxID0gKCgoazEgJiAweGZmZmYpICogYzIpICsgKCgoKGsxID4+PiAxNikgKiBjMikgJiAweGZmZmYpIDw8IDE2KSkgJiAweGZmZmZmZmZmO1xuXHRcdGgxIF49IGsxO1xuXHR9XG5cdFxuXHRoMSBePSBrZXkubGVuZ3RoO1xuXG5cdGgxIF49IGgxID4+PiAxNjtcblx0aDEgPSAoKChoMSAmIDB4ZmZmZikgKiAweDg1ZWJjYTZiKSArICgoKChoMSA+Pj4gMTYpICogMHg4NWViY2E2YikgJiAweGZmZmYpIDw8IDE2KSkgJiAweGZmZmZmZmZmO1xuXHRoMSBePSBoMSA+Pj4gMTM7XG5cdGgxID0gKCgoKGgxICYgMHhmZmZmKSAqIDB4YzJiMmFlMzUpICsgKCgoKGgxID4+PiAxNikgKiAweGMyYjJhZTM1KSAmIDB4ZmZmZikgPDwgMTYpKSkgJiAweGZmZmZmZmZmO1xuXHRoMSBePSBoMSA+Pj4gMTY7XG5cblx0cmV0dXJuIGgxID4+PiAwO1xufVxuXG5pZih0eXBlb2YgbW9kdWxlICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gIG1vZHVsZS5leHBvcnRzID0gbXVybXVyaGFzaDNfMzJfZ2Ncbn0iLCJtb2R1bGUuZXhwb3J0cyA9IHtcbiAgU0FWRV9DQVJEUzogJ1NBVkVfQ0FSRFMnLFxuICBTRUxFQ1RfQ0FSRDogJ1NFTEVDVF9DQVJEJyxcbiAgQVNDSUk6IHtcbiAgICBFU0NBUEVfS0VZIDogMjcsXG4gICAgVEFCX0tFWSA6IDksXG4gICAgQ19LRVkgOiA2NyxcbiAgICBEX0tFWSA6IDY4LFxuICAgIEVfS0VZIDogNjksXG4gICAgUExVU19LRVkgOiAxODcsXG4gICAgTUlOVVNfS0VZIDogMTg5LFxuICAgIERPVF9LRVkgOiAxOTAsXG4gICAgQV9LRVkgOiA2NSxcbiAgICBLRVlTX0FSUkFZIDpbMjcsIDksIDY3LCA2OCwgNjksIDE4NywgMTg5LCAxOTAsIDY1XVxuICB9LFxuICBERUZBVUxUX0NPTlRFTlQ6ICdXM3NpYVdRaU9qQXNJbTVoYldVaU9pSlZjMlVnZEdGaUlHRnVaQ0J6YUdsbWRDQjBZV0lnZEc4Z1kybHlZMnhsSUdKbGRIZGxaVzRnWTJGeVpITWdPa1JjYmx4dVJISmhaMmRwYm1jZ2IzSWdZMnhwWTJ0cGJtY2dkR2hsYlNCM2FXeHNJR0ZzYzI4Z2JXRnlheUIwYUdWdElHRnpJSE5sYkdWamRHVmtJaXdpWkdWd2RHZ2lPalVzSW5naU9pSXhNak53ZUNJc0lua2lPaUkxT1hCNElpd2lZMjlzYjNJaU9pSWpORVJFTUVVeElpd2ljMlZzWldOMFpXUWlPbVpoYkhObExDSnViMlJsSWpwN0ltcFJkV1Z5ZVRFM01qQTRNRGMwTkRNNE9EUTVNRGsyTVRVeklqbzVmWDBzZXlKcFpDSTZNU3dpYm1GdFpTSTZJazl1SUdFZ2JXRnlhMlZrSUdOaGNtUWdkWE5sT2x4dUoyTW5JSFJ2SUdOdmNIa2dkR2hsSUdOdmJuUmxiblJjYmlka0p5QjBieUJrWld4bGRHVWdhWFJjYmlkbEp5QjBieUJsWkdsMElHbDBYRzRuS3ljZ1lXNWtJQ2N0SnlCMGJ5QnRiMlJwWm5rZ2RHaGxJR1JsY0hSb0lHOW1JSFJvWlNCallYSmtJR0Z1WkNBbkxpY2dkRzhnY21WelpYUWdhWFFpTENKa1pYQjBhQ0k2Tml3aWVDSTZJak0wTW5CNElpd2llU0k2SWpVMGNIZ2lMQ0pqYjJ4dmNpSTZJaU00TUVOQ1F6UWlMQ0p6Wld4bFkzUmxaQ0k2Wm1Gc2MyVXNJbTV2WkdVaU9uc2lhbEYxWlhKNU1UY3lNRGd3TnpRME16ZzRORGt3T1RZeE5UTWlPakV6Zlgwc2V5SnBaQ0k2TWl3aWJtRnRaU0k2SWxkb2FXeGxJR1ZrYVhScGJtY2dkWE5sSUhOb2FXWjBJQ3NnWlc1MFpYSWdkRzhnWEc1cGJuTmxjblJjYm1GY2JteHBibVZjYm1KeVpXRnJYRzQ2UkNJc0ltUmxjSFJvSWpvMUxDSjRJam9pTVRJeGNIZ2lMQ0o1SWpvaU1qY3pjSGdpTENKamIyeHZjaUk2SWlNMk5FSTFSallpTENKelpXeGxZM1JsWkNJNlptRnNjMlVzSW01dlpHVWlPbnNpYWxGMVpYSjVNVGN5TURnd056UTBNemc0TkRrd09UWXhOVE1pT2pFMWZYMWQnLFxuICBWRVJTSU9OOiAnMC4zLjMnXG59OyIsImNvbnN0IENPTkZJRyA9IHJlcXVpcmUoJy4uL2NvbmZpZycpO1xuXG5sZXQgY2FyZE1hbmFnZXIsXG4gICAgQ2FyZCA9IHJlcXVpcmUoJy4uL21vZGVscy9DYXJkJyk7XG5cbmxldCBtYWluQ29udGFpbmVyLFxuICBpbnB1dCxcbiAgZWRpdENvbnRhaW5lcixcbiAgZWRpdElucHV0LFxuICBpbXBvcnRDb250YWluZXIsXG4gIGltcG9ydElucHV0LFxuICBleHBvcnRDb250YWluZXIsXG4gIGV4cG9ydENvbnRlbnQsXG4gIGltcG9ydEJ1dHRvbjtcblxuXG5mdW5jdGlvbiBpbml0KG9wdGlvbnMpIHtcbiAgY2FyZE1hbmFnZXIgPSBvcHRpb25zLmNhcmRNYW5hZ2VyO1xuICBiaW5kaW5ncygpO1xufVxuXG5mdW5jdGlvbiBiaW5kaW5ncygpIHtcbiAgbWFpbkNvbnRhaW5lciA9ICQoJyNtYWluQ29udGFpbmVyJyk7XG4gIGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2Zvcm1Db250YWluZXIgaW5wdXQnKTtcbiAgZWRpdENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0Q29udGFpbmVyJyk7XG4gIGVkaXRJbnB1dCA9IGVkaXRDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGV4dGFyZWEnKVswXTtcbiAgaW1wb3J0Q29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ltcG9ydENvbnRhaW5lcicpO1xuICBpbXBvcnRJbnB1dCA9IGltcG9ydENvbnRhaW5lci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdpbnB1dCcpWzBdO1xuICBpbXBvcnRCdXR0b24gPSBpbXBvcnRDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnV0dG9uJylbMF07XG4gIGV4cG9ydENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHBvcnRDb250YWluZXInKTtcbiAgZXhwb3J0Q29udGVudCA9IGV4cG9ydENvbnRhaW5lci5nZXRFbGVtZW50c0J5VGFnTmFtZSgnZGl2JylbMF07XG5cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBrZXlIYW5kbGVyVXAsIGZhbHNlKTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBrZXlIYW5kbGVyRG93biwgZmFsc2UpO1xuICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgbWFpbklucHV0S2V5RXZlbnQpO1xuICBlZGl0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGVkaXRJbnB1dEtleUV2ZW50KTtcbiAgZWRpdENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhpZGVFZGl0Q29udGFpbmVyKTtcbiAgZWRpdElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3RvcFByb3BhZ2F0aW9uKTtcbiAgLypcbiAgIE9uIGRvdWJsZSBjbGljayBlZGl0IHRoZSBjYXJkXG4gICAqL1xuICBtYWluQ29udGFpbmVyLm9uKCdkYmxjbGljaycsICdkaXYnLCBkb3VibGVDbGlja0hhbmRsZXIpO1xuICAvKlxuICAgT24gY2xpY2sgcGVyZm9ybSB0aGUgY2FyZFxuICAgKi9cbiAgbWFpbkNvbnRhaW5lci5vbignY2xpY2snLCAnZGl2JywgY2FyZENsaWNrRXZlbnRzKTtcbiAgbWFpbkNvbnRhaW5lci5vbignY2xpY2snLCAnZGl2ID4gZGl2JywgY2FyZE1lbnVFdmVudHMpO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBleHBvcnRDYXJkcyk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbXBvcnQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNob3dJbXBvcnRlcik7XG4gIGltcG9ydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGxvYWRJbXBvcnRDYXJkc0NvZGUpO1xuICBpbXBvcnRDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoaWRlSW1wb3J0Q29udGFpbmVyKTtcbiAgaW1wb3J0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGltcG9ydElucHV0S2V5RXZlbnQpO1xuICBpbXBvcnRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN0b3BQcm9wYWdhdGlvbik7XG4gIGV4cG9ydENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhpZGVFeHBvcnRDb250YWluZXIpO1xuICBleHBvcnRDb250ZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3RvcFByb3BhZ2F0aW9uKTtcbn1cblxuZnVuY3Rpb24ga2V5SGFuZGxlckRvd24gKGUpIHtcblxuICBpZiAoZS5rZXlDb2RlID09PSBDT05GSUcuQVNDSUkuVEFCX0tFWSkge1xuICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpO1xuICAgIGlmIChldmVudC5zaGlmdEtleSkge1xuICAgICAgY2FyZE1hbmFnZXIucHJldmlvdXNDYXJkKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNhcmRNYW5hZ2VyLm5leHRDYXJkKCk7XG4gICAgfVxuICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGtleUhhbmRsZXJVcCAoZSkge1xuXG4gIGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50ICE9PSBkb2N1bWVudC5ib2R5IHx8IENPTkZJRy5BU0NJSS5LRVlTX0FSUkFZLmluZGV4T2YoZS5rZXlDb2RlKSA9PT0gLTEpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgc3dpdGNoIChlLmtleUNvZGUpIHtcbiAgICBjYXNlIENPTkZJRy5BU0NJSS5DX0tFWTpcbiAgICAgIGxldCBlbGVtID0gY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLm5vZGUsXG4gICAgICAgIHNlbGVjdGlvbjtcblxuICAgICAgc2VsZWN0aW9uID0gc2VsZWN0VGV4dChlbGVtLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhcmRUZXh0JylbMF0pO1xuICAgICAgY29weVNlbGVjdGlvblRleHQoKTtcbiAgICAgIHNlbGVjdGlvbi5lbXB0eSgpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBDT05GSUcuQVNDSUkuRF9LRVk6XG4gICAgICBsZXQgY2FyZCA9IGNhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZDtcbiAgICAgIGNhcmRNYW5hZ2VyLm5leHRDYXJkKCk7XG4gICAgICBjYXJkTWFuYWdlci5yZW1vdmVDYXJkKGNhcmQuaWQpO1xuICAgICAgY2FyZE1hbmFnZXIuc2F2ZUNhcmRzKCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIENPTkZJRy5BU0NJSS5FX0tFWTpcbiAgICAgIGRvdWJsZUNsaWNrSGFuZGxlci5hcHBseShjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQubm9kZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIENPTkZJRy5BU0NJSS5QTFVTX0tFWTpcbiAgICAgIGNoYW5nZURlcHRoLmFwcGx5KGNhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5ub2RlLCBbY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLmlkLCAxXSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIENPTkZJRy5BU0NJSS5NSU5VU19LRVk6XG4gICAgICBjaGFuZ2VEZXB0aC5hcHBseShjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQubm9kZSwgW2NhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5pZCwgLTFdKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgQ09ORklHLkFTQ0lJLkFfS0VZOlxuICAgICAgaW5wdXQuZm9jdXMoKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgQ09ORklHLkFTQ0lJLkRPVF9LRVk6XG4gICAgICBzZXREZXB0aC5hcHBseShjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQubm9kZSwgW2NhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5pZCwgNV0pO1xuICAgICAgYnJlYWs7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGlkZUV4cG9ydENvbnRhaW5lciAoKSB7XG4gIGV4cG9ydENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xufVxuXG5mdW5jdGlvbiBoaWRlRWRpdENvbnRhaW5lciAoKSB7XG4gIGVkaXRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbn1cblxuZnVuY3Rpb24gaGlkZUltcG9ydENvbnRhaW5lciAoKSB7XG4gIGltcG9ydENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xufVxuXG5mdW5jdGlvbiBzdG9wUHJvcGFnYXRpb24gKGUpIHtcbiAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbn1cblxuZnVuY3Rpb24gbWFpbklucHV0S2V5RXZlbnQgKGV2ZW50KSB7XG4gIGxldCBjYXJkO1xuXG4gIGlmIChldmVudC5rZXlDb2RlID09PSAxMykge1xuICAgIGNhcmQgPSBjYXJkTWFuYWdlci5hZGRDYXJkKE9iamVjdC5jcmVhdGUoQ2FyZCwge30pLmluaXQoaW5wdXQudmFsdWUpKTtcbiAgICBjYXJkLnJlbmRlcigpO1xuICAgIHRoaXMudmFsdWUgPSAnJztcbiAgICBjYXJkTWFuYWdlci5zYXZlQ2FyZHMoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBlZGl0SW5wdXRLZXlFdmVudCAoZXZlbnQpIHtcbiAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIGxldCBjYXJkO1xuICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMgJiYgZXZlbnQuc2hpZnRLZXkpIHJldHVybjtcbiAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzKSB7XG4gICAgY2FyZCA9IGNhcmRNYW5hZ2VyLmNhcmRzW2VkaXRDb250YWluZXIuY2FyZElkXTtcbiAgICBjYXJkLm5hbWUgPSBlZGl0SW5wdXQudmFsdWU7XG4gICAgY2FyZC5kZXJlbmRlcigpO1xuICAgIGNhcmQucmVuZGVyKCk7XG4gICAgdGhpcy52YWx1ZSA9ICcnO1xuICAgIGNhcmRNYW5hZ2VyLnNhdmVDYXJkcygpO1xuICAgIGhpZGVFZGl0Q29udGFpbmVyKCk7XG4gIH0gZWxzZSBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMjcpIHtcbiAgICBoaWRlRWRpdENvbnRhaW5lcigpO1xuICB9XG5cbn1cblxuZnVuY3Rpb24gaW1wb3J0SW5wdXRLZXlFdmVudCAoZXZlbnQpIHtcbiAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDI3KSB7XG4gICAgaGlkZUltcG9ydENvbnRhaW5lcigpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGRvdWJsZUNsaWNrSGFuZGxlciAoKSB7XG4gIGxldCBlbGVtID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcuY2FyZFRleHQnKSxcbiAgICBjYXJkSWQsXG4gICAgY2FyZDtcblxuICBpZiAodGhpcy5pZCA9PT0gJycpIHtcbiAgICBjYXJkSWQgPSBwYXJzZUludCh0aGlzLnBhcmVudEVsZW1lbnQuaWQuc3BsaXQoJ18nKVsxXSk7XG4gIH0gZWxzZSB7XG4gICAgY2FyZElkID0gcGFyc2VJbnQodGhpcy5pZC5zcGxpdCgnXycpWzFdKTtcbiAgfVxuXG4gIGNhcmQgPSBjYXJkTWFuYWdlci5jYXJkc1tjYXJkSWRdO1xuXG4gIGVkaXRJbnB1dC52YWx1ZSA9IGNhcmQubmFtZTtcbiAgZWRpdENvbnRhaW5lci5jYXJkSWQgPSBjYXJkSWQ7XG4gIGVkaXRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gIGVkaXRJbnB1dC5zdHlsZS50b3AgPSBjYXJkLnk7XG4gIGVkaXRJbnB1dC5zdHlsZS5sZWZ0ID0gY2FyZC54O1xuICBlZGl0SW5wdXQuc3R5bGVbJ3BhZGRpbmctdG9wJ10gPSAnMjNweCc7XG4gIGVkaXRJbnB1dC5mb2N1cygpO1xufVxuXG5mdW5jdGlvbiBjYXJkQ2xpY2tFdmVudHMgKGV2ZW50KSB7XG4gIGxldCBlbGVtID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcuY2FyZFRleHQnKSxcbiAgICBjYXJkSWQsXG4gICAgY2FyZDtcblxuICBpZiAodGhpcy5pZCA9PT0gXCJcIikge1xuICAgIGNhcmRJZCA9IHBhcnNlSW50KHRoaXMucGFyZW50RWxlbWVudC5pZC5zcGxpdCgnXycpWzFdKTtcbiAgfSBlbHNlIHtcbiAgICBjYXJkSWQgPSBwYXJzZUludCh0aGlzLmlkLnNwbGl0KCdfJylbMV0pO1xuICB9XG5cbiAgY2FyZCA9IGNhcmRNYW5hZ2VyLmNhcmRzW2NhcmRJZF07XG5cbiAgaWYgKGNhcmQgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xuXG4gIGNhcmRNYW5hZ2VyLnNlbGVjdENhcmQoY2FyZC5pZCk7XG5cbiAgaWYgKGV2ZW50LmN0cmxLZXkpIHtcbiAgfVxuICBpZiAoZXZlbnQuYWx0S2V5KSB7XG4gICAgdGhpcy5xdWVyeVNlbGVjdG9yKCcuY29weScpLmNsaWNrKCk7XG4gIH1cbiAgaWYgKGV2ZW50LnNoaWZ0S2V5KSB7XG5cbiAgfVxufVxuXG5mdW5jdGlvbiBjYXJkTWVudUV2ZW50cyAoKSB7XG4gIGxldCBvcHRpb24gPSAkKHRoaXMpLmh0bWwoKSxcbiAgICBzZWxlY3Rpb24sXG4gICAgY2FyZElkID0gZ2V0UGFyZW50Q2FyZElkKHRoaXMpO1xuXG4gIHN3aXRjaCAob3B0aW9uKSB7XG4gICAgY2FzZSAnKyc6XG4gICAgICBjaGFuZ2VEZXB0aC5hcHBseSh0aGlzLCBbY2FyZElkLCAxXSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICctJzpcbiAgICAgIGNoYW5nZURlcHRoLmFwcGx5KHRoaXMsIFtjYXJkSWQsIC0xXSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdDJzpcbiAgICAgIHNlbGVjdGlvbiA9IHNlbGVjdFRleHQodGhpcy5wYXJlbnRFbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhcmRUZXh0JylbMF0pO1xuICAgICAgY29weVNlbGVjdGlvblRleHQoKTtcbiAgICAgIHNlbGVjdGlvbi5lbXB0eSgpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAneCc6XG4gICAgICBjYXJkTWFuYWdlci5yZW1vdmVDYXJkKGNhcmRJZCwgLTEpO1xuICAgICAgYnJlYWs7XG4gIH1cbiAgY2FyZE1hbmFnZXIuc2F2ZUNhcmRzKCk7XG59XG5cbmZ1bmN0aW9uIGV4cG9ydENhcmRzICgpIHtcbiAgZXhwb3J0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICBleHBvcnRDb250ZW50LmlubmVySFRNTCA9IGNhcmRNYW5hZ2VyLmV4cG9ydENhcmRzKCk7XG4gIHNlbGVjdGlvbiA9IHNlbGVjdFRleHQoZXhwb3J0Q29udGVudCk7XG4gIGNvcHlTZWxlY3Rpb25UZXh0KCk7XG4gIHNlbGVjdGlvbi5lbXB0eSgpO1xufVxuXG5mdW5jdGlvbiBsb2FkSW1wb3J0Q2FyZHNDb2RlICgpIHtcbiAgbGV0IGRhdGEgPSBpbXBvcnRJbnB1dC52YWx1ZTtcbiAgY2FyZE1hbmFnZXIuaW1wb3J0Q2FyZHMoZGF0YSk7XG4gIGltcG9ydENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xufVxuXG5mdW5jdGlvbiBzaG93SW1wb3J0ZXIgKCkge1xuICBpbXBvcnRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gIGltcG9ydElucHV0LmZvY3VzKCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpbml0OiBpbml0XG59OyIsIlxudmFyIHN1YnMgPSB7fTtcblxuXG5mdW5jdGlvbiBwdWIobmFtZSwgcGFyYW1zKSB7XG4gIHN1YnNbbmFtZV0uZm9yRWFjaChmdW5jdGlvbihlbGVtKSB7XG4gICAgZWxlbS5jYWxsYmFjay5hcHBseShlbGVtLmNvbnRleHQsIHBhcmFtcyk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBzdWIobmFtZSwgY2FsbGJhY2ssIGNvbnRleHQpIHtcbiAgaWYgKHN1YnNbbmFtZV0gPT09IHVuZGVmaW5lZCkge1xuICAgIHN1YnNbbmFtZV0gPSBbXTtcbiAgfVxuXG4gIHN1YnNbbmFtZV0ucHVzaCh7XG4gICAgY2FsbGJhY2s6IGNhbGxiYWNrLFxuICAgIGNvbnRleHQ6IGNvbnRleHRcbiAgfSk7XG59XG5cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHB1YjogcHViLFxuICBzdWI6IHN1YlxufTsiLCJ3aW5kb3cuQ09ORklHID0gcmVxdWlyZSgnLi9jb25maWcuanMnKTtcblxubGV0IGtleUhhbmRsZXIgPSByZXF1aXJlKCcuL2xpYi9rZXlIYW5kbGVyJyksXG4gIGNhcmRNYW5hZ2VyID0gcmVxdWlyZSgnLi9tb2RlbHMvQ2FyZE1hbmFnZXInKS5nZXRJbnN0YW5jZSgpO1xuXG5PYmplY3QuYXNzaWduKHdpbmRvdywgcmVxdWlyZSgnLi9wcm90b3R5cGVzJykpO1xuXG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gICdzdHJpY3QgbW9kZSc7XG5cbiAga2V5SGFuZGxlci5pbml0KHtcbiAgICBjYXJkTWFuYWdlcjogY2FyZE1hbmFnZXJcbiAgfSk7XG5cbiAgY2FyZE1hbmFnZXIubG9hZENhcmRzKCk7XG4gIGNhcmRNYW5hZ2VyLnJlbmRlckFsbENhcmRzKCk7XG59KTtcbiIsImxldCBwdWJzdWIgPSByZXF1aXJlKCcuLi9saWIvcHVic3ViJyksXG4gIHJhbmRvbU1DID0gcmVxdWlyZSgncmFuZG9tLW1hdGVyaWFsLWNvbG9yJyk7XG5cblxubGV0IENhcmQgPSB7XG4gIGluaXQ6IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhpcy5pZCA9IC0xO1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy5kZXB0aCA9IDU7XG4gICAgdGhpcy54ID0gMTAwO1xuICAgIHRoaXMueSA9IDEwMDtcbiAgICB0aGlzLmNvbG9yID0gdGhpcy5nZXRCYWNrZ3JvdW5kQ29sb3IoKTtcbiAgICB0aGlzLnNlbGVjdGVkID0gZmFsc2U7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcbiAgICAgIHRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcbiAgICAgIHRoYXQgPSB0aGlzO1xuXG4gICAgdGV4dC5pbm5lckhUTUwgPSB0aGlzLm5hbWUucmVwbGFjZSgvXFxyP1xcbi9nLCc8YnIvPicpO1xuICAgIHRleHQuY2xhc3NOYW1lID0gJ2NhcmRUZXh0JztcblxuICAgIG5vZGUuaWQgPSAndG9kb18nICsgdGhpcy5pZDtcbiAgICBub2RlLmNsYXNzTmFtZSA9ICdjYXJkIGNhcmQtMSc7XG4gICAgbm9kZS5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7XG4gICAgbm9kZS5zdHlsZS5sZWZ0ID0gdGhpcy54O1xuICAgIG5vZGUuc3R5bGUudG9wID0gdGhpcy55O1xuICAgIG5vZGUuc3R5bGUuY3Vyc29yID0gJy13ZWJraXQtZ3JhYic7XG4gICAgbm9kZS5zdHlsZS56SW5kZXggPSB0aGlzLmRlcHRoO1xuICAgIG5vZGUuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5jb2xvcjtcblxuICAgIGlmICh0aGlzLnNlbGVjdGVkID09PSB0cnVlKSB7XG4gICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgfVxuXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250YWluZXInKS5hcHBlbmRDaGlsZChub2RlKTtcblxuICAgIG5vZGUuYXBwZW5kQ2hpbGQoY3JlYXRlRGl2KCd4JywgJ2NvbnRyb2wgcmVtb3ZlJykpO1xuICAgIG5vZGUuYXBwZW5kQ2hpbGQoY3JlYXRlRGl2KCcrJywgJ2NvbnRyb2wgdXAnKSk7XG4gICAgbm9kZS5hcHBlbmRDaGlsZChjcmVhdGVEaXYoJy0nLCAnY29udHJvbCBkb3duJykpO1xuICAgIG5vZGUuYXBwZW5kQ2hpbGQoY3JlYXRlRGl2KCdDJywgJ2NvbnRyb2wgY29weScpKTtcbiAgICBub2RlLmFwcGVuZENoaWxkKGNyZWF0ZURpdih0aGlzLmRlcHRoLCAnZGVwdGgnKSk7XG5cbiAgICBub2RlLmFwcGVuZENoaWxkKHRleHQpO1xuXG4gICAgJCgnI3RvZG9fJyArIHRoaXMuaWQpLmRyYWdnYWJsZSh7XG4gICAgICBzdG9wOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxldCBjYXJkID0gJCgnI3RvZG9fJyArIHRoYXQuaWQpO1xuXG4gICAgICAgIHRoYXQueCA9IGNhcmQuY3NzKCdsZWZ0Jyk7XG4gICAgICAgIHRoYXQueSA9IGNhcmQuY3NzKCd0b3AnKTtcblxuICAgICAgICBwdWJzdWIucHViKHdpbmRvdy5DT05GSUcuU0VMRUNUX0NBUkQsIFt0aGF0LmlkXSk7XG4gICAgICAgIHB1YnN1Yi5wdWIod2luZG93LkNPTkZJRy5TQVZFX0NBUkRTKTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICB0aGlzLm5vZGUgPSBub2RlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGdldEJhY2tncm91bmRDb2xvcjogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiByYW5kb21NQy5nZXRDb2xvcih7IHNoYWRlczogWycyMDAnLCAnMzAwJ119KTtcbiAgfSxcbiAgZGVyZW5kZXI6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgbm9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2RvXycgKyB0aGlzLmlkKTtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbkNvbnRhaW5lcicpLnJlbW92ZUNoaWxkKG5vZGUpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IENhcmQ7IiwiY29uc3QgQ2FyZCA9IHJlcXVpcmUoJy4vQ2FyZCcpLFxuICBwdWJzdWIgPSByZXF1aXJlKCcuLi9saWIvcHVic3ViJyksXG4gIENPTkZJRyA9IHJlcXVpcmUoJy4uL2NvbmZpZycpO1xuXG5sZXQgQ2FyZE1hbmFnZXIgPSB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmNhcmRzID0gW107XG4gICAgdGhpcy5zZWxlY3RlZENhcmQgPSB7aWQ6LTF9O1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGFkZENhcmQ6IGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgdGhpcy5jYXJkcy5wdXNoKGNhcmQpO1xuICAgIGNhcmQuaWQgPSB0aGlzLmNhcmRzLmxlbmd0aCAtIDE7XG5cbiAgICByZXR1cm4gY2FyZDtcbiAgfSxcbiAgcmVtb3ZlQ2FyZDogZnVuY3Rpb24gKGlkKSB7XG4gICAgdGhpcy5jYXJkc1tpZF0uZGVyZW5kZXIoKTtcbiAgICB0aGlzLmNhcmRzW2lkXSA9IHVuZGVmaW5lZDtcblxuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICByZWRyYXdDYXJkOiBmdW5jdGlvbiAoY2FyZElkLCB4LCB5KSB7XG4gICAgbGV0IGNhcmQgPSB0aGlzLmNhcmRzW2NhcmRJZF07XG4gICAgY2FyZC54ID0geDtcbiAgICBjYXJkLnkgPSB5O1xuXG4gICAgY2FyZC5kZXJlbmRlcigpO1xuICAgIGNhcmQucmVuZGVyKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgc2F2ZUNhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHR5cGVvZihTdG9yYWdlKSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYXJkcycsIEpTT04uc3RyaW5naWZ5KHRoaXMuY2FyZHMpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coJ3lvdSBkb25cXCd0IGhhdmUgbG9jYWwgc3RvcmFnZSA6KCcpO1xuICAgIH1cblxuICAgIHRoaXMucGVyc2lzdFNlbGVjdGVkQ2FyZCgpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGxvYWRDYXJkczogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY2FyZHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYXJkcycpKTtcbiAgICBpZiAodGhpcy5jYXJkcyA9PT0gbnVsbCkge1xuICAgICAgdGhpcy5jYXJkcyA9IEpTT04ucGFyc2UoYXRvYihDT05GSUcuREVGQVVMVF9DT05URU5UKSk7XG4gICAgfVxuXG4gICAgdGhpcy5jbGVhckFycmF5KCk7XG5cbiAgICB0aGlzLmxvYWRTZWxlY3RlZENhcmQoKTtcblxuICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGNsZWFyQXJyYXk6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgaTtcblxuICAgIHRoaXMuY2FyZHMgPSB0aGlzLmNhcmRzLmZpbHRlcihmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgcmV0dXJuIGVsZW0gIT09IHVuZGVmaW5lZCAmJiBlbGVtICE9PSBudWxsO1xuICAgIH0pO1xuICAgIGZvciAoaSBpbiB0aGlzLmNhcmRzKSB7XG4gICAgICBpZiAodGhpcy5jYXJkcy5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICB0aGlzLmNhcmRzW2ldLmlkID0gaTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgcmVuZGVyQWxsQ2FyZHM6IGZ1bmN0aW9uICgpIHtcblxuICAgIHRoaXMuY2FyZHMuZm9yRWFjaCggKGNhcmQpID0+IHtcbiAgICAgICAgY2FyZC5zZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWRDYXJkICYmICh0aGlzLnNlbGVjdGVkQ2FyZC5pZCA9PT0gY2FyZC5pZCk7XG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihjYXJkLCBDYXJkKTtcbiAgICAgICAgY2FyZC5yZW5kZXIoKTtcbiAgICAgIH1cbiAgICApO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGdldEluc3RhbmNlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKENhcmRNYW5hZ2VyLmluc3RhbmNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIENhcmRNYW5hZ2VyLmluc3RhbmNlID0gT2JqZWN0LmNyZWF0ZShDYXJkTWFuYWdlciwge30pO1xuICAgICAgQ2FyZE1hbmFnZXIuaW5zdGFuY2UuaW5pdCgpO1xuICAgICAgcHVic3ViLnN1Yih3aW5kb3cuQ09ORklHLlNBVkVfQ0FSRFMsIENhcmRNYW5hZ2VyLmluc3RhbmNlLnNhdmVDYXJkcywgQ2FyZE1hbmFnZXIuaW5zdGFuY2UpO1xuICAgICAgcHVic3ViLnN1Yih3aW5kb3cuQ09ORklHLlNFTEVDVF9DQVJELCBDYXJkTWFuYWdlci5pbnN0YW5jZS5zZWxlY3RDYXJkLCBDYXJkTWFuYWdlci5pbnN0YW5jZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIENhcmRNYW5hZ2VyLmluc3RhbmNlO1xuXG4gIH0sXG4gIGV4cG9ydENhcmRzOiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGJ0b2EoSlNPTi5zdHJpbmdpZnkodGhpcy5jYXJkcykpO1xuICB9LFxuICBpbXBvcnRDYXJkczogZnVuY3Rpb24gKGRhdGEpIHtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FyZHMnLCBhdG9iKGRhdGEpKTtcbiAgICB0aGlzLmxvYWRDYXJkcygpO1xuICAgIHRoaXMucmVuZGVyQWxsQ2FyZHMoKTtcbiAgfSxcbiAgc2VsZWN0Q2FyZDogZnVuY3Rpb24gKGNhcmRJZCkge1xuICAgIGlmICh0aGlzLnNlbGVjdGVkQ2FyZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLnNlbGVjdGVkQ2FyZC5ub2RlLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7XG4gICAgfVxuICAgIHRoaXMuc2VsZWN0ZWRDYXJkID0gdGhpcy5jYXJkc1tjYXJkSWRdO1xuXG4gICAgdGhpcy5zZWxlY3RlZENhcmQubm9kZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpO1xuXG4gICAgdGhpcy5wZXJzaXN0U2VsZWN0ZWRDYXJkKCk7XG4gICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7XG4gIH0sXG4gIG5leHRDYXJkOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IGl0ID0gK3RoaXMuc2VsZWN0ZWRDYXJkLmlkICsgMTtcblxuICAgIHdoaWxlIChpdCAhPT0gK3RoaXMuc2VsZWN0ZWRDYXJkLmlkKSB7XG4gICAgICBpZiAodGhpcy5jYXJkc1tpdF0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmICgrK2l0ID49IHRoaXMuY2FyZHMubGVuZ3RoKSB7XG4gICAgICAgIGl0ID0gMDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnNlbGVjdENhcmQgKGl0KTtcbiAgfSxcbiAgcHJldmlvdXNDYXJkOiBmdW5jdGlvbigpIHtcbiAgICBsZXQgaXQgPSArdGhpcy5zZWxlY3RlZENhcmQuaWQgLSAxO1xuXG4gICAgd2hpbGUgKGl0ICE9PSArdGhpcy5zZWxlY3RlZENhcmQuaWQpIHtcbiAgICAgIGlmICh0aGlzLmNhcmRzW2l0XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKC0taXQgPD0gMCkge1xuICAgICAgICBpdCA9IHRoaXMuY2FyZHMubGVuZ3RoO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuc2VsZWN0Q2FyZCAoaXQpO1xuICB9LFxuICBwZXJzaXN0U2VsZWN0ZWRDYXJkOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5zZWxlY3RlZENhcmQgJiYgdGhpcy5zZWxlY3RlZENhcmQuaWQgPiAtMSkge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3NlbGVjdGVkQ2FyZCcsIHRoaXMuc2VsZWN0ZWRDYXJkLmlkKTtcbiAgICB9XG4gIH0sXG4gIGxvYWRTZWxlY3RlZENhcmQ6IGZ1bmN0aW9uKCkge1xuICAgIGxldCBzZWxlY3RlZENhcmRJZCA9ICtsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2VsZWN0ZWRDYXJkJyk7XG5cbiAgICBpZiAoc2VsZWN0ZWRDYXJkSWQgIT09IHVuZGVmaW5lZCAmJiBzZWxlY3RlZENhcmRJZCA+IC0xKSB7XG4gICAgICB0aGlzLnNlbGVjdGVkQ2FyZCA9IHRoaXMuY2FyZHNbc2VsZWN0ZWRDYXJkSWRdO1xuICAgIH1cbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBDYXJkTWFuYWdlcjsiLCJsZXQgY2FyZE1hbmFnZXIgPSByZXF1aXJlKCcuL21vZGVscy9DYXJkTWFuYWdlcicpLmdldEluc3RhbmNlKCk7XG5cbmZ1bmN0aW9uIGNyZWF0ZURpdih0ZXh0LCBjbGFzc05hbWUpIHtcbiAgbGV0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBkaXYuaW5uZXJIVE1MID0gdGV4dDtcbiAgZGl2LnN0eWxlLmZsb2F0ID0gXCJyaWdodFwiO1xuICBkaXYuc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG4gIGRpdi5zdHlsZS53aWR0aCA9IFwiMTZweFwiO1xuICBkaXYuc3R5bGUudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcblxuICBpZiAoY2xhc3NOYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICBkaXYuY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xuICB9XG5cbiAgcmV0dXJuIGRpdjtcbn1cblxuZnVuY3Rpb24gY29weVNlbGVjdGlvblRleHQoKSB7XG4gIGxldCBjb3B5c3VjY2VzczsgLy8gbGV0IHRvIGNoZWNrIHdoZXRoZXIgZXhlY0NvbW1hbmQgc3VjY2Vzc2Z1bGx5IGV4ZWN1dGVkXG4gIHRyeSB7XG4gICAgY29weXN1Y2Nlc3MgPSBkb2N1bWVudC5leGVjQ29tbWFuZChcImNvcHlcIik7IC8vIHJ1biBjb21tYW5kIHRvIGNvcHkgc2VsZWN0ZWQgdGV4dCB0byBjbGlwYm9hcmRcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvcHlzdWNjZXNzID0gZmFsc2VcbiAgfVxuICByZXR1cm4gY29weXN1Y2Nlc3Ncbn1cblxuZnVuY3Rpb24gc2VsZWN0VGV4dChlbGVtZW50KSB7XG4gIGxldCBkb2MgPSBkb2N1bWVudFxuICAgICwgdGV4dCA9IGVsZW1lbnRcbiAgICAsIHJhbmdlLCBzZWxlY3Rpb25cbiAgICA7XG4gIGlmIChkb2MuYm9keS5jcmVhdGVUZXh0UmFuZ2UpIHtcbiAgICByYW5nZSA9IGRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgcmFuZ2UubW92ZVRvRWxlbWVudFRleHQodGV4dCk7XG4gICAgcmFuZ2Uuc2VsZWN0KCk7XG4gIH0gZWxzZSBpZiAod2luZG93LmdldFNlbGVjdGlvbikge1xuICAgIHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcbiAgICByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XG4gICAgcmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKHRleHQpO1xuICAgIHNlbGVjdGlvbi5yZW1vdmVBbGxSYW5nZXMoKTtcbiAgICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xuICAgIHJldHVybiBzZWxlY3Rpb247XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0UGFyZW50Q2FyZElkKGNvbnRleHQpIHtcbiAgaWYgKGNvbnRleHQucGFyZW50RWxlbWVudCA9PT0gbnVsbCkgcmV0dXJuO1xuICByZXR1cm4gcGFyc2VJbnQoY29udGV4dC5wYXJlbnRFbGVtZW50LmlkLnNwbGl0KFwiX1wiKVsxXSk7XG59XG5cbmZ1bmN0aW9uIGNoYW5nZURlcHRoKGNhcmRJZCwgaW5jcmVtZW50KSB7XG4gIGxldCBkZXB0aCA9IGNhcmRNYW5hZ2VyLmNhcmRzW2NhcmRJZF0uZGVwdGggKyBpbmNyZW1lbnQ7XG5cbiAgdGhpcy5zdHlsZS56SW5kZXggPSBkZXB0aDtcbiAgY2FyZE1hbmFnZXIuY2FyZHNbY2FyZElkXS5kZXB0aCA9IGRlcHRoO1xuICB0aGlzLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJkZXB0aFwiKVswXS5pbm5lckhUTUwgPSBkZXB0aDtcbn1cblxuZnVuY3Rpb24gc2V0RGVwdGgoY2FyZElkLCBkZXB0aCkge1xuICB0aGlzLnN0eWxlLnpJbmRleCA9IGRlcHRoO1xuICBjYXJkTWFuYWdlci5jYXJkc1tjYXJkSWRdLmRlcHRoID0gZGVwdGg7XG4gIHRoaXMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImRlcHRoXCIpWzBdLmlubmVySFRNTCA9IGRlcHRoO1xufVxuXG5mdW5jdGlvbiBnZXRDYXJkSFRNTEJ5SWQgKG1haW5Db250YWluZXIsIGlkKSB7XG4gIHJldHVybiBtYWluQ29udGFpbmVyLmdldEVsZW1lbnRCeUlkKCd0b2RvXycgKyBpZCk7XG59XG5cbi8vIFBST1RPVFlQRVNcblxuLypcbiAqIFJldHVybnMgdGhlIHNpemUgb2YgYW4gYXJyYXlcbiAqL1xuQXJyYXkucHJvdG90eXBlLnNpemUgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbiAoYSkge1xuICAgIHJldHVybiBhICE9PSB1bmRlZmluZWQ7XG4gIH0pLmxlbmd0aFxufTtcblxuLypcbiAqIFJldHVybnMgdGhlIHNpemUgb2YgYW4gb2JqZWN0XG4gKi9cbk9iamVjdC5zaXplID0gZnVuY3Rpb24gKG9iaikge1xuICBsZXQgc2l6ZSA9IDAsIGtleSA9IFwiXCI7XG5cbiAgZm9yIChrZXkgaW4gb2JqKSB7XG4gICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSBzaXplKys7XG4gIH1cbiAgcmV0dXJuIHNpemU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgY3JlYXRlRGl2OiBjcmVhdGVEaXYsXG4gIGNvcHlTZWxlY3Rpb25UZXh0OiBjb3B5U2VsZWN0aW9uVGV4dCxcbiAgc2VsZWN0VGV4dDogc2VsZWN0VGV4dCxcbiAgZ2V0UGFyZW50Q2FyZElkOiBnZXRQYXJlbnRDYXJkSWQsXG4gIGNoYW5nZURlcHRoOiBjaGFuZ2VEZXB0aCxcbiAgc2V0RGVwdGg6IHNldERlcHRoLFxuICBnZXRDYXJkSFRNTEJ5SWQ6IGdldENhcmRIVE1MQnlJZFxufTsiXX0="}