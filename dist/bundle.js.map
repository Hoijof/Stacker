{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/murmurhash-js/index.js","node_modules/murmurhash-js/murmurhash2_gc.js","node_modules/murmurhash-js/murmurhash3_gc.js","node_modules/random-material-color/dist/randomColor.js","src/js/config.js","src/js/lib/keyHandler.js","src/js/lib/loger.js","src/js/lib/pubsub.js","src/js/main.js","src/js/models/Card.js","src/js/models/CardManager.js","src/js/prototypes.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnEA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var murmur3 = require(\"./murmurhash3_gc.js\")\nvar murmur2 = require(\"./murmurhash2_gc.js\")\n\nmodule.exports = murmur3\nmodule.exports.murmur3 = murmur3\nmodule.exports.murmur2 = murmur2\n","/**\n * JS Implementation of MurmurHash2\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} str ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash\n */\n\nfunction murmurhash2_32_gc(str, seed) {\n  var\n    l = str.length,\n    h = seed ^ l,\n    i = 0,\n    k;\n  \n  while (l >= 4) {\n  \tk = \n  \t  ((str.charCodeAt(i) & 0xff)) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 8) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 16) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 24);\n    \n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n    k ^= k >>> 24;\n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n\n\th = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16)) ^ k;\n\n    l -= 4;\n    ++i;\n  }\n  \n  switch (l) {\n  case 3: h ^= (str.charCodeAt(i + 2) & 0xff) << 16;\n  case 2: h ^= (str.charCodeAt(i + 1) & 0xff) << 8;\n  case 1: h ^= (str.charCodeAt(i) & 0xff);\n          h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  }\n\n  h ^= h >>> 13;\n  h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  h ^= h >>> 15;\n\n  return h >>> 0;\n}\n\nif(typeof module !== undefined) {\n  module.exports = murmurhash2_32_gc\n}\n","/**\n * JS Implementation of MurmurHash3 (r136) (as of May 20, 2011)\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} key ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash \n */\n\nfunction murmurhash3_32_gc(key, seed) {\n\tvar remainder, bytes, h1, h1b, c1, c1b, c2, c2b, k1, i;\n\t\n\tremainder = key.length & 3; // key.length % 4\n\tbytes = key.length - remainder;\n\th1 = seed;\n\tc1 = 0xcc9e2d51;\n\tc2 = 0x1b873593;\n\ti = 0;\n\t\n\twhile (i < bytes) {\n\t  \tk1 = \n\t  \t  ((key.charCodeAt(i) & 0xff)) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 8) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 16) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 24);\n\t\t++i;\n\t\t\n\t\tk1 = ((((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16))) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = ((((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16))) & 0xffffffff;\n\n\t\th1 ^= k1;\n        h1 = (h1 << 13) | (h1 >>> 19);\n\t\th1b = ((((h1 & 0xffff) * 5) + ((((h1 >>> 16) * 5) & 0xffff) << 16))) & 0xffffffff;\n\t\th1 = (((h1b & 0xffff) + 0x6b64) + ((((h1b >>> 16) + 0xe654) & 0xffff) << 16));\n\t}\n\t\n\tk1 = 0;\n\t\n\tswitch (remainder) {\n\t\tcase 3: k1 ^= (key.charCodeAt(i + 2) & 0xff) << 16;\n\t\tcase 2: k1 ^= (key.charCodeAt(i + 1) & 0xff) << 8;\n\t\tcase 1: k1 ^= (key.charCodeAt(i) & 0xff);\n\t\t\n\t\tk1 = (((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16)) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = (((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16)) & 0xffffffff;\n\t\th1 ^= k1;\n\t}\n\t\n\th1 ^= key.length;\n\n\th1 ^= h1 >>> 16;\n\th1 = (((h1 & 0xffff) * 0x85ebca6b) + ((((h1 >>> 16) * 0x85ebca6b) & 0xffff) << 16)) & 0xffffffff;\n\th1 ^= h1 >>> 13;\n\th1 = ((((h1 & 0xffff) * 0xc2b2ae35) + ((((h1 >>> 16) * 0xc2b2ae35) & 0xffff) << 16))) & 0xffffffff;\n\th1 ^= h1 >>> 16;\n\n\treturn h1 >>> 0;\n}\n\nif(typeof module !== \"undefined\") {\n  module.exports = murmurhash3_32_gc\n}","var defaultPalette={50:[\"#FFEBEE\",\"#FCE4EC\",\"#F3E5F5\",\"#EDE7F6\",\"#E8EAF6\",\"#E3F2FD\",\"#E1F5FE\",\"#E0F7FA\",\"#E0F2F1\",\"#E8F5E9\",\"#F1F8E9\",\"#F9FBE7\",\"#FFFDE7\",\"#FFF8E1\",\"#FFF3E0\",\"#FBE9E7\",\"#EFEBE9\",\"#FAFAFA\",\"#ECEFF1\"],100:[\"#FFCDD2\",\"#F8BBD0\",\"#E1BEE7\",\"#D1C4E9\",\"#C5CAE9\",\"#BBDEFB\",\"#B3E5FC\",\"#B2EBF2\",\"#B2DFDB\",\"#C8E6C9\",\"#DCEDC8\",\"#F0F4C3\",\"#FFF9C4\",\"#FFECB3\",\"#FFE0B2\",\"#FFCCBC\",\"#D7CCC8\",\"#F5F5F5\",\"#CFD8DC\"],200:[\"#EF9A9A\",\"#F48FB1\",\"#CE93D8\",\"#B39DDB\",\"#9FA8DA\",\"#90CAF9\",\"#81D4FA\",\"#80DEEA\",\"#80CBC4\",\"#A5D6A7\",\"#C5E1A5\",\"#E6EE9C\",\"#FFF59D\",\"#FFE082\",\"#FFCC80\",\"#FFAB91\",\"#BCAAA4\",\"#EEEEEE\",\"#B0BEC5\"],300:[\"#E57373\",\"#F06292\",\"#BA68C8\",\"#9575CD\",\"#7986CB\",\"#64B5F6\",\"#4FC3F7\",\"#4DD0E1\",\"#4DB6AC\",\"#81C784\",\"#AED581\",\"#DCE775\",\"#FFF176\",\"#FFD54F\",\"#FFB74D\",\"#FF8A65\",\"#A1887F\",\"#E0E0E0\",\"#90A4AE\"],400:[\"#EF5350\",\"#EC407A\",\"#AB47BC\",\"#7E57C2\",\"#5C6BC0\",\"#42A5F5\",\"#29B6F6\",\"#26C6DA\",\"#26A69A\",\"#66BB6A\",\"#9CCC65\",\"#D4E157\",\"#FFEE58\",\"#FFCA28\",\"#FFA726\",\"#FF7043\",\"#8D6E63\",\"#BDBDBD\",\"#78909C\"],500:[\"#F44336\",\"#E91E63\",\"#9C27B0\",\"#673AB7\",\"#3F51B5\",\"#2196F3\",\"#03A9F4\",\"#00BCD4\",\"#009688\",\"#4CAF50\",\"#8BC34A\",\"#CDDC39\",\"#FFEB3B\",\"#FFC107\",\"#FF9800\",\"#FF5722\",\"#795548\",\"#9E9E9E\",\"#607D8B\"],600:[\"#E53935\",\"#D81B60\",\"#8E24AA\",\"#5E35B1\",\"#3949AB\",\"#1E88E5\",\"#039BE5\",\"#00ACC1\",\"#00897B\",\"#43A047\",\"#7CB342\",\"#C0CA33\",\"#FDD835\",\"#FFB300\",\"#FB8C00\",\"#F4511E\",\"#6D4C41\",\"#757575\",\"#546E7A\"],700:[\"#D32F2F\",\"#C2185B\",\"#7B1FA2\",\"#512DA8\",\"#303F9F\",\"#1976D2\",\"#0288D1\",\"#0097A7\",\"#00796B\",\"#388E3C\",\"#689F38\",\"#AFB42B\",\"#FBC02D\",\"#FFA000\",\"#F57C00\",\"#E64A19\",\"#5D4037\",\"#616161\",\"#455A64\"],800:[\"#C62828\",\"#AD1457\",\"#6A1B9A\",\"#4527A0\",\"#283593\",\"#1565C0\",\"#0277BD\",\"#00838F\",\"#00695C\",\"#2E7D32\",\"#558B2F\",\"#9E9D24\",\"#F9A825\",\"#FF8F00\",\"#EF6C00\",\"#D84315\",\"#4E342E\",\"#424242\",\"#37474F\"],900:[\"#B71C1C\",\"#880E4F\",\"#4A148C\",\"#311B92\",\"#1A237E\",\"#0D47A1\",\"#01579B\",\"#006064\",\"#004D40\",\"#1B5E20\",\"#33691E\",\"#827717\",\"#F57F17\",\"#FF6F00\",\"#E65100\",\"#BF360C\",\"#3E2723\",\"#212121\",\"#263238\"],A100:[\"#FF8A80\",\"#FF80AB\",\"#EA80FC\",\"#B388FF\",\"#8C9EFF\",\"#82B1FF\",\"#80D8FF\",\"#84FFFF\",\"#A7FFEB\",\"#B9F6CA\",\"#CCFF90\",\"#F4FF81\",\"#FFFF8D\",\"#FFE57F\",\"#FFD180\",\"#FF9E80\"],A200:[\"#FF5252\",\"#FF4081\",\"#E040FB\",\"#7C4DFF\",\"#536DFE\",\"#448AFF\",\"#40C4FF\",\"#18FFFF\",\"#64FFDA\",\"#69F0AE\",\"#B2FF59\",\"#EEFF41\",\"#FFFF00\",\"#FFD740\",\"#FFAB40\",\"#FF6E40\"],A400:[\"#FF1744\",\"#F50057\",\"#D500F9\",\"#651FFF\",\"#3D5AFE\",\"#2979FF\",\"#00B0FF\",\"#00E5FF\",\"#1DE9B6\",\"#00E676\",\"#76FF03\",\"#C6FF00\",\"#FFEA00\",\"#FFC400\",\"#FF9100\",\"#FF3D00\"],A700:[\"#D50000\",\"#C51162\",\"#AA00FF\",\"#6200EA\",\"#304FFE\",\"#2962FF\",\"#0091EA\",\"#00B8D4\",\"#00BFA5\",\"#00C853\",\"#64DD17\",\"#AEEA00\",\"#FFD600\",\"#FFAB00\",\"#FF6D00\",\"#DD2C00\"]},murmur=require(\"murmurhash-js\");module.exports=function(){var F=[],E={shades:[\"500\"],palette:defaultPalette,text:null,ignoreColors:[]},C=function(C){C||(C=E),C.palette||(C.palette=defaultPalette),C.shades||(C.shades=[\"500\"]);for(var B,D=F.length,t=0;D>t;t++)if(C.text&&F[t].text===C.text)return F[t].color;return B=A(C),C.text&&F.push({text:C.text,color:B}),B},A=function(F){var E=F.shades[B(F.shades.length)],C=\"\";for(var A in F.palette)F.palette.hasOwnProperty(A)&&A===E&&(C=F.text?F.palette[A][D(F.text,F.palette[A].length)]:F.palette[A][B(F.palette[A].length)]);return C},B=function(F){return Math.floor(Math.random()*F)},D=function(F,E){var C=murmur.murmur3(F)/1e10;return.1>C&&(C=10*C),Math.floor(C*E)};return{getColor:C}}();","module.exports = {\n  SAVE_CARDS: 'SAVE_CARDS',\n  SELECT_CARD: 'SELECT_CARD',\n  RERENDER: 'RERENDER',\n  LESS_PRISTINE: 'LESS_PRISTINE',\n  ASCII: {\n    ESCAPE_KEY: 27,\n    TAB_KEY: 9,\n    C_KEY: 67,\n    D_KEY: 68,\n    E_KEY: 69,\n    PLUS_KEY: 187,\n    MINUS_KEY: 189,\n    DOT_KEY: 190,\n    A_KEY: 65,\n    I_KEY: 73,\n    R_KEY: 82,\n    Z_KEY: 90,\n    CMD_KEY: 91,\n    KEYS_ARRAY: [27, 9, 67, 68, 69, 187, 189, 190, 65, 73, 82, 90, 91]\n  },\n  DEFAULT_CONTENT: 'W3siaWQiOjAsInRpdGxlIjoiMSIsImRlc2NyaXB0aW9uIjoiVXNlIHRhYiBhbmQgc2hpZnQgdGFiIHRvIGNpcmNsZSBiZXR3ZWVuIGNhcmRzIDpEXG5cbkRyYWdnaW5nIG9yIGNsaWNraW5nIHRoZW0gd2lsbCBhbHNvIG1hcmsgdGhlbSBhcyBzZWxlY3RlZCIsImRlcHRoIjo1LCJ4IjoxNjksInkiOjc5LCJjb2xvciI6IiNBNUQ2QTciLCJzZWxlY3RlZCI6dHJ1ZSwiaXNBcmNoaXZlZCI6ZmFsc2UsImlzRGVsZXRlZCI6ZmFsc2UsImNyZWF0ZWRBdCI6MTUwNzY0Njc1ODE4NiwiYXJjaGl2ZWRBdCI6bnVsbCwibm9kZSI6eyJqUXVlcnkxNzIwNDI0NzE4MTg1NzEyOTY0MDUiOjR9fSx7ImlkIjoxLCJ0aXRsZSI6IjIiLCJkZXNjcmlwdGlvbiI6Ik9uIGEgbWFya2VkIGNhcmQgdXNlIGN0cmwgKzpcbidjJyB0byBjb3B5IHRoZSBjb250ZW50XG4nZCcgdG8gZGVsZXRlIGl0XG4nZScgdG8gZWRpdCBpdFxuJ2EnIHRvIGFyY2hpdmUgb3IgZGVhcmNoaXZlIGRlIGNhcmQiLCJkZXB0aCI6NSwieCI6MzgyLCJ5Ijo3NiwiY29sb3IiOiIjQUVENTgxIiwic2VsZWN0ZWQiOmZhbHNlLCJpc0FyY2hpdmVkIjpmYWxzZSwiaXNEZWxldGVkIjpmYWxzZSwiY3JlYXRlZEF0IjoxNTA3NjQ2NzcxNzQwLCJhcmNoaXZlZEF0IjpudWxsLCJub2RlIjp7ImpRdWVyeTE3MjA0MjQ3MTgxODU3MTI5NjQwNSI6OH19LHsiaWQiOjIsInRpdGxlIjoiZW50ZXJzIiwiZGVzY3JpcHRpb24iOiJXaGlsZSBlZGl0aW5nIHVzZSBzaGlmdCArIGVudGVyIHRvIFxuaW5zZXJ0XG5hXG5saW5lXG5icmVha1xuOkQiLCJkZXB0aCI6NSwieCI6MTU5LCJ5IjozMTIsImNvbG9yIjoiI0ZGQjc0RCIsInNlbGVjdGVkIjpmYWxzZSwiaXNBcmNoaXZlZCI6ZmFsc2UsImlzRGVsZXRlZCI6ZmFsc2UsImNyZWF0ZWRBdCI6MTUwNzY0Njc5MjI5NywiYXJjaGl2ZWRBdCI6bnVsbCwibm9kZSI6eyJqUXVlcnkxNzIwNDI0NzE4MTg1NzEyOTY0MDUiOjZ9fSx7ImlkIjozLCJ0aXRsZSI6IkdlbmVyaWMiLCJkZXNjcmlwdGlvbiI6IllvdSBjYW4gYWxzbyB1c2UgZ2VuZXJpYyBjb21tYW5kcyBzdWNoIGFzIGN0cmwrXG4naScgdG8gY3JlYXRlIGEgY2FyZFxuJ3onIHRvIHJldml2ZSB0aGUgbGFzdCBkZWxldGVkIGNhcmQiLCJkZXB0aCI6NSwieCI6NDQxLCJ5IjoyOTYsImNvbG9yIjoiI0ZGRTA4MiIsInNlbGVjdGVkIjpmYWxzZSwiaXNBcmNoaXZlZCI6ZmFsc2UsImlzRGVsZXRlZCI6ZmFsc2UsImNyZWF0ZWRBdCI6MTUwNzY0ODYzODM4NiwiYXJjaGl2ZWRBdCI6bnVsbCwiaXNQcmlzdGluZSI6ZmFsc2UsIm5vZGUiOnsialF1ZXJ5MTcyMDQyNDcxODE4NTcxMjk2NDA1IjoxMH19XQ',\n  VERSION: '0.5.0'\n};\n","const CONFIG = require('../config');\n\nlet cardManager;\nlet Card = require('../models/Card');\n\nlet mainContainer,\n  editContainer,\n  editInput,\n  titleInput,\n  importContainer,\n  importInput,\n  exportContainer,\n  exportContent,\n  importButton;\n\nfunction init (options) {\n  cardManager = options.cardManager;\n  bindings();\n}\n\nfunction bindings () {\n  mainContainer = $('#mainContainer');\n  editContainer = document.getElementById('editContainer');\n  editInput = editContainer.getElementsByClassName('textarea')[0];\n  titleInput = editContainer.getElementsByClassName('input')[0];\n  importContainer = document.getElementById('importContainer');\n  importInput = importContainer.getElementsByClassName('input')[0];\n  importButton = importContainer.getElementsByClassName('button')[0];\n  exportContainer = document.getElementById('exportContainer');\n  exportContent = exportContainer.getElementsByTagName('div')[0];\n\n  window.addEventListener('keyup', keyHandlerUp, false);\n  window.addEventListener('keydown', keyHandlerDown, false);\n  editInput.addEventListener('keydown', editInputKeyEvent);\n  titleInput.addEventListener('keydown', editInputKeyEvent);\n  editContainer.addEventListener('click', hideEditContainer);\n  editInput.addEventListener('click', stopPropagation);\n  titleInput.addEventListener('click', stopPropagation);\n  /*\n     On double click edit the card\n     */\n  mainContainer.on('dblclick', 'div', doubleClickHandler);\n  /*\n     On click perform the card\n     */\n  mainContainer.on('click', 'div', cardClickEvents);\n  mainContainer.on('click', 'div > div', cardMenuEvents);\n  document.getElementById('export').addEventListener('click', exportCards);\n  document.getElementById('import').addEventListener('click', showImporter);\n  importButton.addEventListener('click', loadImportCardsCode);\n  importContainer.addEventListener('click', hideImportContainer);\n  importInput.addEventListener('keydown', importInputKeyEvent);\n  importInput.addEventListener('click', stopPropagation);\n  exportContainer.addEventListener('click', hideExportContainer);\n  exportContent.addEventListener('click', stopPropagation);\n}\n\nfunction keyHandlerDown (e) {\n  if (e.keyCode === CONFIG.ASCII.TAB_KEY) {\n    document.activeElement.blur();\n    if (e.shiftKey) {\n      cardManager.previousCard();\n    } else {\n      cardManager.nextCard();\n    }\n    if (e.preventDefault) {\n      e.preventDefault();\n    }\n  } else if (e.keyCode === CONFIG.ASCII.CMD_KEY) {\n    window.cmdPress = true;\n  }\n}\n\nfunction keyHandlerUp (e) {\n  console.log(e.keyCode);\n  console.log(document.activeElement);\n  if (document.activeElement !== document.body || CONFIG.ASCII.KEYS_ARRAY.indexOf(e.keyCode) === -1) {\n    return;\n  }\n  e.stopPropagation();\n  e.preventDefault();\n\n  switch (e.keyCode) {\n    case CONFIG.ASCII.C_KEY:\n      let elem = cardManager.selectedCard.node;\n      let selection;\n\n      selection = selectText(elem.getElementsByClassName('cardText')[0]);\n      copySelectionText();\n      selection.empty();\n\n      break;\n    case CONFIG.ASCII.D_KEY:\n      let card = cardManager.selectedCard;\n      cardManager.nextCard();\n      cardManager.deleteCard(card);\n      cardManager.saveData();\n      break;\n    case CONFIG.ASCII.E_KEY:\n      doubleClickHandler.apply(cardManager.selectedCard.node);\n\n      break;\n    case CONFIG.ASCII.A_KEY:\n      cardManager.selectedCard.toggleArchived();\n      break;\n    case CONFIG.ASCII.I_KEY:\n      // input.focus();\n      createCard();\n      break;\n    case CONFIG.ASCII.PLUS_KEY:\n      changeDepth.apply(cardManager.selectedCard.node, [cardManager.selectedCard.id, 1]);\n      break;\n    case CONFIG.ASCII.MINUS_KEY:\n      changeDepth.apply(cardManager.selectedCard.node, [cardManager.selectedCard.id, -1]);\n      break;\n    case CONFIG.ASCII.DOT_KEY:\n      setDepth.apply(cardManager.selectedCard.node, [cardManager.selectedCard.id, 5]);\n      break;\n    case CONFIG.ASCII.R_KEY:\n      cardManager.selectedCard.color = cardManager.selectedCard.getBackgroundColor();\n      cardManager.selectedCard.derender();\n      cardManager.selectedCard.render();\n\n      cardManager.saveData();\n      break;\n    case CONFIG.ASCII.Z_KEY:\n      cardManager.undeleteLastCard();\n      break;\n    case CONFIG.ASCII.CMD_KEY:\n      window.cmdPress = false;\n  }\n}\n\nfunction hideExportContainer () {\n  exportContainer.style.display = 'none';\n}\n\nfunction hideEditContainer () {\n  editContainer.style.display = 'none';\n}\n\nfunction hideImportContainer () {\n  importContainer.style.display = 'none';\n}\n\nfunction stopPropagation (e) {\n  e.stopPropagation();\n}\n\nfunction editInputKeyEvent (event) {\n  event.stopPropagation();\n  let card;\n  if (event.keyCode === 13 && event.shiftKey) return;\n  if (event.keyCode === 13) {\n    card = cardManager.cards[editContainer.cardId];\n    card.title = titleInput.value;\n    card.description = editInput.value;\n    card.derender();\n    card.render();\n    this.value = '';\n    cardManager.saveData();\n    hideEditContainer();\n  } else if (event.keyCode === 27) {\n    hideEditContainer();\n  }\n}\n\nfunction importInputKeyEvent (event) {\n  if (event.keyCode === 27) {\n    hideImportContainer();\n  }\n}\n\nfunction doubleClickHandler () {\n  let cardId;\n  let card;\n\n  if (this.id === '') {\n    cardId = parseInt(this.parentElement.id.split('_')[1]);\n  } else {\n    cardId = parseInt(this.id.split('_')[1]);\n  }\n\n  card = cardManager.cards[cardId];\n\n  titleInput.value = card.title;\n  editInput.value = card.description;\n  titleInput.style.top = card.y;\n  titleInput.style.left = card.x;\n  editContainer.cardId = cardId;\n  editContainer.style.display = 'block';\n  editInput.style.top = card.y + 23;\n  editInput.style.left = card.x;\n  titleInput.focus();\n}\n\nfunction cardClickEvents (event) {\n  let cardId;\n  let card;\n\n  if (this.id === '') {\n    cardId = parseInt(this.parentElement.id.split('_')[1]);\n  } else {\n    cardId = parseInt(this.id.split('_')[1]);\n  }\n\n  card = cardManager.cards[cardId];\n\n  if (card === undefined) return;\n\n  cardManager.selectCard(card.id);\n\n  if (event.ctrlKey) {\n  }\n  if (event.altKey) {\n    this.querySelector('.copy').click();\n  }\n  if (event.shiftKey) {\n\n  }\n}\n\nfunction cardMenuEvents () {\n  let option = $(this).html();\n  let selection;\n  let cardId = getParentCardId(this);\n\n  switch (option) {\n    case '+':\n      changeDepth.apply(this, [cardId, 1]);\n      break;\n    case '-':\n      changeDepth.apply(this, [cardId, -1]);\n      break;\n    case 'C':\n      selection = selectText(this.parentElement.getElementsByClassName('cardText')[0]);\n      copySelectionText();\n      selection.empty();\n      break;\n    case 'x':\n      cardManager.deleteCard(cardManager.cards[cardId]);\n      break;\n    case 'V':\n    case 'O':\n      cardManager.cards[cardId].toggleArchived();\n  }\n  cardManager.saveData();\n}\n\nfunction exportCards () {\n  exportContainer.style.display = 'block';\n  exportContent.innerHTML = cardManager.exportCards();\n  selection = selectText(exportContent);\n  copySelectionText();\n  selection.empty();\n}\n\nfunction loadImportCardsCode () {\n  let data = importInput.value;\n  cardManager.importCards(data);\n  importContainer.style.display = 'none';\n}\n\nfunction showImporter () {\n  importContainer.style.display = 'block';\n  importInput.focus();\n}\n\nfunction createCard () {\n  const card = cardManager.addCard(Object.create(Card, {}).init(''));\n  card.render();\n  cardManager.selectCard(card.id);\n\n  // and now we autoedit :D\n  doubleClickHandler.apply(card.node);\n}\n\nmodule.exports = {\n  init: init\n};\n","window.loger = false;\n\nmodule.exports = {\n    log: function(message) {\n        if (window.loger) {\n            console.log(message);\n        }\n    },\n    warn: function(message) {\n        if (window.loger) {\n            console.warn(message);\n        }\n    },\n    error: function(message) {\n        if (window.loger) {\n            console.error(message);\n        }\n    }\n};","\nvar subs = {};\n\nfunction pub (name, params) {\n  subs[name].forEach(function (elem) {\n    elem.callback.apply(elem.context, params);\n  });\n}\n\nfunction sub (name, callback, context) {\n  if (subs[name] === undefined) {\n    subs[name] = [];\n  }\n\n  subs[name].push({\n    callback: callback,\n    context: context\n  });\n}\n\nmodule.exports = {\n  pub: pub,\n  sub: sub\n};\n","window.CONFIG = require('./config.js');\n\nlet keyHandler = require('./lib/keyHandler');\nlet cardManager = require('./models/CardManager').getInstance();\nlet pubsub = require('./lib/pubsub');\n\nwindow.cm = {\n  cardManager: cardManager\n};\n\nObject.assign(window, require('./prototypes'));\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  'strict mode';\n\n  keyHandler.init({\n    cardManager: cardManager\n  });\n    \n  cardManager.loadData();\n  cardManager.renderAllCards();\n});\n","let pubsub = require('../lib/pubsub');\nlet randomMC = require('random-material-color');\n\nlet Card = {\n  init: function (title, description, pristine) {\n    this.id = -1;\n    this.title = title;\n    this.description = description || \"\";\n    this.depth = 5;\n    this.x = 100;\n    this.y = 100;\n    this.color = this.getBackgroundColor();\n    this.selected = false;\n    this.isArchived = false;\n    this.isDeleted = false;\n    this.createdAt = +new Date();\n    this.archivedAt = null;\n    this.isPristine = true;\n\n    return this;\n  },\n  render: function (always = false) {\n    if (this.isDeleted === true && always === false) {\n      return;\n    }\n\n    let node = document.createElement('div');\n    let title = document.createElement('div');\n    let text = document.createElement('div');\n    let link = this.findLink();\n    let that = this;\n\n    if (this.title) {\n      if (link) {\n        title.innerHTML = `<a target=\"_blank\" href=\"${link}\">${this.title}</a>`;\n      } else {\n        title.innerHTML = this.title;\n      }\n    } else {\n      if (link) {\n        title.innerHTML = `<a target=\"_blank\" href=\"${link}\">Link!</a>`;\n      }\n    }\n\n    if (this.description) {\n      text.innerHTML = this.description.replace(/\\r?\\n/g, '<br/>');\n    }\n\n    title.className = 'cardTitle';\n    text.className = 'cardText';\n\n    node.id = 'todo_' + this.id;\n    node.className = 'card card-1';\n    node.style.position = 'fixed';\n    node.style.left = this.x;\n    node.style.top = this.y;\n    node.style.cursor = '-webkit-grab';\n    node.style.zIndex = this.depth;\n    node.style.backgroundColor = this.color;\n\n    document.getElementById('mainContainer').appendChild(node);\n\n    node.appendChild(createDiv('x', 'control remove'));\n    // node.appendChild(createDiv('+', 'control up'));\n    // node.appendChild(createDiv('-', 'control down'));\n    node.appendChild(createDiv('C', 'control copy'));\n    node.appendChild(createDiv('depth: ' + this.depth, 'depth'));\n    // node.appendChild(createDiv(this.isArchived ? 'V' : 'O', 'isArchived'));\n    node.appendChild(createDiv('id: ' + this.id, 'id'));\n\n    node.appendChild(title);\n    node.appendChild(text);\n\n    $('#todo_' + this.id).draggable({\n      stop: function () {\n        let card = $('#todo_' + that.id);\n\n        if (that.isPristine === true) {\n          that.isPristine = false;\n\n          pubsub.pub(window.CONFIG.LESS_PRISTINE);\n        }\n\n        that.x = +card.css('left').replace('px', '');\n        that.y = +card.css('top').replace('px', '');\n\n        pubsub.pub(window.CONFIG.SELECT_CARD, [that.id]);\n        pubsub.pub(window.CONFIG.SAVE_CARDS);\n      }\n    });\n\n    this.node = node;\n\n    if (this.selected === true) {\n      node.classList.add('selected');\n    }\n\n    if (this.isArchived) {\n      node.classList.add('completed');\n    }\n\n    return this;\n  },\n  getBackgroundColor: function () {\n    return randomMC.getColor({ shades: ['200', '300'] });\n  },\n  derender: function () {\n    let node = document.getElementById('todo_' + this.id);\n    document.getElementById('mainContainer').removeChild(node);\n\n    return this;\n  },\n  toggleArchived: function () {\n    if (this.isArchived === false || this.isArchived === undefined) {\n      this.node.classList.remove('notCompleted');\n      void this.node.offsetWidth;\n      this.node.classList.add('completed');\n      this.archivedAt = +new Date();\n    } else {\n      this.node.classList.remove('completed');\n      void this.node.offsetWidth;\n      this.node.classList.add('notCompleted');\n      this.archivedAt = null;\n    }\n\n    this.isArchived = !this.isArchived;\n\n    pubsub.pub(window.CONFIG.SAVE_CARDS);\n  },\n  delete: function () {\n    this.isDeleted = true;\n\n    this.derender();\n  },\n  undelete: function () {\n    this.isDeleted = false;\n\n    this.render();\n\n    return this;\n  },\n  findLink: function () {\n    const regex = /(https?:\\/\\/[^\\s]+|www.[^\\s]+)/;\n    let link = regex.exec(this.title);\n\n    if (link == null) {\n      link = regex.exec(this.description);\n    }\n\n    if (link) {\n      return link[0];\n    }\n  }\n};\n\nmodule.exports = Card;\n","const Card = require('./Card');\nconst pubsub = require('../lib/pubsub');\nconst CONFIG = require('../config');\nconst loger = require('../lib/loger');\n\nlet CardManager = {\n  init: function () {\n    this.cards = [];\n    this.selectedCard = { id: -1 };\n    this.deletedCards = [];\n    this.pristine = 0;\n\n    return this;\n  },\n  addCard: function (card) {\n    this.cards.push(card);\n    card.id = this.cards.length - 1;\n\n    card.x = card.x + this.pristine * 10;\n    card.y = card.y + this.pristine * 10;\n\n    this.pristine++;\n\n    return card;\n  },\n  removeCard: function (id) {\n    this.cards[id].derender();\n    this.cards[id] = undefined;\n\n    return this;\n  },\n  redrawCard: function (cardId, x, y) {\n    let card = this.cards[cardId];\n    card.x = x;\n    card.y = y;\n\n    card.derender();\n    card.render();\n\n    return this;\n  },\n  saveData: function () {\n    let data = {};\n\n    if (typeof (Storage) === 'undefined') {\n      console.warn('you don\\'t have local storage :(');\n      return;\n    }\n\n    data.cards = this.cards;\n    data.selectedCardId = this.selectedCard.id;\n    data.deletedCards = this.deletedCards;\n\n    window.localStorage.setItem('cardsData', JSON.stringify(data));\n\n    loger.log(\"Data saved\");\n  },\n  loadData: function () {\n    const data = JSON.parse(window.localStorage.getItem('cardsData')) || {};\n\n    this.cards = data.cards;\n\n    if (this.cards == null) {\n      this.cards = JSON.parse(window.atob(CONFIG.DEFAULT_CONTENT));\n    }\n\n    // Load selected card\n    if (data.selectedCardId !== undefined && data.selectedCardId > -1) {\n      this.selectedCard = this.cards[data.selectedCardId];\n    }\n\n    this.clearArray();\n\n    // Load deleted cards\n    this.deletedCards = data.deletedCards || [];\n\n    document.activeElement.blur();\n\n    loger.log('Data loaded');\n  },\n  clearArray: function () {\n    let i;\n\n    this.cards = this.cards.filter(function (elem) {\n      return elem !== undefined && elem !== null;\n    });\n\n    for (i in this.cards) {\n      if (this.cards.hasOwnProperty(i)) {\n        this.cards[+i].id = +i;\n      }\n    }\n\n    return this;\n  },\n  reRenderAllCards: function () {\n    this.cards.forEach((card) => {\n      card.derender();\n    });\n\n    this.renderAllCards();\n  },\n  renderAllCards: function () {\n    this.cards.forEach((card) => {\n      card.selected = this.selectedCard && (this.selectedCard.id === card.id);\n      Object.setPrototypeOf(card, Card);\n      card.render();\n    }\n    );\n\n    return this;\n  },\n  getInstance: function () {\n    if (CardManager.instance === undefined) {\n      CardManager.instance = Object.create(CardManager, {});\n      CardManager.instance.init();\n      pubsub.sub(window.CONFIG.SAVE_CARDS, CardManager.instance.saveData, CardManager.instance);\n      pubsub.sub(window.CONFIG.SELECT_CARD, CardManager.instance.selectCard, CardManager.instance);\n      pubsub.sub(window.CONFIG.RERENDER, CardManager.instance.reRenderAllCards, CardManager.instance);\n      pubsub.sub(window.CONFIG.LESS_PRISTINE, CardManager.instance.lessPristine, CardManager.instance);\n    }\n\n    return CardManager.instance;\n  },\n  lessPristine: function () {\n    this.pristine--;\n  },\n  exportCards: function () {\n    return window.btoa(JSON.stringify(this.cards));\n  },\n  importCards: function (data) {\n    window.localStorage.setItem('cardsData', window.atob(data));\n    this.loadData();\n    this.renderAllCards();\n  },\n  selectCard: function (cardId) {\n    if (this.selectedCard !== undefined &&\n        this.selectedCard > -1 &&\n        this.selectedCard.node.classList !== undefined) {\n      this.selectedCard.node.classList.remove('selected');\n    }\n    this.selectedCard = this.cards[cardId];\n\n    this.selectedCard.node.classList.add('selected');\n\n    document.activeElement.blur();\n  },\n  nextCard: function () {\n    let it = +this.selectedCard.id + 1;\n\n    while (it !== +this.selectedCard.id) {\n      if (this.cards[it] !== undefined && this.cards[it].isDeleted !== true) {\n        break;\n      }\n      if (++it >= this.cards.length) {\n        it = 0;\n      }\n    }\n\n    this.selectCard(it);\n  },\n  previousCard: function () {\n    let it = +this.selectedCard.id - 1;\n\n    while (it !== +this.selectedCard.id) {\n      if (this.cards[it] !== undefined) {\n        break;\n      }\n      if (--it <= 0) {\n        it = this.cards.length;\n      }\n    }\n\n    this.selectCard(it);\n  },\n  deleteCard: function (card) {\n    this.deletedCards.push(card.id);\n\n    card.delete();\n  },\n  undeleteLastCard: function () {\n    if (this.deletedCards.length === 0) {\n      return;\n    }\n\n    this.selectCard(this.cards[this.deletedCards.splice(this.deletedCards.length - 1)].undelete().id);\n\n    this.saveData();\n  }\n};\n\nmodule.exports = CardManager;\n","let cardManager = require('./models/CardManager').getInstance();\n\nfunction createDiv (text, className) {\n  let div = document.createElement('div');\n  div.innerHTML = text;\n  div.style.float = 'right';\n  div.style.cursor = 'pointer';\n  div.style.width = 'auto';\n  div.style.textAlign = 'center';\n  div.style.margin = '0 3px';\n\n  if (className !== undefined) {\n    div.className = className;\n  }\n\n  return div;\n}\n\nfunction copySelectionText () {\n  let copysuccess; // let to check whether execCommand successfully executed\n  try {\n    copysuccess = document.execCommand('copy'); // run command to copy selected text to clipboard\n  } catch (e) {\n    copysuccess = false;\n  }\n  return copysuccess;\n}\n\nfunction selectText (element) {\n  let doc = document;\n  let text = element;\n  let range, selection\n    ;\n    if (doc.body.createTextRange) {\n        range = document.body.createTextRange();\n        range.moveToElementText(text);\n        range.select();\n    } else if (window.getSelection) {\n        selection = window.getSelection();\n        range = document.createRange();\n        range.selectNodeContents(text);\n        selection.removeAllRanges();\n        selection.addRange(range);\n        return selection;\n    }\n}\n\nfunction getParentCardId (context) {\n  if (context.parentElement === null) return;\n  return parseInt(context.parentElement.id.split('_')[1]);\n}\n\nfunction getSomethingByclassName (context, classname) {\n  let res = context.getElementsByClassName(classname);\n\n  if (res.length === 0) {\n    res = context.parentElement.getElementsByClassName(classname);\n  }\n\n  return res;\n}\n\nfunction changeDepth (cardId, increment) {\n  let depth = cardManager.cards[cardId].depth + increment;\n\n  this.style.zIndex = depth;\n  cardManager.cards[cardId].depth = depth;\n\n  let elem = getSomethingByclassName(this, 'depth');\n  elem[0].innerHTML = depth;\n}\n\nfunction setDepth (cardId, depth) {\n  this.style.zIndex = depth;\n  cardManager.cards[cardId].depth = depth;\n\n  let elem = getSomethingByclassName(this, 'depth');\n  elem[0].innerHTML = depth;\n}\n\nfunction getCardHTMLById(mainContainer, id) {\n    return mainContainer.getElementById('todo_' + id);\n}\n\n// PROTOTYPES\n\n/*\n * Returns the size of an array\n */\nArray.prototype.size = function () {\n  return this.filter(function (a) {\n    return a !== undefined;\n  }).length;\n};\n\n/*\n * Returns the size of an object\n */\nObject.size = function (obj) {\n  let size = 0;\n  let key = '';\n\n    for (key in obj) {\n        if (obj.hasOwnProperty(key)) size++;\n    }\n    return size;\n};\n\nmodule.exports = {\n  createDiv: createDiv,\n  copySelectionText: copySelectionText,\n  selectText: selectText,\n  getParentCardId: getParentCardId,\n  changeDepth: changeDepth,\n  setDepth: setDepth,\n  getCardHTMLById: getCardHTMLById\n};\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvbXVybXVyaGFzaC1qcy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9tdXJtdXJoYXNoLWpzL211cm11cmhhc2gyX2djLmpzIiwibm9kZV9tb2R1bGVzL211cm11cmhhc2gtanMvbXVybXVyaGFzaDNfZ2MuanMiLCJub2RlX21vZHVsZXMvcmFuZG9tLW1hdGVyaWFsLWNvbG9yL2Rpc3QvcmFuZG9tQ29sb3IuanMiLCJzcmMvanMvY29uZmlnLmpzIiwic3JjL2pzL2xpYi9rZXlIYW5kbGVyLmpzIiwic3JjL2pzL2xpYi9sb2dlci5qcyIsInNyYy9qcy9saWIvcHVic3ViLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvbW9kZWxzL0NhcmQuanMiLCJzcmMvanMvbW9kZWxzL0NhcmRNYW5hZ2VyLmpzIiwic3JjL2pzL3Byb3RvdHlwZXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRUE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeFJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ2YXIgbXVybXVyMyA9IHJlcXVpcmUoXCIuL211cm11cmhhc2gzX2djLmpzXCIpXG52YXIgbXVybXVyMiA9IHJlcXVpcmUoXCIuL211cm11cmhhc2gyX2djLmpzXCIpXG5cbm1vZHVsZS5leHBvcnRzID0gbXVybXVyM1xubW9kdWxlLmV4cG9ydHMubXVybXVyMyA9IG11cm11cjNcbm1vZHVsZS5leHBvcnRzLm11cm11cjIgPSBtdXJtdXIyXG4iLCIvKipcbiAqIEpTIEltcGxlbWVudGF0aW9uIG9mIE11cm11ckhhc2gyXG4gKiBcbiAqIEBhdXRob3IgPGEgaHJlZj1cIm1haWx0bzpnYXJ5LmNvdXJ0QGdtYWlsLmNvbVwiPkdhcnkgQ291cnQ8L2E+XG4gKiBAc2VlIGh0dHA6Ly9naXRodWIuY29tL2dhcnljb3VydC9tdXJtdXJoYXNoLWpzXG4gKiBAYXV0aG9yIDxhIGhyZWY9XCJtYWlsdG86YWFwcGxlYnlAZ21haWwuY29tXCI+QXVzdGluIEFwcGxlYnk8L2E+XG4gKiBAc2VlIGh0dHA6Ly9zaXRlcy5nb29nbGUuY29tL3NpdGUvbXVybXVyaGFzaC9cbiAqIFxuICogQHBhcmFtIHtzdHJpbmd9IHN0ciBBU0NJSSBvbmx5XG4gKiBAcGFyYW0ge251bWJlcn0gc2VlZCBQb3NpdGl2ZSBpbnRlZ2VyIG9ubHlcbiAqIEByZXR1cm4ge251bWJlcn0gMzItYml0IHBvc2l0aXZlIGludGVnZXIgaGFzaFxuICovXG5cbmZ1bmN0aW9uIG11cm11cmhhc2gyXzMyX2djKHN0ciwgc2VlZCkge1xuICB2YXJcbiAgICBsID0gc3RyLmxlbmd0aCxcbiAgICBoID0gc2VlZCBeIGwsXG4gICAgaSA9IDAsXG4gICAgaztcbiAgXG4gIHdoaWxlIChsID49IDQpIHtcbiAgXHRrID0gXG4gIFx0ICAoKHN0ci5jaGFyQ29kZUF0KGkpICYgMHhmZikpIHxcbiAgXHQgICgoc3RyLmNoYXJDb2RlQXQoKytpKSAmIDB4ZmYpIDw8IDgpIHxcbiAgXHQgICgoc3RyLmNoYXJDb2RlQXQoKytpKSAmIDB4ZmYpIDw8IDE2KSB8XG4gIFx0ICAoKHN0ci5jaGFyQ29kZUF0KCsraSkgJiAweGZmKSA8PCAyNCk7XG4gICAgXG4gICAgayA9ICgoKGsgJiAweGZmZmYpICogMHg1YmQxZTk5NSkgKyAoKCgoayA+Pj4gMTYpICogMHg1YmQxZTk5NSkgJiAweGZmZmYpIDw8IDE2KSk7XG4gICAgayBePSBrID4+PiAyNDtcbiAgICBrID0gKCgoayAmIDB4ZmZmZikgKiAweDViZDFlOTk1KSArICgoKChrID4+PiAxNikgKiAweDViZDFlOTk1KSAmIDB4ZmZmZikgPDwgMTYpKTtcblxuXHRoID0gKCgoaCAmIDB4ZmZmZikgKiAweDViZDFlOTk1KSArICgoKChoID4+PiAxNikgKiAweDViZDFlOTk1KSAmIDB4ZmZmZikgPDwgMTYpKSBeIGs7XG5cbiAgICBsIC09IDQ7XG4gICAgKytpO1xuICB9XG4gIFxuICBzd2l0Y2ggKGwpIHtcbiAgY2FzZSAzOiBoIF49IChzdHIuY2hhckNvZGVBdChpICsgMikgJiAweGZmKSA8PCAxNjtcbiAgY2FzZSAyOiBoIF49IChzdHIuY2hhckNvZGVBdChpICsgMSkgJiAweGZmKSA8PCA4O1xuICBjYXNlIDE6IGggXj0gKHN0ci5jaGFyQ29kZUF0KGkpICYgMHhmZik7XG4gICAgICAgICAgaCA9ICgoKGggJiAweGZmZmYpICogMHg1YmQxZTk5NSkgKyAoKCgoaCA+Pj4gMTYpICogMHg1YmQxZTk5NSkgJiAweGZmZmYpIDw8IDE2KSk7XG4gIH1cblxuICBoIF49IGggPj4+IDEzO1xuICBoID0gKCgoaCAmIDB4ZmZmZikgKiAweDViZDFlOTk1KSArICgoKChoID4+PiAxNikgKiAweDViZDFlOTk1KSAmIDB4ZmZmZikgPDwgMTYpKTtcbiAgaCBePSBoID4+PiAxNTtcblxuICByZXR1cm4gaCA+Pj4gMDtcbn1cblxuaWYodHlwZW9mIG1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG4gIG1vZHVsZS5leHBvcnRzID0gbXVybXVyaGFzaDJfMzJfZ2Ncbn1cbiIsIi8qKlxuICogSlMgSW1wbGVtZW50YXRpb24gb2YgTXVybXVySGFzaDMgKHIxMzYpIChhcyBvZiBNYXkgMjAsIDIwMTEpXG4gKiBcbiAqIEBhdXRob3IgPGEgaHJlZj1cIm1haWx0bzpnYXJ5LmNvdXJ0QGdtYWlsLmNvbVwiPkdhcnkgQ291cnQ8L2E+XG4gKiBAc2VlIGh0dHA6Ly9naXRodWIuY29tL2dhcnljb3VydC9tdXJtdXJoYXNoLWpzXG4gKiBAYXV0aG9yIDxhIGhyZWY9XCJtYWlsdG86YWFwcGxlYnlAZ21haWwuY29tXCI+QXVzdGluIEFwcGxlYnk8L2E+XG4gKiBAc2VlIGh0dHA6Ly9zaXRlcy5nb29nbGUuY29tL3NpdGUvbXVybXVyaGFzaC9cbiAqIFxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBBU0NJSSBvbmx5XG4gKiBAcGFyYW0ge251bWJlcn0gc2VlZCBQb3NpdGl2ZSBpbnRlZ2VyIG9ubHlcbiAqIEByZXR1cm4ge251bWJlcn0gMzItYml0IHBvc2l0aXZlIGludGVnZXIgaGFzaCBcbiAqL1xuXG5mdW5jdGlvbiBtdXJtdXJoYXNoM18zMl9nYyhrZXksIHNlZWQpIHtcblx0dmFyIHJlbWFpbmRlciwgYnl0ZXMsIGgxLCBoMWIsIGMxLCBjMWIsIGMyLCBjMmIsIGsxLCBpO1xuXHRcblx0cmVtYWluZGVyID0ga2V5Lmxlbmd0aCAmIDM7IC8vIGtleS5sZW5ndGggJSA0XG5cdGJ5dGVzID0ga2V5Lmxlbmd0aCAtIHJlbWFpbmRlcjtcblx0aDEgPSBzZWVkO1xuXHRjMSA9IDB4Y2M5ZTJkNTE7XG5cdGMyID0gMHgxYjg3MzU5Mztcblx0aSA9IDA7XG5cdFxuXHR3aGlsZSAoaSA8IGJ5dGVzKSB7XG5cdCAgXHRrMSA9IFxuXHQgIFx0ICAoKGtleS5jaGFyQ29kZUF0KGkpICYgMHhmZikpIHxcblx0ICBcdCAgKChrZXkuY2hhckNvZGVBdCgrK2kpICYgMHhmZikgPDwgOCkgfFxuXHQgIFx0ICAoKGtleS5jaGFyQ29kZUF0KCsraSkgJiAweGZmKSA8PCAxNikgfFxuXHQgIFx0ICAoKGtleS5jaGFyQ29kZUF0KCsraSkgJiAweGZmKSA8PCAyNCk7XG5cdFx0KytpO1xuXHRcdFxuXHRcdGsxID0gKCgoKGsxICYgMHhmZmZmKSAqIGMxKSArICgoKChrMSA+Pj4gMTYpICogYzEpICYgMHhmZmZmKSA8PCAxNikpKSAmIDB4ZmZmZmZmZmY7XG5cdFx0azEgPSAoazEgPDwgMTUpIHwgKGsxID4+PiAxNyk7XG5cdFx0azEgPSAoKCgoazEgJiAweGZmZmYpICogYzIpICsgKCgoKGsxID4+PiAxNikgKiBjMikgJiAweGZmZmYpIDw8IDE2KSkpICYgMHhmZmZmZmZmZjtcblxuXHRcdGgxIF49IGsxO1xuICAgICAgICBoMSA9IChoMSA8PCAxMykgfCAoaDEgPj4+IDE5KTtcblx0XHRoMWIgPSAoKCgoaDEgJiAweGZmZmYpICogNSkgKyAoKCgoaDEgPj4+IDE2KSAqIDUpICYgMHhmZmZmKSA8PCAxNikpKSAmIDB4ZmZmZmZmZmY7XG5cdFx0aDEgPSAoKChoMWIgJiAweGZmZmYpICsgMHg2YjY0KSArICgoKChoMWIgPj4+IDE2KSArIDB4ZTY1NCkgJiAweGZmZmYpIDw8IDE2KSk7XG5cdH1cblx0XG5cdGsxID0gMDtcblx0XG5cdHN3aXRjaCAocmVtYWluZGVyKSB7XG5cdFx0Y2FzZSAzOiBrMSBePSAoa2V5LmNoYXJDb2RlQXQoaSArIDIpICYgMHhmZikgPDwgMTY7XG5cdFx0Y2FzZSAyOiBrMSBePSAoa2V5LmNoYXJDb2RlQXQoaSArIDEpICYgMHhmZikgPDwgODtcblx0XHRjYXNlIDE6IGsxIF49IChrZXkuY2hhckNvZGVBdChpKSAmIDB4ZmYpO1xuXHRcdFxuXHRcdGsxID0gKCgoazEgJiAweGZmZmYpICogYzEpICsgKCgoKGsxID4+PiAxNikgKiBjMSkgJiAweGZmZmYpIDw8IDE2KSkgJiAweGZmZmZmZmZmO1xuXHRcdGsxID0gKGsxIDw8IDE1KSB8IChrMSA+Pj4gMTcpO1xuXHRcdGsxID0gKCgoazEgJiAweGZmZmYpICogYzIpICsgKCgoKGsxID4+PiAxNikgKiBjMikgJiAweGZmZmYpIDw8IDE2KSkgJiAweGZmZmZmZmZmO1xuXHRcdGgxIF49IGsxO1xuXHR9XG5cdFxuXHRoMSBePSBrZXkubGVuZ3RoO1xuXG5cdGgxIF49IGgxID4+PiAxNjtcblx0aDEgPSAoKChoMSAmIDB4ZmZmZikgKiAweDg1ZWJjYTZiKSArICgoKChoMSA+Pj4gMTYpICogMHg4NWViY2E2YikgJiAweGZmZmYpIDw8IDE2KSkgJiAweGZmZmZmZmZmO1xuXHRoMSBePSBoMSA+Pj4gMTM7XG5cdGgxID0gKCgoKGgxICYgMHhmZmZmKSAqIDB4YzJiMmFlMzUpICsgKCgoKGgxID4+PiAxNikgKiAweGMyYjJhZTM1KSAmIDB4ZmZmZikgPDwgMTYpKSkgJiAweGZmZmZmZmZmO1xuXHRoMSBePSBoMSA+Pj4gMTY7XG5cblx0cmV0dXJuIGgxID4+PiAwO1xufVxuXG5pZih0eXBlb2YgbW9kdWxlICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gIG1vZHVsZS5leHBvcnRzID0gbXVybXVyaGFzaDNfMzJfZ2Ncbn0iLCJ2YXIgZGVmYXVsdFBhbGV0dGU9ezUwOltcIiNGRkVCRUVcIixcIiNGQ0U0RUNcIixcIiNGM0U1RjVcIixcIiNFREU3RjZcIixcIiNFOEVBRjZcIixcIiNFM0YyRkRcIixcIiNFMUY1RkVcIixcIiNFMEY3RkFcIixcIiNFMEYyRjFcIixcIiNFOEY1RTlcIixcIiNGMUY4RTlcIixcIiNGOUZCRTdcIixcIiNGRkZERTdcIixcIiNGRkY4RTFcIixcIiNGRkYzRTBcIixcIiNGQkU5RTdcIixcIiNFRkVCRTlcIixcIiNGQUZBRkFcIixcIiNFQ0VGRjFcIl0sMTAwOltcIiNGRkNERDJcIixcIiNGOEJCRDBcIixcIiNFMUJFRTdcIixcIiNEMUM0RTlcIixcIiNDNUNBRTlcIixcIiNCQkRFRkJcIixcIiNCM0U1RkNcIixcIiNCMkVCRjJcIixcIiNCMkRGREJcIixcIiNDOEU2QzlcIixcIiNEQ0VEQzhcIixcIiNGMEY0QzNcIixcIiNGRkY5QzRcIixcIiNGRkVDQjNcIixcIiNGRkUwQjJcIixcIiNGRkNDQkNcIixcIiNEN0NDQzhcIixcIiNGNUY1RjVcIixcIiNDRkQ4RENcIl0sMjAwOltcIiNFRjlBOUFcIixcIiNGNDhGQjFcIixcIiNDRTkzRDhcIixcIiNCMzlEREJcIixcIiM5RkE4REFcIixcIiM5MENBRjlcIixcIiM4MUQ0RkFcIixcIiM4MERFRUFcIixcIiM4MENCQzRcIixcIiNBNUQ2QTdcIixcIiNDNUUxQTVcIixcIiNFNkVFOUNcIixcIiNGRkY1OURcIixcIiNGRkUwODJcIixcIiNGRkNDODBcIixcIiNGRkFCOTFcIixcIiNCQ0FBQTRcIixcIiNFRUVFRUVcIixcIiNCMEJFQzVcIl0sMzAwOltcIiNFNTczNzNcIixcIiNGMDYyOTJcIixcIiNCQTY4QzhcIixcIiM5NTc1Q0RcIixcIiM3OTg2Q0JcIixcIiM2NEI1RjZcIixcIiM0RkMzRjdcIixcIiM0REQwRTFcIixcIiM0REI2QUNcIixcIiM4MUM3ODRcIixcIiNBRUQ1ODFcIixcIiNEQ0U3NzVcIixcIiNGRkYxNzZcIixcIiNGRkQ1NEZcIixcIiNGRkI3NERcIixcIiNGRjhBNjVcIixcIiNBMTg4N0ZcIixcIiNFMEUwRTBcIixcIiM5MEE0QUVcIl0sNDAwOltcIiNFRjUzNTBcIixcIiNFQzQwN0FcIixcIiNBQjQ3QkNcIixcIiM3RTU3QzJcIixcIiM1QzZCQzBcIixcIiM0MkE1RjVcIixcIiMyOUI2RjZcIixcIiMyNkM2REFcIixcIiMyNkE2OUFcIixcIiM2NkJCNkFcIixcIiM5Q0NDNjVcIixcIiNENEUxNTdcIixcIiNGRkVFNThcIixcIiNGRkNBMjhcIixcIiNGRkE3MjZcIixcIiNGRjcwNDNcIixcIiM4RDZFNjNcIixcIiNCREJEQkRcIixcIiM3ODkwOUNcIl0sNTAwOltcIiNGNDQzMzZcIixcIiNFOTFFNjNcIixcIiM5QzI3QjBcIixcIiM2NzNBQjdcIixcIiMzRjUxQjVcIixcIiMyMTk2RjNcIixcIiMwM0E5RjRcIixcIiMwMEJDRDRcIixcIiMwMDk2ODhcIixcIiM0Q0FGNTBcIixcIiM4QkMzNEFcIixcIiNDRERDMzlcIixcIiNGRkVCM0JcIixcIiNGRkMxMDdcIixcIiNGRjk4MDBcIixcIiNGRjU3MjJcIixcIiM3OTU1NDhcIixcIiM5RTlFOUVcIixcIiM2MDdEOEJcIl0sNjAwOltcIiNFNTM5MzVcIixcIiNEODFCNjBcIixcIiM4RTI0QUFcIixcIiM1RTM1QjFcIixcIiMzOTQ5QUJcIixcIiMxRTg4RTVcIixcIiMwMzlCRTVcIixcIiMwMEFDQzFcIixcIiMwMDg5N0JcIixcIiM0M0EwNDdcIixcIiM3Q0IzNDJcIixcIiNDMENBMzNcIixcIiNGREQ4MzVcIixcIiNGRkIzMDBcIixcIiNGQjhDMDBcIixcIiNGNDUxMUVcIixcIiM2RDRDNDFcIixcIiM3NTc1NzVcIixcIiM1NDZFN0FcIl0sNzAwOltcIiNEMzJGMkZcIixcIiNDMjE4NUJcIixcIiM3QjFGQTJcIixcIiM1MTJEQThcIixcIiMzMDNGOUZcIixcIiMxOTc2RDJcIixcIiMwMjg4RDFcIixcIiMwMDk3QTdcIixcIiMwMDc5NkJcIixcIiMzODhFM0NcIixcIiM2ODlGMzhcIixcIiNBRkI0MkJcIixcIiNGQkMwMkRcIixcIiNGRkEwMDBcIixcIiNGNTdDMDBcIixcIiNFNjRBMTlcIixcIiM1RDQwMzdcIixcIiM2MTYxNjFcIixcIiM0NTVBNjRcIl0sODAwOltcIiNDNjI4MjhcIixcIiNBRDE0NTdcIixcIiM2QTFCOUFcIixcIiM0NTI3QTBcIixcIiMyODM1OTNcIixcIiMxNTY1QzBcIixcIiMwMjc3QkRcIixcIiMwMDgzOEZcIixcIiMwMDY5NUNcIixcIiMyRTdEMzJcIixcIiM1NThCMkZcIixcIiM5RTlEMjRcIixcIiNGOUE4MjVcIixcIiNGRjhGMDBcIixcIiNFRjZDMDBcIixcIiNEODQzMTVcIixcIiM0RTM0MkVcIixcIiM0MjQyNDJcIixcIiMzNzQ3NEZcIl0sOTAwOltcIiNCNzFDMUNcIixcIiM4ODBFNEZcIixcIiM0QTE0OENcIixcIiMzMTFCOTJcIixcIiMxQTIzN0VcIixcIiMwRDQ3QTFcIixcIiMwMTU3OUJcIixcIiMwMDYwNjRcIixcIiMwMDRENDBcIixcIiMxQjVFMjBcIixcIiMzMzY5MUVcIixcIiM4Mjc3MTdcIixcIiNGNTdGMTdcIixcIiNGRjZGMDBcIixcIiNFNjUxMDBcIixcIiNCRjM2MENcIixcIiMzRTI3MjNcIixcIiMyMTIxMjFcIixcIiMyNjMyMzhcIl0sQTEwMDpbXCIjRkY4QTgwXCIsXCIjRkY4MEFCXCIsXCIjRUE4MEZDXCIsXCIjQjM4OEZGXCIsXCIjOEM5RUZGXCIsXCIjODJCMUZGXCIsXCIjODBEOEZGXCIsXCIjODRGRkZGXCIsXCIjQTdGRkVCXCIsXCIjQjlGNkNBXCIsXCIjQ0NGRjkwXCIsXCIjRjRGRjgxXCIsXCIjRkZGRjhEXCIsXCIjRkZFNTdGXCIsXCIjRkZEMTgwXCIsXCIjRkY5RTgwXCJdLEEyMDA6W1wiI0ZGNTI1MlwiLFwiI0ZGNDA4MVwiLFwiI0UwNDBGQlwiLFwiIzdDNERGRlwiLFwiIzUzNkRGRVwiLFwiIzQ0OEFGRlwiLFwiIzQwQzRGRlwiLFwiIzE4RkZGRlwiLFwiIzY0RkZEQVwiLFwiIzY5RjBBRVwiLFwiI0IyRkY1OVwiLFwiI0VFRkY0MVwiLFwiI0ZGRkYwMFwiLFwiI0ZGRDc0MFwiLFwiI0ZGQUI0MFwiLFwiI0ZGNkU0MFwiXSxBNDAwOltcIiNGRjE3NDRcIixcIiNGNTAwNTdcIixcIiNENTAwRjlcIixcIiM2NTFGRkZcIixcIiMzRDVBRkVcIixcIiMyOTc5RkZcIixcIiMwMEIwRkZcIixcIiMwMEU1RkZcIixcIiMxREU5QjZcIixcIiMwMEU2NzZcIixcIiM3NkZGMDNcIixcIiNDNkZGMDBcIixcIiNGRkVBMDBcIixcIiNGRkM0MDBcIixcIiNGRjkxMDBcIixcIiNGRjNEMDBcIl0sQTcwMDpbXCIjRDUwMDAwXCIsXCIjQzUxMTYyXCIsXCIjQUEwMEZGXCIsXCIjNjIwMEVBXCIsXCIjMzA0RkZFXCIsXCIjMjk2MkZGXCIsXCIjMDA5MUVBXCIsXCIjMDBCOEQ0XCIsXCIjMDBCRkE1XCIsXCIjMDBDODUzXCIsXCIjNjRERDE3XCIsXCIjQUVFQTAwXCIsXCIjRkZENjAwXCIsXCIjRkZBQjAwXCIsXCIjRkY2RDAwXCIsXCIjREQyQzAwXCJdfSxtdXJtdXI9cmVxdWlyZShcIm11cm11cmhhc2gtanNcIik7bW9kdWxlLmV4cG9ydHM9ZnVuY3Rpb24oKXt2YXIgRj1bXSxFPXtzaGFkZXM6W1wiNTAwXCJdLHBhbGV0dGU6ZGVmYXVsdFBhbGV0dGUsdGV4dDpudWxsLGlnbm9yZUNvbG9yczpbXX0sQz1mdW5jdGlvbihDKXtDfHwoQz1FKSxDLnBhbGV0dGV8fChDLnBhbGV0dGU9ZGVmYXVsdFBhbGV0dGUpLEMuc2hhZGVzfHwoQy5zaGFkZXM9W1wiNTAwXCJdKTtmb3IodmFyIEIsRD1GLmxlbmd0aCx0PTA7RD50O3QrKylpZihDLnRleHQmJkZbdF0udGV4dD09PUMudGV4dClyZXR1cm4gRlt0XS5jb2xvcjtyZXR1cm4gQj1BKEMpLEMudGV4dCYmRi5wdXNoKHt0ZXh0OkMudGV4dCxjb2xvcjpCfSksQn0sQT1mdW5jdGlvbihGKXt2YXIgRT1GLnNoYWRlc1tCKEYuc2hhZGVzLmxlbmd0aCldLEM9XCJcIjtmb3IodmFyIEEgaW4gRi5wYWxldHRlKUYucGFsZXR0ZS5oYXNPd25Qcm9wZXJ0eShBKSYmQT09PUUmJihDPUYudGV4dD9GLnBhbGV0dGVbQV1bRChGLnRleHQsRi5wYWxldHRlW0FdLmxlbmd0aCldOkYucGFsZXR0ZVtBXVtCKEYucGFsZXR0ZVtBXS5sZW5ndGgpXSk7cmV0dXJuIEN9LEI9ZnVuY3Rpb24oRil7cmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSpGKX0sRD1mdW5jdGlvbihGLEUpe3ZhciBDPW11cm11ci5tdXJtdXIzKEYpLzFlMTA7cmV0dXJuLjE+QyYmKEM9MTAqQyksTWF0aC5mbG9vcihDKkUpfTtyZXR1cm57Z2V0Q29sb3I6Q319KCk7IiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIFNBVkVfQ0FSRFM6ICdTQVZFX0NBUkRTJyxcbiAgU0VMRUNUX0NBUkQ6ICdTRUxFQ1RfQ0FSRCcsXG4gIFJFUkVOREVSOiAnUkVSRU5ERVInLFxuICBMRVNTX1BSSVNUSU5FOiAnTEVTU19QUklTVElORScsXG4gIEFTQ0lJOiB7XG4gICAgRVNDQVBFX0tFWTogMjcsXG4gICAgVEFCX0tFWTogOSxcbiAgICBDX0tFWTogNjcsXG4gICAgRF9LRVk6IDY4LFxuICAgIEVfS0VZOiA2OSxcbiAgICBQTFVTX0tFWTogMTg3LFxuICAgIE1JTlVTX0tFWTogMTg5LFxuICAgIERPVF9LRVk6IDE5MCxcbiAgICBBX0tFWTogNjUsXG4gICAgSV9LRVk6IDczLFxuICAgIFJfS0VZOiA4MixcbiAgICBaX0tFWTogOTAsXG4gICAgQ01EX0tFWTogOTEsXG4gICAgS0VZU19BUlJBWTogWzI3LCA5LCA2NywgNjgsIDY5LCAxODcsIDE4OSwgMTkwLCA2NSwgNzMsIDgyLCA5MCwgOTFdXG4gIH0sXG4gIERFRkFVTFRfQ09OVEVOVDogJ1czc2lhV1FpT2pBc0luUnBkR3hsSWpvaU1TSXNJbVJsYzJOeWFYQjBhVzl1SWpvaVZYTmxJSFJoWWlCaGJtUWdjMmhwWm5RZ2RHRmlJSFJ2SUdOcGNtTnNaU0JpWlhSM1pXVnVJR05oY21SeklEcEVYRzVjYmtSeVlXZG5hVzVuSUc5eUlHTnNhV05yYVc1bklIUm9aVzBnZDJsc2JDQmhiSE52SUcxaGNtc2dkR2hsYlNCaGN5QnpaV3hsWTNSbFpDSXNJbVJsY0hSb0lqbzFMQ0o0SWpveE5qa3NJbmtpT2pjNUxDSmpiMnh2Y2lJNklpTkJOVVEyUVRjaUxDSnpaV3hsWTNSbFpDSTZkSEoxWlN3aWFYTkJjbU5vYVhabFpDSTZabUZzYzJVc0ltbHpSR1ZzWlhSbFpDSTZabUZzYzJVc0ltTnlaV0YwWldSQmRDSTZNVFV3TnpZME5qYzFPREU0Tml3aVlYSmphR2wyWldSQmRDSTZiblZzYkN3aWJtOWtaU0k2ZXlKcVVYVmxjbmt4TnpJd05ESTBOekU0TVRnMU56RXlPVFkwTURVaU9qUjlmU3g3SW1sa0lqb3hMQ0owYVhSc1pTSTZJaklpTENKa1pYTmpjbWx3ZEdsdmJpSTZJazl1SUdFZ2JXRnlhMlZrSUdOaGNtUWdkWE5sSUdOMGNtd2dLenBjYmlkakp5QjBieUJqYjNCNUlIUm9aU0JqYjI1MFpXNTBYRzRuWkNjZ2RHOGdaR1ZzWlhSbElHbDBYRzRuWlNjZ2RHOGdaV1JwZENCcGRGeHVKMkVuSUhSdklHRnlZMmhwZG1VZ2IzSWdaR1ZoY21Ob2FYWmxJR1JsSUdOaGNtUWlMQ0prWlhCMGFDSTZOU3dpZUNJNk16Z3lMQ0o1SWpvM05pd2lZMjlzYjNJaU9pSWpRVVZFTlRneElpd2ljMlZzWldOMFpXUWlPbVpoYkhObExDSnBjMEZ5WTJocGRtVmtJanBtWVd4elpTd2lhWE5FWld4bGRHVmtJanBtWVd4elpTd2lZM0psWVhSbFpFRjBJam94TlRBM05qUTJOemN4TnpRd0xDSmhjbU5vYVhabFpFRjBJanB1ZFd4c0xDSnViMlJsSWpwN0ltcFJkV1Z5ZVRFM01qQTBNalEzTVRneE9EVTNNVEk1TmpRd05TSTZPSDE5TEhzaWFXUWlPaklzSW5ScGRHeGxJam9pWlc1MFpYSnpJaXdpWkdWelkzSnBjSFJwYjI0aU9pSlhhR2xzWlNCbFpHbDBhVzVuSUhWelpTQnphR2xtZENBcklHVnVkR1Z5SUhSdklGeHVhVzV6WlhKMFhHNWhYRzVzYVc1bFhHNWljbVZoYTF4dU9rUWlMQ0prWlhCMGFDSTZOU3dpZUNJNk1UVTVMQ0o1SWpvek1USXNJbU52Ykc5eUlqb2lJMFpHUWpjMFJDSXNJbk5sYkdWamRHVmtJanBtWVd4elpTd2lhWE5CY21Ob2FYWmxaQ0k2Wm1Gc2MyVXNJbWx6UkdWc1pYUmxaQ0k2Wm1Gc2MyVXNJbU55WldGMFpXUkJkQ0k2TVRVd056WTBOamM1TWpJNU55d2lZWEpqYUdsMlpXUkJkQ0k2Ym5Wc2JDd2libTlrWlNJNmV5SnFVWFZsY25reE56SXdOREkwTnpFNE1UZzFOekV5T1RZME1EVWlPalo5ZlN4N0ltbGtJam96TENKMGFYUnNaU0k2SWtkbGJtVnlhV01pTENKa1pYTmpjbWx3ZEdsdmJpSTZJbGx2ZFNCallXNGdZV3h6YnlCMWMyVWdaMlZ1WlhKcFl5QmpiMjF0WVc1a2N5QnpkV05vSUdGeklHTjBjbXdyWEc0bmFTY2dkRzhnWTNKbFlYUmxJR0VnWTJGeVpGeHVKM29uSUhSdklISmxkbWwyWlNCMGFHVWdiR0Z6ZENCa1pXeGxkR1ZrSUdOaGNtUWlMQ0prWlhCMGFDSTZOU3dpZUNJNk5EUXhMQ0o1SWpveU9UWXNJbU52Ykc5eUlqb2lJMFpHUlRBNE1pSXNJbk5sYkdWamRHVmtJanBtWVd4elpTd2lhWE5CY21Ob2FYWmxaQ0k2Wm1Gc2MyVXNJbWx6UkdWc1pYUmxaQ0k2Wm1Gc2MyVXNJbU55WldGMFpXUkJkQ0k2TVRVd056WTBPRFl6T0RNNE5pd2lZWEpqYUdsMlpXUkJkQ0k2Ym5Wc2JDd2lhWE5RY21semRHbHVaU0k2Wm1Gc2MyVXNJbTV2WkdVaU9uc2lhbEYxWlhKNU1UY3lNRFF5TkRjeE9ERTROVGN4TWprMk5EQTFJam94TUgxOVhRJyxcbiAgVkVSU0lPTjogJzAuNS4wJ1xufTtcbiIsImNvbnN0IENPTkZJRyA9IHJlcXVpcmUoJy4uL2NvbmZpZycpO1xuXG5sZXQgY2FyZE1hbmFnZXI7XG5sZXQgQ2FyZCA9IHJlcXVpcmUoJy4uL21vZGVscy9DYXJkJyk7XG5cbmxldCBtYWluQ29udGFpbmVyLFxuICBlZGl0Q29udGFpbmVyLFxuICBlZGl0SW5wdXQsXG4gIHRpdGxlSW5wdXQsXG4gIGltcG9ydENvbnRhaW5lcixcbiAgaW1wb3J0SW5wdXQsXG4gIGV4cG9ydENvbnRhaW5lcixcbiAgZXhwb3J0Q29udGVudCxcbiAgaW1wb3J0QnV0dG9uO1xuXG5mdW5jdGlvbiBpbml0IChvcHRpb25zKSB7XG4gIGNhcmRNYW5hZ2VyID0gb3B0aW9ucy5jYXJkTWFuYWdlcjtcbiAgYmluZGluZ3MoKTtcbn1cblxuZnVuY3Rpb24gYmluZGluZ3MgKCkge1xuICBtYWluQ29udGFpbmVyID0gJCgnI21haW5Db250YWluZXInKTtcbiAgZWRpdENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0Q29udGFpbmVyJyk7XG4gIGVkaXRJbnB1dCA9IGVkaXRDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGV4dGFyZWEnKVswXTtcbiAgdGl0bGVJbnB1dCA9IGVkaXRDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnaW5wdXQnKVswXTtcbiAgaW1wb3J0Q29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ltcG9ydENvbnRhaW5lcicpO1xuICBpbXBvcnRJbnB1dCA9IGltcG9ydENvbnRhaW5lci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdpbnB1dCcpWzBdO1xuICBpbXBvcnRCdXR0b24gPSBpbXBvcnRDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnV0dG9uJylbMF07XG4gIGV4cG9ydENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHBvcnRDb250YWluZXInKTtcbiAgZXhwb3J0Q29udGVudCA9IGV4cG9ydENvbnRhaW5lci5nZXRFbGVtZW50c0J5VGFnTmFtZSgnZGl2JylbMF07XG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywga2V5SGFuZGxlclVwLCBmYWxzZSk7XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywga2V5SGFuZGxlckRvd24sIGZhbHNlKTtcbiAgZWRpdElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlZGl0SW5wdXRLZXlFdmVudCk7XG4gIHRpdGxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGVkaXRJbnB1dEtleUV2ZW50KTtcbiAgZWRpdENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhpZGVFZGl0Q29udGFpbmVyKTtcbiAgZWRpdElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3RvcFByb3BhZ2F0aW9uKTtcbiAgdGl0bGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN0b3BQcm9wYWdhdGlvbik7XG4gIC8qXG4gICAgIE9uIGRvdWJsZSBjbGljayBlZGl0IHRoZSBjYXJkXG4gICAgICovXG4gIG1haW5Db250YWluZXIub24oJ2RibGNsaWNrJywgJ2RpdicsIGRvdWJsZUNsaWNrSGFuZGxlcik7XG4gIC8qXG4gICAgIE9uIGNsaWNrIHBlcmZvcm0gdGhlIGNhcmRcbiAgICAgKi9cbiAgbWFpbkNvbnRhaW5lci5vbignY2xpY2snLCAnZGl2JywgY2FyZENsaWNrRXZlbnRzKTtcbiAgbWFpbkNvbnRhaW5lci5vbignY2xpY2snLCAnZGl2ID4gZGl2JywgY2FyZE1lbnVFdmVudHMpO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBleHBvcnRDYXJkcyk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbXBvcnQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNob3dJbXBvcnRlcik7XG4gIGltcG9ydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGxvYWRJbXBvcnRDYXJkc0NvZGUpO1xuICBpbXBvcnRDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoaWRlSW1wb3J0Q29udGFpbmVyKTtcbiAgaW1wb3J0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGltcG9ydElucHV0S2V5RXZlbnQpO1xuICBpbXBvcnRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN0b3BQcm9wYWdhdGlvbik7XG4gIGV4cG9ydENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhpZGVFeHBvcnRDb250YWluZXIpO1xuICBleHBvcnRDb250ZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3RvcFByb3BhZ2F0aW9uKTtcbn1cblxuZnVuY3Rpb24ga2V5SGFuZGxlckRvd24gKGUpIHtcbiAgaWYgKGUua2V5Q29kZSA9PT0gQ09ORklHLkFTQ0lJLlRBQl9LRVkpIHtcbiAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTtcbiAgICBpZiAoZS5zaGlmdEtleSkge1xuICAgICAgY2FyZE1hbmFnZXIucHJldmlvdXNDYXJkKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNhcmRNYW5hZ2VyLm5leHRDYXJkKCk7XG4gICAgfVxuICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gQ09ORklHLkFTQ0lJLkNNRF9LRVkpIHtcbiAgICB3aW5kb3cuY21kUHJlc3MgPSB0cnVlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGtleUhhbmRsZXJVcCAoZSkge1xuICBjb25zb2xlLmxvZyhlLmtleUNvZGUpO1xuICBjb25zb2xlLmxvZyhkb2N1bWVudC5hY3RpdmVFbGVtZW50KTtcbiAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgIT09IGRvY3VtZW50LmJvZHkgfHwgQ09ORklHLkFTQ0lJLktFWVNfQVJSQVkuaW5kZXhPZihlLmtleUNvZGUpID09PSAtMSkge1xuICAgIHJldHVybjtcbiAgfVxuICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgc3dpdGNoIChlLmtleUNvZGUpIHtcbiAgICBjYXNlIENPTkZJRy5BU0NJSS5DX0tFWTpcbiAgICAgIGxldCBlbGVtID0gY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLm5vZGU7XG4gICAgICBsZXQgc2VsZWN0aW9uO1xuXG4gICAgICBzZWxlY3Rpb24gPSBzZWxlY3RUZXh0KGVsZW0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY2FyZFRleHQnKVswXSk7XG4gICAgICBjb3B5U2VsZWN0aW9uVGV4dCgpO1xuICAgICAgc2VsZWN0aW9uLmVtcHR5KCk7XG5cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgQ09ORklHLkFTQ0lJLkRfS0VZOlxuICAgICAgbGV0IGNhcmQgPSBjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQ7XG4gICAgICBjYXJkTWFuYWdlci5uZXh0Q2FyZCgpO1xuICAgICAgY2FyZE1hbmFnZXIuZGVsZXRlQ2FyZChjYXJkKTtcbiAgICAgIGNhcmRNYW5hZ2VyLnNhdmVEYXRhKCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIENPTkZJRy5BU0NJSS5FX0tFWTpcbiAgICAgIGRvdWJsZUNsaWNrSGFuZGxlci5hcHBseShjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQubm9kZSk7XG5cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgQ09ORklHLkFTQ0lJLkFfS0VZOlxuICAgICAgY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLnRvZ2dsZUFyY2hpdmVkKCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIENPTkZJRy5BU0NJSS5JX0tFWTpcbiAgICAgIC8vIGlucHV0LmZvY3VzKCk7XG4gICAgICBjcmVhdGVDYXJkKCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIENPTkZJRy5BU0NJSS5QTFVTX0tFWTpcbiAgICAgIGNoYW5nZURlcHRoLmFwcGx5KGNhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5ub2RlLCBbY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLmlkLCAxXSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIENPTkZJRy5BU0NJSS5NSU5VU19LRVk6XG4gICAgICBjaGFuZ2VEZXB0aC5hcHBseShjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQubm9kZSwgW2NhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5pZCwgLTFdKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgQ09ORklHLkFTQ0lJLkRPVF9LRVk6XG4gICAgICBzZXREZXB0aC5hcHBseShjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQubm9kZSwgW2NhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5pZCwgNV0pO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBDT05GSUcuQVNDSUkuUl9LRVk6XG4gICAgICBjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQuY29sb3IgPSBjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQuZ2V0QmFja2dyb3VuZENvbG9yKCk7XG4gICAgICBjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQuZGVyZW5kZXIoKTtcbiAgICAgIGNhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5yZW5kZXIoKTtcblxuICAgICAgY2FyZE1hbmFnZXIuc2F2ZURhdGEoKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgQ09ORklHLkFTQ0lJLlpfS0VZOlxuICAgICAgY2FyZE1hbmFnZXIudW5kZWxldGVMYXN0Q2FyZCgpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBDT05GSUcuQVNDSUkuQ01EX0tFWTpcbiAgICAgIHdpbmRvdy5jbWRQcmVzcyA9IGZhbHNlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhpZGVFeHBvcnRDb250YWluZXIgKCkge1xuICBleHBvcnRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbn1cblxuZnVuY3Rpb24gaGlkZUVkaXRDb250YWluZXIgKCkge1xuICBlZGl0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG59XG5cbmZ1bmN0aW9uIGhpZGVJbXBvcnRDb250YWluZXIgKCkge1xuICBpbXBvcnRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbn1cblxuZnVuY3Rpb24gc3RvcFByb3BhZ2F0aW9uIChlKSB7XG4gIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG59XG5cbmZ1bmN0aW9uIGVkaXRJbnB1dEtleUV2ZW50IChldmVudCkge1xuICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgbGV0IGNhcmQ7XG4gIGlmIChldmVudC5rZXlDb2RlID09PSAxMyAmJiBldmVudC5zaGlmdEtleSkgcmV0dXJuO1xuICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcbiAgICBjYXJkID0gY2FyZE1hbmFnZXIuY2FyZHNbZWRpdENvbnRhaW5lci5jYXJkSWRdO1xuICAgIGNhcmQudGl0bGUgPSB0aXRsZUlucHV0LnZhbHVlO1xuICAgIGNhcmQuZGVzY3JpcHRpb24gPSBlZGl0SW5wdXQudmFsdWU7XG4gICAgY2FyZC5kZXJlbmRlcigpO1xuICAgIGNhcmQucmVuZGVyKCk7XG4gICAgdGhpcy52YWx1ZSA9ICcnO1xuICAgIGNhcmRNYW5hZ2VyLnNhdmVEYXRhKCk7XG4gICAgaGlkZUVkaXRDb250YWluZXIoKTtcbiAgfSBlbHNlIGlmIChldmVudC5rZXlDb2RlID09PSAyNykge1xuICAgIGhpZGVFZGl0Q29udGFpbmVyKCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW1wb3J0SW5wdXRLZXlFdmVudCAoZXZlbnQpIHtcbiAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDI3KSB7XG4gICAgaGlkZUltcG9ydENvbnRhaW5lcigpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGRvdWJsZUNsaWNrSGFuZGxlciAoKSB7XG4gIGxldCBjYXJkSWQ7XG4gIGxldCBjYXJkO1xuXG4gIGlmICh0aGlzLmlkID09PSAnJykge1xuICAgIGNhcmRJZCA9IHBhcnNlSW50KHRoaXMucGFyZW50RWxlbWVudC5pZC5zcGxpdCgnXycpWzFdKTtcbiAgfSBlbHNlIHtcbiAgICBjYXJkSWQgPSBwYXJzZUludCh0aGlzLmlkLnNwbGl0KCdfJylbMV0pO1xuICB9XG5cbiAgY2FyZCA9IGNhcmRNYW5hZ2VyLmNhcmRzW2NhcmRJZF07XG5cbiAgdGl0bGVJbnB1dC52YWx1ZSA9IGNhcmQudGl0bGU7XG4gIGVkaXRJbnB1dC52YWx1ZSA9IGNhcmQuZGVzY3JpcHRpb247XG4gIHRpdGxlSW5wdXQuc3R5bGUudG9wID0gY2FyZC55O1xuICB0aXRsZUlucHV0LnN0eWxlLmxlZnQgPSBjYXJkLng7XG4gIGVkaXRDb250YWluZXIuY2FyZElkID0gY2FyZElkO1xuICBlZGl0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICBlZGl0SW5wdXQuc3R5bGUudG9wID0gY2FyZC55ICsgMjM7XG4gIGVkaXRJbnB1dC5zdHlsZS5sZWZ0ID0gY2FyZC54O1xuICB0aXRsZUlucHV0LmZvY3VzKCk7XG59XG5cbmZ1bmN0aW9uIGNhcmRDbGlja0V2ZW50cyAoZXZlbnQpIHtcbiAgbGV0IGNhcmRJZDtcbiAgbGV0IGNhcmQ7XG5cbiAgaWYgKHRoaXMuaWQgPT09ICcnKSB7XG4gICAgY2FyZElkID0gcGFyc2VJbnQodGhpcy5wYXJlbnRFbGVtZW50LmlkLnNwbGl0KCdfJylbMV0pO1xuICB9IGVsc2Uge1xuICAgIGNhcmRJZCA9IHBhcnNlSW50KHRoaXMuaWQuc3BsaXQoJ18nKVsxXSk7XG4gIH1cblxuICBjYXJkID0gY2FyZE1hbmFnZXIuY2FyZHNbY2FyZElkXTtcblxuICBpZiAoY2FyZCA9PT0gdW5kZWZpbmVkKSByZXR1cm47XG5cbiAgY2FyZE1hbmFnZXIuc2VsZWN0Q2FyZChjYXJkLmlkKTtcblxuICBpZiAoZXZlbnQuY3RybEtleSkge1xuICB9XG4gIGlmIChldmVudC5hbHRLZXkpIHtcbiAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5jb3B5JykuY2xpY2soKTtcbiAgfVxuICBpZiAoZXZlbnQuc2hpZnRLZXkpIHtcblxuICB9XG59XG5cbmZ1bmN0aW9uIGNhcmRNZW51RXZlbnRzICgpIHtcbiAgbGV0IG9wdGlvbiA9ICQodGhpcykuaHRtbCgpO1xuICBsZXQgc2VsZWN0aW9uO1xuICBsZXQgY2FyZElkID0gZ2V0UGFyZW50Q2FyZElkKHRoaXMpO1xuXG4gIHN3aXRjaCAob3B0aW9uKSB7XG4gICAgY2FzZSAnKyc6XG4gICAgICBjaGFuZ2VEZXB0aC5hcHBseSh0aGlzLCBbY2FyZElkLCAxXSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICctJzpcbiAgICAgIGNoYW5nZURlcHRoLmFwcGx5KHRoaXMsIFtjYXJkSWQsIC0xXSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdDJzpcbiAgICAgIHNlbGVjdGlvbiA9IHNlbGVjdFRleHQodGhpcy5wYXJlbnRFbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NhcmRUZXh0JylbMF0pO1xuICAgICAgY29weVNlbGVjdGlvblRleHQoKTtcbiAgICAgIHNlbGVjdGlvbi5lbXB0eSgpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAneCc6XG4gICAgICBjYXJkTWFuYWdlci5kZWxldGVDYXJkKGNhcmRNYW5hZ2VyLmNhcmRzW2NhcmRJZF0pO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnVic6XG4gICAgY2FzZSAnTyc6XG4gICAgICBjYXJkTWFuYWdlci5jYXJkc1tjYXJkSWRdLnRvZ2dsZUFyY2hpdmVkKCk7XG4gIH1cbiAgY2FyZE1hbmFnZXIuc2F2ZURhdGEoKTtcbn1cblxuZnVuY3Rpb24gZXhwb3J0Q2FyZHMgKCkge1xuICBleHBvcnRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gIGV4cG9ydENvbnRlbnQuaW5uZXJIVE1MID0gY2FyZE1hbmFnZXIuZXhwb3J0Q2FyZHMoKTtcbiAgc2VsZWN0aW9uID0gc2VsZWN0VGV4dChleHBvcnRDb250ZW50KTtcbiAgY29weVNlbGVjdGlvblRleHQoKTtcbiAgc2VsZWN0aW9uLmVtcHR5KCk7XG59XG5cbmZ1bmN0aW9uIGxvYWRJbXBvcnRDYXJkc0NvZGUgKCkge1xuICBsZXQgZGF0YSA9IGltcG9ydElucHV0LnZhbHVlO1xuICBjYXJkTWFuYWdlci5pbXBvcnRDYXJkcyhkYXRhKTtcbiAgaW1wb3J0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG59XG5cbmZ1bmN0aW9uIHNob3dJbXBvcnRlciAoKSB7XG4gIGltcG9ydENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgaW1wb3J0SW5wdXQuZm9jdXMoKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZCAoKSB7XG4gIGNvbnN0IGNhcmQgPSBjYXJkTWFuYWdlci5hZGRDYXJkKE9iamVjdC5jcmVhdGUoQ2FyZCwge30pLmluaXQoJycpKTtcbiAgY2FyZC5yZW5kZXIoKTtcbiAgY2FyZE1hbmFnZXIuc2VsZWN0Q2FyZChjYXJkLmlkKTtcblxuICAvLyBhbmQgbm93IHdlIGF1dG9lZGl0IDpEXG4gIGRvdWJsZUNsaWNrSGFuZGxlci5hcHBseShjYXJkLm5vZGUpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgaW5pdDogaW5pdFxufTtcbiIsIndpbmRvdy5sb2dlciA9IGZhbHNlO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBsb2c6IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgaWYgKHdpbmRvdy5sb2dlcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHdhcm46IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgaWYgKHdpbmRvdy5sb2dlcikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBlcnJvcjogZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgICBpZiAod2luZG93LmxvZ2VyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKG1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfVxufTsiLCJcbnZhciBzdWJzID0ge307XG5cbmZ1bmN0aW9uIHB1YiAobmFtZSwgcGFyYW1zKSB7XG4gIHN1YnNbbmFtZV0uZm9yRWFjaChmdW5jdGlvbiAoZWxlbSkge1xuICAgIGVsZW0uY2FsbGJhY2suYXBwbHkoZWxlbS5jb250ZXh0LCBwYXJhbXMpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gc3ViIChuYW1lLCBjYWxsYmFjaywgY29udGV4dCkge1xuICBpZiAoc3Vic1tuYW1lXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgc3Vic1tuYW1lXSA9IFtdO1xuICB9XG5cbiAgc3Vic1tuYW1lXS5wdXNoKHtcbiAgICBjYWxsYmFjazogY2FsbGJhY2ssXG4gICAgY29udGV4dDogY29udGV4dFxuICB9KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHB1YjogcHViLFxuICBzdWI6IHN1YlxufTtcbiIsIndpbmRvdy5DT05GSUcgPSByZXF1aXJlKCcuL2NvbmZpZy5qcycpO1xuXG5sZXQga2V5SGFuZGxlciA9IHJlcXVpcmUoJy4vbGliL2tleUhhbmRsZXInKTtcbmxldCBjYXJkTWFuYWdlciA9IHJlcXVpcmUoJy4vbW9kZWxzL0NhcmRNYW5hZ2VyJykuZ2V0SW5zdGFuY2UoKTtcbmxldCBwdWJzdWIgPSByZXF1aXJlKCcuL2xpYi9wdWJzdWInKTtcblxud2luZG93LmNtID0ge1xuICBjYXJkTWFuYWdlcjogY2FyZE1hbmFnZXJcbn07XG5cbk9iamVjdC5hc3NpZ24od2luZG93LCByZXF1aXJlKCcuL3Byb3RvdHlwZXMnKSk7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG4gICdzdHJpY3QgbW9kZSc7XG5cbiAga2V5SGFuZGxlci5pbml0KHtcbiAgICBjYXJkTWFuYWdlcjogY2FyZE1hbmFnZXJcbiAgfSk7XG4gICAgXG4gIGNhcmRNYW5hZ2VyLmxvYWREYXRhKCk7XG4gIGNhcmRNYW5hZ2VyLnJlbmRlckFsbENhcmRzKCk7XG59KTtcbiIsImxldCBwdWJzdWIgPSByZXF1aXJlKCcuLi9saWIvcHVic3ViJyk7XG5sZXQgcmFuZG9tTUMgPSByZXF1aXJlKCdyYW5kb20tbWF0ZXJpYWwtY29sb3InKTtcblxubGV0IENhcmQgPSB7XG4gIGluaXQ6IGZ1bmN0aW9uICh0aXRsZSwgZGVzY3JpcHRpb24sIHByaXN0aW5lKSB7XG4gICAgdGhpcy5pZCA9IC0xO1xuICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24gfHwgXCJcIjtcbiAgICB0aGlzLmRlcHRoID0gNTtcbiAgICB0aGlzLnggPSAxMDA7XG4gICAgdGhpcy55ID0gMTAwO1xuICAgIHRoaXMuY29sb3IgPSB0aGlzLmdldEJhY2tncm91bmRDb2xvcigpO1xuICAgIHRoaXMuc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICB0aGlzLmlzQXJjaGl2ZWQgPSBmYWxzZTtcbiAgICB0aGlzLmlzRGVsZXRlZCA9IGZhbHNlO1xuICAgIHRoaXMuY3JlYXRlZEF0ID0gK25ldyBEYXRlKCk7XG4gICAgdGhpcy5hcmNoaXZlZEF0ID0gbnVsbDtcbiAgICB0aGlzLmlzUHJpc3RpbmUgPSB0cnVlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIHJlbmRlcjogZnVuY3Rpb24gKGFsd2F5cyA9IGZhbHNlKSB7XG4gICAgaWYgKHRoaXMuaXNEZWxldGVkID09PSB0cnVlICYmIGFsd2F5cyA9PT0gZmFsc2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsZXQgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGxldCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGxldCB0ZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgbGV0IGxpbmsgPSB0aGlzLmZpbmRMaW5rKCk7XG4gICAgbGV0IHRoYXQgPSB0aGlzO1xuXG4gICAgaWYgKHRoaXMudGl0bGUpIHtcbiAgICAgIGlmIChsaW5rKSB7XG4gICAgICAgIHRpdGxlLmlubmVySFRNTCA9IGA8YSB0YXJnZXQ9XCJfYmxhbmtcIiBocmVmPVwiJHtsaW5rfVwiPiR7dGhpcy50aXRsZX08L2E+YDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRpdGxlLmlubmVySFRNTCA9IHRoaXMudGl0bGU7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChsaW5rKSB7XG4gICAgICAgIHRpdGxlLmlubmVySFRNTCA9IGA8YSB0YXJnZXQ9XCJfYmxhbmtcIiBocmVmPVwiJHtsaW5rfVwiPkxpbmshPC9hPmA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGVzY3JpcHRpb24pIHtcbiAgICAgIHRleHQuaW5uZXJIVE1MID0gdGhpcy5kZXNjcmlwdGlvbi5yZXBsYWNlKC9cXHI/XFxuL2csICc8YnIvPicpO1xuICAgIH1cblxuICAgIHRpdGxlLmNsYXNzTmFtZSA9ICdjYXJkVGl0bGUnO1xuICAgIHRleHQuY2xhc3NOYW1lID0gJ2NhcmRUZXh0JztcblxuICAgIG5vZGUuaWQgPSAndG9kb18nICsgdGhpcy5pZDtcbiAgICBub2RlLmNsYXNzTmFtZSA9ICdjYXJkIGNhcmQtMSc7XG4gICAgbm9kZS5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7XG4gICAgbm9kZS5zdHlsZS5sZWZ0ID0gdGhpcy54O1xuICAgIG5vZGUuc3R5bGUudG9wID0gdGhpcy55O1xuICAgIG5vZGUuc3R5bGUuY3Vyc29yID0gJy13ZWJraXQtZ3JhYic7XG4gICAgbm9kZS5zdHlsZS56SW5kZXggPSB0aGlzLmRlcHRoO1xuICAgIG5vZGUuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5jb2xvcjtcblxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQ29udGFpbmVyJykuYXBwZW5kQ2hpbGQobm9kZSk7XG5cbiAgICBub2RlLmFwcGVuZENoaWxkKGNyZWF0ZURpdigneCcsICdjb250cm9sIHJlbW92ZScpKTtcbiAgICAvLyBub2RlLmFwcGVuZENoaWxkKGNyZWF0ZURpdignKycsICdjb250cm9sIHVwJykpO1xuICAgIC8vIG5vZGUuYXBwZW5kQ2hpbGQoY3JlYXRlRGl2KCctJywgJ2NvbnRyb2wgZG93bicpKTtcbiAgICBub2RlLmFwcGVuZENoaWxkKGNyZWF0ZURpdignQycsICdjb250cm9sIGNvcHknKSk7XG4gICAgbm9kZS5hcHBlbmRDaGlsZChjcmVhdGVEaXYoJ2RlcHRoOiAnICsgdGhpcy5kZXB0aCwgJ2RlcHRoJykpO1xuICAgIC8vIG5vZGUuYXBwZW5kQ2hpbGQoY3JlYXRlRGl2KHRoaXMuaXNBcmNoaXZlZCA/ICdWJyA6ICdPJywgJ2lzQXJjaGl2ZWQnKSk7XG4gICAgbm9kZS5hcHBlbmRDaGlsZChjcmVhdGVEaXYoJ2lkOiAnICsgdGhpcy5pZCwgJ2lkJykpO1xuXG4gICAgbm9kZS5hcHBlbmRDaGlsZCh0aXRsZSk7XG4gICAgbm9kZS5hcHBlbmRDaGlsZCh0ZXh0KTtcblxuICAgICQoJyN0b2RvXycgKyB0aGlzLmlkKS5kcmFnZ2FibGUoe1xuICAgICAgc3RvcDogZnVuY3Rpb24gKCkge1xuICAgICAgICBsZXQgY2FyZCA9ICQoJyN0b2RvXycgKyB0aGF0LmlkKTtcblxuICAgICAgICBpZiAodGhhdC5pc1ByaXN0aW5lID09PSB0cnVlKSB7XG4gICAgICAgICAgdGhhdC5pc1ByaXN0aW5lID0gZmFsc2U7XG5cbiAgICAgICAgICBwdWJzdWIucHViKHdpbmRvdy5DT05GSUcuTEVTU19QUklTVElORSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGF0LnggPSArY2FyZC5jc3MoJ2xlZnQnKS5yZXBsYWNlKCdweCcsICcnKTtcbiAgICAgICAgdGhhdC55ID0gK2NhcmQuY3NzKCd0b3AnKS5yZXBsYWNlKCdweCcsICcnKTtcblxuICAgICAgICBwdWJzdWIucHViKHdpbmRvdy5DT05GSUcuU0VMRUNUX0NBUkQsIFt0aGF0LmlkXSk7XG4gICAgICAgIHB1YnN1Yi5wdWIod2luZG93LkNPTkZJRy5TQVZFX0NBUkRTKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMubm9kZSA9IG5vZGU7XG5cbiAgICBpZiAodGhpcy5zZWxlY3RlZCA9PT0gdHJ1ZSkge1xuICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzQXJjaGl2ZWQpIHtcbiAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGdldEJhY2tncm91bmRDb2xvcjogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiByYW5kb21NQy5nZXRDb2xvcih7IHNoYWRlczogWycyMDAnLCAnMzAwJ10gfSk7XG4gIH0sXG4gIGRlcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IG5vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9kb18nICsgdGhpcy5pZCk7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250YWluZXInKS5yZW1vdmVDaGlsZChub2RlKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICB0b2dnbGVBcmNoaXZlZDogZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmlzQXJjaGl2ZWQgPT09IGZhbHNlIHx8IHRoaXMuaXNBcmNoaXZlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLm5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnbm90Q29tcGxldGVkJyk7XG4gICAgICB2b2lkIHRoaXMubm9kZS5vZmZzZXRXaWR0aDtcbiAgICAgIHRoaXMubm9kZS5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZWQnKTtcbiAgICAgIHRoaXMuYXJjaGl2ZWRBdCA9ICtuZXcgRGF0ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY29tcGxldGVkJyk7XG4gICAgICB2b2lkIHRoaXMubm9kZS5vZmZzZXRXaWR0aDtcbiAgICAgIHRoaXMubm9kZS5jbGFzc0xpc3QuYWRkKCdub3RDb21wbGV0ZWQnKTtcbiAgICAgIHRoaXMuYXJjaGl2ZWRBdCA9IG51bGw7XG4gICAgfVxuXG4gICAgdGhpcy5pc0FyY2hpdmVkID0gIXRoaXMuaXNBcmNoaXZlZDtcblxuICAgIHB1YnN1Yi5wdWIod2luZG93LkNPTkZJRy5TQVZFX0NBUkRTKTtcbiAgfSxcbiAgZGVsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5pc0RlbGV0ZWQgPSB0cnVlO1xuXG4gICAgdGhpcy5kZXJlbmRlcigpO1xuICB9LFxuICB1bmRlbGV0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaXNEZWxldGVkID0gZmFsc2U7XG5cbiAgICB0aGlzLnJlbmRlcigpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGZpbmRMaW5rOiBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgcmVnZXggPSAvKGh0dHBzPzpcXC9cXC9bXlxcc10rfHd3dy5bXlxcc10rKS87XG4gICAgbGV0IGxpbmsgPSByZWdleC5leGVjKHRoaXMudGl0bGUpO1xuXG4gICAgaWYgKGxpbmsgPT0gbnVsbCkge1xuICAgICAgbGluayA9IHJlZ2V4LmV4ZWModGhpcy5kZXNjcmlwdGlvbik7XG4gICAgfVxuXG4gICAgaWYgKGxpbmspIHtcbiAgICAgIHJldHVybiBsaW5rWzBdO1xuICAgIH1cbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBDYXJkO1xuIiwiY29uc3QgQ2FyZCA9IHJlcXVpcmUoJy4vQ2FyZCcpO1xuY29uc3QgcHVic3ViID0gcmVxdWlyZSgnLi4vbGliL3B1YnN1YicpO1xuY29uc3QgQ09ORklHID0gcmVxdWlyZSgnLi4vY29uZmlnJyk7XG5jb25zdCBsb2dlciA9IHJlcXVpcmUoJy4uL2xpYi9sb2dlcicpO1xuXG5sZXQgQ2FyZE1hbmFnZXIgPSB7XG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmNhcmRzID0gW107XG4gICAgdGhpcy5zZWxlY3RlZENhcmQgPSB7IGlkOiAtMSB9O1xuICAgIHRoaXMuZGVsZXRlZENhcmRzID0gW107XG4gICAgdGhpcy5wcmlzdGluZSA9IDA7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgYWRkQ2FyZDogZnVuY3Rpb24gKGNhcmQpIHtcbiAgICB0aGlzLmNhcmRzLnB1c2goY2FyZCk7XG4gICAgY2FyZC5pZCA9IHRoaXMuY2FyZHMubGVuZ3RoIC0gMTtcblxuICAgIGNhcmQueCA9IGNhcmQueCArIHRoaXMucHJpc3RpbmUgKiAxMDtcbiAgICBjYXJkLnkgPSBjYXJkLnkgKyB0aGlzLnByaXN0aW5lICogMTA7XG5cbiAgICB0aGlzLnByaXN0aW5lKys7XG5cbiAgICByZXR1cm4gY2FyZDtcbiAgfSxcbiAgcmVtb3ZlQ2FyZDogZnVuY3Rpb24gKGlkKSB7XG4gICAgdGhpcy5jYXJkc1tpZF0uZGVyZW5kZXIoKTtcbiAgICB0aGlzLmNhcmRzW2lkXSA9IHVuZGVmaW5lZDtcblxuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICByZWRyYXdDYXJkOiBmdW5jdGlvbiAoY2FyZElkLCB4LCB5KSB7XG4gICAgbGV0IGNhcmQgPSB0aGlzLmNhcmRzW2NhcmRJZF07XG4gICAgY2FyZC54ID0geDtcbiAgICBjYXJkLnkgPSB5O1xuXG4gICAgY2FyZC5kZXJlbmRlcigpO1xuICAgIGNhcmQucmVuZGVyKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgc2F2ZURhdGE6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgZGF0YSA9IHt9O1xuXG4gICAgaWYgKHR5cGVvZiAoU3RvcmFnZSkgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ3lvdSBkb25cXCd0IGhhdmUgbG9jYWwgc3RvcmFnZSA6KCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGRhdGEuY2FyZHMgPSB0aGlzLmNhcmRzO1xuICAgIGRhdGEuc2VsZWN0ZWRDYXJkSWQgPSB0aGlzLnNlbGVjdGVkQ2FyZC5pZDtcbiAgICBkYXRhLmRlbGV0ZWRDYXJkcyA9IHRoaXMuZGVsZXRlZENhcmRzO1xuXG4gICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYXJkc0RhdGEnLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XG5cbiAgICBsb2dlci5sb2coXCJEYXRhIHNhdmVkXCIpO1xuICB9LFxuICBsb2FkRGF0YTogZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2FyZHNEYXRhJykpIHx8IHt9O1xuXG4gICAgdGhpcy5jYXJkcyA9IGRhdGEuY2FyZHM7XG5cbiAgICBpZiAodGhpcy5jYXJkcyA9PSBudWxsKSB7XG4gICAgICB0aGlzLmNhcmRzID0gSlNPTi5wYXJzZSh3aW5kb3cuYXRvYihDT05GSUcuREVGQVVMVF9DT05URU5UKSk7XG4gICAgfVxuXG4gICAgLy8gTG9hZCBzZWxlY3RlZCBjYXJkXG4gICAgaWYgKGRhdGEuc2VsZWN0ZWRDYXJkSWQgIT09IHVuZGVmaW5lZCAmJiBkYXRhLnNlbGVjdGVkQ2FyZElkID4gLTEpIHtcbiAgICAgIHRoaXMuc2VsZWN0ZWRDYXJkID0gdGhpcy5jYXJkc1tkYXRhLnNlbGVjdGVkQ2FyZElkXTtcbiAgICB9XG5cbiAgICB0aGlzLmNsZWFyQXJyYXkoKTtcblxuICAgIC8vIExvYWQgZGVsZXRlZCBjYXJkc1xuICAgIHRoaXMuZGVsZXRlZENhcmRzID0gZGF0YS5kZWxldGVkQ2FyZHMgfHwgW107XG5cbiAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTtcblxuICAgIGxvZ2VyLmxvZygnRGF0YSBsb2FkZWQnKTtcbiAgfSxcbiAgY2xlYXJBcnJheTogZnVuY3Rpb24gKCkge1xuICAgIGxldCBpO1xuXG4gICAgdGhpcy5jYXJkcyA9IHRoaXMuY2FyZHMuZmlsdGVyKGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgICByZXR1cm4gZWxlbSAhPT0gdW5kZWZpbmVkICYmIGVsZW0gIT09IG51bGw7XG4gICAgfSk7XG5cbiAgICBmb3IgKGkgaW4gdGhpcy5jYXJkcykge1xuICAgICAgaWYgKHRoaXMuY2FyZHMuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgdGhpcy5jYXJkc1sraV0uaWQgPSAraTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgcmVSZW5kZXJBbGxDYXJkczogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xuICAgICAgY2FyZC5kZXJlbmRlcigpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5yZW5kZXJBbGxDYXJkcygpO1xuICB9LFxuICByZW5kZXJBbGxDYXJkczogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuY2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xuICAgICAgY2FyZC5zZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWRDYXJkICYmICh0aGlzLnNlbGVjdGVkQ2FyZC5pZCA9PT0gY2FyZC5pZCk7XG4gICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoY2FyZCwgQ2FyZCk7XG4gICAgICBjYXJkLnJlbmRlcigpO1xuICAgIH1cbiAgICApO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGdldEluc3RhbmNlOiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKENhcmRNYW5hZ2VyLmluc3RhbmNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIENhcmRNYW5hZ2VyLmluc3RhbmNlID0gT2JqZWN0LmNyZWF0ZShDYXJkTWFuYWdlciwge30pO1xuICAgICAgQ2FyZE1hbmFnZXIuaW5zdGFuY2UuaW5pdCgpO1xuICAgICAgcHVic3ViLnN1Yih3aW5kb3cuQ09ORklHLlNBVkVfQ0FSRFMsIENhcmRNYW5hZ2VyLmluc3RhbmNlLnNhdmVEYXRhLCBDYXJkTWFuYWdlci5pbnN0YW5jZSk7XG4gICAgICBwdWJzdWIuc3ViKHdpbmRvdy5DT05GSUcuU0VMRUNUX0NBUkQsIENhcmRNYW5hZ2VyLmluc3RhbmNlLnNlbGVjdENhcmQsIENhcmRNYW5hZ2VyLmluc3RhbmNlKTtcbiAgICAgIHB1YnN1Yi5zdWIod2luZG93LkNPTkZJRy5SRVJFTkRFUiwgQ2FyZE1hbmFnZXIuaW5zdGFuY2UucmVSZW5kZXJBbGxDYXJkcywgQ2FyZE1hbmFnZXIuaW5zdGFuY2UpO1xuICAgICAgcHVic3ViLnN1Yih3aW5kb3cuQ09ORklHLkxFU1NfUFJJU1RJTkUsIENhcmRNYW5hZ2VyLmluc3RhbmNlLmxlc3NQcmlzdGluZSwgQ2FyZE1hbmFnZXIuaW5zdGFuY2UpO1xuICAgIH1cblxuICAgIHJldHVybiBDYXJkTWFuYWdlci5pbnN0YW5jZTtcbiAgfSxcbiAgbGVzc1ByaXN0aW5lOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5wcmlzdGluZS0tO1xuICB9LFxuICBleHBvcnRDYXJkczogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB3aW5kb3cuYnRvYShKU09OLnN0cmluZ2lmeSh0aGlzLmNhcmRzKSk7XG4gIH0sXG4gIGltcG9ydENhcmRzOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FyZHNEYXRhJywgd2luZG93LmF0b2IoZGF0YSkpO1xuICAgIHRoaXMubG9hZERhdGEoKTtcbiAgICB0aGlzLnJlbmRlckFsbENhcmRzKCk7XG4gIH0sXG4gIHNlbGVjdENhcmQ6IGZ1bmN0aW9uIChjYXJkSWQpIHtcbiAgICBpZiAodGhpcy5zZWxlY3RlZENhcmQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICB0aGlzLnNlbGVjdGVkQ2FyZCA+IC0xICYmXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRDYXJkLm5vZGUuY2xhc3NMaXN0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuc2VsZWN0ZWRDYXJkLm5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTtcbiAgICB9XG4gICAgdGhpcy5zZWxlY3RlZENhcmQgPSB0aGlzLmNhcmRzW2NhcmRJZF07XG5cbiAgICB0aGlzLnNlbGVjdGVkQ2FyZC5ub2RlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG5cbiAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTtcbiAgfSxcbiAgbmV4dENhcmQ6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgaXQgPSArdGhpcy5zZWxlY3RlZENhcmQuaWQgKyAxO1xuXG4gICAgd2hpbGUgKGl0ICE9PSArdGhpcy5zZWxlY3RlZENhcmQuaWQpIHtcbiAgICAgIGlmICh0aGlzLmNhcmRzW2l0XSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuY2FyZHNbaXRdLmlzRGVsZXRlZCAhPT0gdHJ1ZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmICgrK2l0ID49IHRoaXMuY2FyZHMubGVuZ3RoKSB7XG4gICAgICAgIGl0ID0gMDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnNlbGVjdENhcmQoaXQpO1xuICB9LFxuICBwcmV2aW91c0NhcmQ6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgaXQgPSArdGhpcy5zZWxlY3RlZENhcmQuaWQgLSAxO1xuXG4gICAgd2hpbGUgKGl0ICE9PSArdGhpcy5zZWxlY3RlZENhcmQuaWQpIHtcbiAgICAgIGlmICh0aGlzLmNhcmRzW2l0XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKC0taXQgPD0gMCkge1xuICAgICAgICBpdCA9IHRoaXMuY2FyZHMubGVuZ3RoO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuc2VsZWN0Q2FyZChpdCk7XG4gIH0sXG4gIGRlbGV0ZUNhcmQ6IGZ1bmN0aW9uIChjYXJkKSB7XG4gICAgdGhpcy5kZWxldGVkQ2FyZHMucHVzaChjYXJkLmlkKTtcblxuICAgIGNhcmQuZGVsZXRlKCk7XG4gIH0sXG4gIHVuZGVsZXRlTGFzdENhcmQ6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5kZWxldGVkQ2FyZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5zZWxlY3RDYXJkKHRoaXMuY2FyZHNbdGhpcy5kZWxldGVkQ2FyZHMuc3BsaWNlKHRoaXMuZGVsZXRlZENhcmRzLmxlbmd0aCAtIDEpXS51bmRlbGV0ZSgpLmlkKTtcblxuICAgIHRoaXMuc2F2ZURhdGEoKTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBDYXJkTWFuYWdlcjtcbiIsImxldCBjYXJkTWFuYWdlciA9IHJlcXVpcmUoJy4vbW9kZWxzL0NhcmRNYW5hZ2VyJykuZ2V0SW5zdGFuY2UoKTtcblxuZnVuY3Rpb24gY3JlYXRlRGl2ICh0ZXh0LCBjbGFzc05hbWUpIHtcbiAgbGV0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBkaXYuaW5uZXJIVE1MID0gdGV4dDtcbiAgZGl2LnN0eWxlLmZsb2F0ID0gJ3JpZ2h0JztcbiAgZGl2LnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcbiAgZGl2LnN0eWxlLndpZHRoID0gJ2F1dG8nO1xuICBkaXYuc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7XG4gIGRpdi5zdHlsZS5tYXJnaW4gPSAnMCAzcHgnO1xuXG4gIGlmIChjbGFzc05hbWUgIT09IHVuZGVmaW5lZCkge1xuICAgIGRpdi5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG4gIH1cblxuICByZXR1cm4gZGl2O1xufVxuXG5mdW5jdGlvbiBjb3B5U2VsZWN0aW9uVGV4dCAoKSB7XG4gIGxldCBjb3B5c3VjY2VzczsgLy8gbGV0IHRvIGNoZWNrIHdoZXRoZXIgZXhlY0NvbW1hbmQgc3VjY2Vzc2Z1bGx5IGV4ZWN1dGVkXG4gIHRyeSB7XG4gICAgY29weXN1Y2Nlc3MgPSBkb2N1bWVudC5leGVjQ29tbWFuZCgnY29weScpOyAvLyBydW4gY29tbWFuZCB0byBjb3B5IHNlbGVjdGVkIHRleHQgdG8gY2xpcGJvYXJkXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb3B5c3VjY2VzcyA9IGZhbHNlO1xuICB9XG4gIHJldHVybiBjb3B5c3VjY2Vzcztcbn1cblxuZnVuY3Rpb24gc2VsZWN0VGV4dCAoZWxlbWVudCkge1xuICBsZXQgZG9jID0gZG9jdW1lbnQ7XG4gIGxldCB0ZXh0ID0gZWxlbWVudDtcbiAgbGV0IHJhbmdlLCBzZWxlY3Rpb25cbiAgICA7XG4gICAgaWYgKGRvYy5ib2R5LmNyZWF0ZVRleHRSYW5nZSkge1xuICAgICAgICByYW5nZSA9IGRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgICAgIHJhbmdlLm1vdmVUb0VsZW1lbnRUZXh0KHRleHQpO1xuICAgICAgICByYW5nZS5zZWxlY3QoKTtcbiAgICB9IGVsc2UgaWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24pIHtcbiAgICAgICAgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpO1xuICAgICAgICByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XG4gICAgICAgIHJhbmdlLnNlbGVjdE5vZGVDb250ZW50cyh0ZXh0KTtcbiAgICAgICAgc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgICBzZWxlY3Rpb24uYWRkUmFuZ2UocmFuZ2UpO1xuICAgICAgICByZXR1cm4gc2VsZWN0aW9uO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0UGFyZW50Q2FyZElkIChjb250ZXh0KSB7XG4gIGlmIChjb250ZXh0LnBhcmVudEVsZW1lbnQgPT09IG51bGwpIHJldHVybjtcbiAgcmV0dXJuIHBhcnNlSW50KGNvbnRleHQucGFyZW50RWxlbWVudC5pZC5zcGxpdCgnXycpWzFdKTtcbn1cblxuZnVuY3Rpb24gZ2V0U29tZXRoaW5nQnljbGFzc05hbWUgKGNvbnRleHQsIGNsYXNzbmFtZSkge1xuICBsZXQgcmVzID0gY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGNsYXNzbmFtZSk7XG5cbiAgaWYgKHJlcy5sZW5ndGggPT09IDApIHtcbiAgICByZXMgPSBjb250ZXh0LnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShjbGFzc25hbWUpO1xuICB9XG5cbiAgcmV0dXJuIHJlcztcbn1cblxuZnVuY3Rpb24gY2hhbmdlRGVwdGggKGNhcmRJZCwgaW5jcmVtZW50KSB7XG4gIGxldCBkZXB0aCA9IGNhcmRNYW5hZ2VyLmNhcmRzW2NhcmRJZF0uZGVwdGggKyBpbmNyZW1lbnQ7XG5cbiAgdGhpcy5zdHlsZS56SW5kZXggPSBkZXB0aDtcbiAgY2FyZE1hbmFnZXIuY2FyZHNbY2FyZElkXS5kZXB0aCA9IGRlcHRoO1xuXG4gIGxldCBlbGVtID0gZ2V0U29tZXRoaW5nQnljbGFzc05hbWUodGhpcywgJ2RlcHRoJyk7XG4gIGVsZW1bMF0uaW5uZXJIVE1MID0gZGVwdGg7XG59XG5cbmZ1bmN0aW9uIHNldERlcHRoIChjYXJkSWQsIGRlcHRoKSB7XG4gIHRoaXMuc3R5bGUuekluZGV4ID0gZGVwdGg7XG4gIGNhcmRNYW5hZ2VyLmNhcmRzW2NhcmRJZF0uZGVwdGggPSBkZXB0aDtcblxuICBsZXQgZWxlbSA9IGdldFNvbWV0aGluZ0J5Y2xhc3NOYW1lKHRoaXMsICdkZXB0aCcpO1xuICBlbGVtWzBdLmlubmVySFRNTCA9IGRlcHRoO1xufVxuXG5mdW5jdGlvbiBnZXRDYXJkSFRNTEJ5SWQobWFpbkNvbnRhaW5lciwgaWQpIHtcbiAgICByZXR1cm4gbWFpbkNvbnRhaW5lci5nZXRFbGVtZW50QnlJZCgndG9kb18nICsgaWQpO1xufVxuXG4vLyBQUk9UT1RZUEVTXG5cbi8qXG4gKiBSZXR1cm5zIHRoZSBzaXplIG9mIGFuIGFycmF5XG4gKi9cbkFycmF5LnByb3RvdHlwZS5zaXplID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24gKGEpIHtcbiAgICByZXR1cm4gYSAhPT0gdW5kZWZpbmVkO1xuICB9KS5sZW5ndGg7XG59O1xuXG4vKlxuICogUmV0dXJucyB0aGUgc2l6ZSBvZiBhbiBvYmplY3RcbiAqL1xuT2JqZWN0LnNpemUgPSBmdW5jdGlvbiAob2JqKSB7XG4gIGxldCBzaXplID0gMDtcbiAgbGV0IGtleSA9ICcnO1xuXG4gICAgZm9yIChrZXkgaW4gb2JqKSB7XG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkgc2l6ZSsrO1xuICAgIH1cbiAgICByZXR1cm4gc2l6ZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBjcmVhdGVEaXY6IGNyZWF0ZURpdixcbiAgY29weVNlbGVjdGlvblRleHQ6IGNvcHlTZWxlY3Rpb25UZXh0LFxuICBzZWxlY3RUZXh0OiBzZWxlY3RUZXh0LFxuICBnZXRQYXJlbnRDYXJkSWQ6IGdldFBhcmVudENhcmRJZCxcbiAgY2hhbmdlRGVwdGg6IGNoYW5nZURlcHRoLFxuICBzZXREZXB0aDogc2V0RGVwdGgsXG4gIGdldENhcmRIVE1MQnlJZDogZ2V0Q2FyZEhUTUxCeUlkXG59O1xuIl19"}