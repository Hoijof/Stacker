{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/murmurhash-js/index.js","node_modules/murmurhash-js/murmurhash2_gc.js","node_modules/murmurhash-js/murmurhash3_gc.js","node_modules/random-material-color/dist/randomColor.js","src/js/config.js","src/js/lib/keyHandler.js","src/js/lib/pubsub.js","src/js/main.js","src/js/models/Card.js","src/js/models/CardManager.js","src/js/prototypes.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnEA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var murmur3 = require(\"./murmurhash3_gc.js\")\nvar murmur2 = require(\"./murmurhash2_gc.js\")\n\nmodule.exports = murmur3\nmodule.exports.murmur3 = murmur3\nmodule.exports.murmur2 = murmur2\n","/**\n * JS Implementation of MurmurHash2\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} str ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash\n */\n\nfunction murmurhash2_32_gc(str, seed) {\n  var\n    l = str.length,\n    h = seed ^ l,\n    i = 0,\n    k;\n  \n  while (l >= 4) {\n  \tk = \n  \t  ((str.charCodeAt(i) & 0xff)) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 8) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 16) |\n  \t  ((str.charCodeAt(++i) & 0xff) << 24);\n    \n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n    k ^= k >>> 24;\n    k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n\n\th = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16)) ^ k;\n\n    l -= 4;\n    ++i;\n  }\n  \n  switch (l) {\n  case 3: h ^= (str.charCodeAt(i + 2) & 0xff) << 16;\n  case 2: h ^= (str.charCodeAt(i + 1) & 0xff) << 8;\n  case 1: h ^= (str.charCodeAt(i) & 0xff);\n          h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  }\n\n  h ^= h >>> 13;\n  h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n  h ^= h >>> 15;\n\n  return h >>> 0;\n}\n\nif(typeof module !== undefined) {\n  module.exports = murmurhash2_32_gc\n}\n","/**\n * JS Implementation of MurmurHash3 (r136) (as of May 20, 2011)\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} key ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash \n */\n\nfunction murmurhash3_32_gc(key, seed) {\n\tvar remainder, bytes, h1, h1b, c1, c1b, c2, c2b, k1, i;\n\t\n\tremainder = key.length & 3; // key.length % 4\n\tbytes = key.length - remainder;\n\th1 = seed;\n\tc1 = 0xcc9e2d51;\n\tc2 = 0x1b873593;\n\ti = 0;\n\t\n\twhile (i < bytes) {\n\t  \tk1 = \n\t  \t  ((key.charCodeAt(i) & 0xff)) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 8) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 16) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 24);\n\t\t++i;\n\t\t\n\t\tk1 = ((((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16))) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = ((((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16))) & 0xffffffff;\n\n\t\th1 ^= k1;\n        h1 = (h1 << 13) | (h1 >>> 19);\n\t\th1b = ((((h1 & 0xffff) * 5) + ((((h1 >>> 16) * 5) & 0xffff) << 16))) & 0xffffffff;\n\t\th1 = (((h1b & 0xffff) + 0x6b64) + ((((h1b >>> 16) + 0xe654) & 0xffff) << 16));\n\t}\n\t\n\tk1 = 0;\n\t\n\tswitch (remainder) {\n\t\tcase 3: k1 ^= (key.charCodeAt(i + 2) & 0xff) << 16;\n\t\tcase 2: k1 ^= (key.charCodeAt(i + 1) & 0xff) << 8;\n\t\tcase 1: k1 ^= (key.charCodeAt(i) & 0xff);\n\t\t\n\t\tk1 = (((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16)) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = (((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16)) & 0xffffffff;\n\t\th1 ^= k1;\n\t}\n\t\n\th1 ^= key.length;\n\n\th1 ^= h1 >>> 16;\n\th1 = (((h1 & 0xffff) * 0x85ebca6b) + ((((h1 >>> 16) * 0x85ebca6b) & 0xffff) << 16)) & 0xffffffff;\n\th1 ^= h1 >>> 13;\n\th1 = ((((h1 & 0xffff) * 0xc2b2ae35) + ((((h1 >>> 16) * 0xc2b2ae35) & 0xffff) << 16))) & 0xffffffff;\n\th1 ^= h1 >>> 16;\n\n\treturn h1 >>> 0;\n}\n\nif(typeof module !== \"undefined\") {\n  module.exports = murmurhash3_32_gc\n}","var defaultPalette={50:[\"#FFEBEE\",\"#FCE4EC\",\"#F3E5F5\",\"#EDE7F6\",\"#E8EAF6\",\"#E3F2FD\",\"#E1F5FE\",\"#E0F7FA\",\"#E0F2F1\",\"#E8F5E9\",\"#F1F8E9\",\"#F9FBE7\",\"#FFFDE7\",\"#FFF8E1\",\"#FFF3E0\",\"#FBE9E7\",\"#EFEBE9\",\"#FAFAFA\",\"#ECEFF1\"],100:[\"#FFCDD2\",\"#F8BBD0\",\"#E1BEE7\",\"#D1C4E9\",\"#C5CAE9\",\"#BBDEFB\",\"#B3E5FC\",\"#B2EBF2\",\"#B2DFDB\",\"#C8E6C9\",\"#DCEDC8\",\"#F0F4C3\",\"#FFF9C4\",\"#FFECB3\",\"#FFE0B2\",\"#FFCCBC\",\"#D7CCC8\",\"#F5F5F5\",\"#CFD8DC\"],200:[\"#EF9A9A\",\"#F48FB1\",\"#CE93D8\",\"#B39DDB\",\"#9FA8DA\",\"#90CAF9\",\"#81D4FA\",\"#80DEEA\",\"#80CBC4\",\"#A5D6A7\",\"#C5E1A5\",\"#E6EE9C\",\"#FFF59D\",\"#FFE082\",\"#FFCC80\",\"#FFAB91\",\"#BCAAA4\",\"#EEEEEE\",\"#B0BEC5\"],300:[\"#E57373\",\"#F06292\",\"#BA68C8\",\"#9575CD\",\"#7986CB\",\"#64B5F6\",\"#4FC3F7\",\"#4DD0E1\",\"#4DB6AC\",\"#81C784\",\"#AED581\",\"#DCE775\",\"#FFF176\",\"#FFD54F\",\"#FFB74D\",\"#FF8A65\",\"#A1887F\",\"#E0E0E0\",\"#90A4AE\"],400:[\"#EF5350\",\"#EC407A\",\"#AB47BC\",\"#7E57C2\",\"#5C6BC0\",\"#42A5F5\",\"#29B6F6\",\"#26C6DA\",\"#26A69A\",\"#66BB6A\",\"#9CCC65\",\"#D4E157\",\"#FFEE58\",\"#FFCA28\",\"#FFA726\",\"#FF7043\",\"#8D6E63\",\"#BDBDBD\",\"#78909C\"],500:[\"#F44336\",\"#E91E63\",\"#9C27B0\",\"#673AB7\",\"#3F51B5\",\"#2196F3\",\"#03A9F4\",\"#00BCD4\",\"#009688\",\"#4CAF50\",\"#8BC34A\",\"#CDDC39\",\"#FFEB3B\",\"#FFC107\",\"#FF9800\",\"#FF5722\",\"#795548\",\"#9E9E9E\",\"#607D8B\"],600:[\"#E53935\",\"#D81B60\",\"#8E24AA\",\"#5E35B1\",\"#3949AB\",\"#1E88E5\",\"#039BE5\",\"#00ACC1\",\"#00897B\",\"#43A047\",\"#7CB342\",\"#C0CA33\",\"#FDD835\",\"#FFB300\",\"#FB8C00\",\"#F4511E\",\"#6D4C41\",\"#757575\",\"#546E7A\"],700:[\"#D32F2F\",\"#C2185B\",\"#7B1FA2\",\"#512DA8\",\"#303F9F\",\"#1976D2\",\"#0288D1\",\"#0097A7\",\"#00796B\",\"#388E3C\",\"#689F38\",\"#AFB42B\",\"#FBC02D\",\"#FFA000\",\"#F57C00\",\"#E64A19\",\"#5D4037\",\"#616161\",\"#455A64\"],800:[\"#C62828\",\"#AD1457\",\"#6A1B9A\",\"#4527A0\",\"#283593\",\"#1565C0\",\"#0277BD\",\"#00838F\",\"#00695C\",\"#2E7D32\",\"#558B2F\",\"#9E9D24\",\"#F9A825\",\"#FF8F00\",\"#EF6C00\",\"#D84315\",\"#4E342E\",\"#424242\",\"#37474F\"],900:[\"#B71C1C\",\"#880E4F\",\"#4A148C\",\"#311B92\",\"#1A237E\",\"#0D47A1\",\"#01579B\",\"#006064\",\"#004D40\",\"#1B5E20\",\"#33691E\",\"#827717\",\"#F57F17\",\"#FF6F00\",\"#E65100\",\"#BF360C\",\"#3E2723\",\"#212121\",\"#263238\"],A100:[\"#FF8A80\",\"#FF80AB\",\"#EA80FC\",\"#B388FF\",\"#8C9EFF\",\"#82B1FF\",\"#80D8FF\",\"#84FFFF\",\"#A7FFEB\",\"#B9F6CA\",\"#CCFF90\",\"#F4FF81\",\"#FFFF8D\",\"#FFE57F\",\"#FFD180\",\"#FF9E80\"],A200:[\"#FF5252\",\"#FF4081\",\"#E040FB\",\"#7C4DFF\",\"#536DFE\",\"#448AFF\",\"#40C4FF\",\"#18FFFF\",\"#64FFDA\",\"#69F0AE\",\"#B2FF59\",\"#EEFF41\",\"#FFFF00\",\"#FFD740\",\"#FFAB40\",\"#FF6E40\"],A400:[\"#FF1744\",\"#F50057\",\"#D500F9\",\"#651FFF\",\"#3D5AFE\",\"#2979FF\",\"#00B0FF\",\"#00E5FF\",\"#1DE9B6\",\"#00E676\",\"#76FF03\",\"#C6FF00\",\"#FFEA00\",\"#FFC400\",\"#FF9100\",\"#FF3D00\"],A700:[\"#D50000\",\"#C51162\",\"#AA00FF\",\"#6200EA\",\"#304FFE\",\"#2962FF\",\"#0091EA\",\"#00B8D4\",\"#00BFA5\",\"#00C853\",\"#64DD17\",\"#AEEA00\",\"#FFD600\",\"#FFAB00\",\"#FF6D00\",\"#DD2C00\"]},murmur=require(\"murmurhash-js\");module.exports=function(){var F=[],E={shades:[\"500\"],palette:defaultPalette,text:null,ignoreColors:[]},C=function(C){C||(C=E),C.palette||(C.palette=defaultPalette),C.shades||(C.shades=[\"500\"]);for(var B,D=F.length,t=0;D>t;t++)if(C.text&&F[t].text===C.text)return F[t].color;return B=A(C),C.text&&F.push({text:C.text,color:B}),B},A=function(F){var E=F.shades[B(F.shades.length)],C=\"\";for(var A in F.palette)F.palette.hasOwnProperty(A)&&A===E&&(C=F.text?F.palette[A][D(F.text,F.palette[A].length)]:F.palette[A][B(F.palette[A].length)]);return C},B=function(F){return Math.floor(Math.random()*F)},D=function(F,E){var C=murmur.murmur3(F)/1e10;return.1>C&&(C=10*C),Math.floor(C*E)};return{getColor:C}}();","module.exports = {\r\n  SAVE_CARDS: 'SAVE_CARDS',\r\n  SELECT_CARD: 'SELECT_CARD',\r\n  RERENDER: 'RERENDER',\r\n  LESS_PRISTINE: 'LESS_PRISTINE',\r\n  ASCII: {\r\n    ESCAPE_KEY: 27,\r\n    TAB_KEY: 9,\r\n    C_KEY: 67,\r\n    D_KEY: 68,\r\n    E_KEY: 69,\r\n    PLUS_KEY: 187,\r\n    MINUS_KEY: 189,\r\n    DOT_KEY: 190,\r\n    A_KEY: 65,\r\n    I_KEY: 73,\r\n    R_KEY: 82,\r\n    Z_KEY: 90,\r\n    CMD_KEY: 91,\r\n    KEYS_ARRAY: [27, 9, 67, 68, 69, 187, 189, 190, 65, 73, 82, 90, 91],\r\n  },\r\n  DEFAULT_CONTENT: 'W3siaWQiOjAsInRpdGxlIjoiMSIsImRlc2NyaXB0aW9uIjoiVXNlIHRhYiBhbmQgc2hpZnQgdGFiIHRvIGNpcmNsZSBiZXR3ZWVuIGNhcmRzIDpEXG5cbkRyYWdnaW5nIG9yIGNsaWNraW5nIHRoZW0gd2lsbCBhbHNvIG1hcmsgdGhlbSBhcyBzZWxlY3RlZCIsImRlcHRoIjo1LCJ4IjoxNjksInkiOjc5LCJjb2xvciI6IiNBNUQ2QTciLCJzZWxlY3RlZCI6dHJ1ZSwiaXNBcmNoaXZlZCI6ZmFsc2UsImlzRGVsZXRlZCI6ZmFsc2UsImNyZWF0ZWRBdCI6MTUwNzY0Njc1ODE4NiwiYXJjaGl2ZWRBdCI6bnVsbCwibm9kZSI6eyJqUXVlcnkxNzIwNDI0NzE4MTg1NzEyOTY0MDUiOjR9fSx7ImlkIjoxLCJ0aXRsZSI6IjIiLCJkZXNjcmlwdGlvbiI6Ik9uIGEgbWFya2VkIGNhcmQgdXNlIGN0cmwgKzpcbidjJyB0byBjb3B5IHRoZSBjb250ZW50XG4nZCcgdG8gZGVsZXRlIGl0XG4nZScgdG8gZWRpdCBpdFxuJ2EnIHRvIGFyY2hpdmUgb3IgZGVhcmNoaXZlIGRlIGNhcmQiLCJkZXB0aCI6NSwieCI6MzgyLCJ5Ijo3NiwiY29sb3IiOiIjQUVENTgxIiwic2VsZWN0ZWQiOmZhbHNlLCJpc0FyY2hpdmVkIjpmYWxzZSwiaXNEZWxldGVkIjpmYWxzZSwiY3JlYXRlZEF0IjoxNTA3NjQ2NzcxNzQwLCJhcmNoaXZlZEF0IjpudWxsLCJub2RlIjp7ImpRdWVyeTE3MjA0MjQ3MTgxODU3MTI5NjQwNSI6OH19LHsiaWQiOjIsInRpdGxlIjoiZW50ZXJzIiwiZGVzY3JpcHRpb24iOiJXaGlsZSBlZGl0aW5nIHVzZSBzaGlmdCArIGVudGVyIHRvIFxuaW5zZXJ0XG5hXG5saW5lXG5icmVha1xuOkQiLCJkZXB0aCI6NSwieCI6MTU5LCJ5IjozMTIsImNvbG9yIjoiI0ZGQjc0RCIsInNlbGVjdGVkIjpmYWxzZSwiaXNBcmNoaXZlZCI6ZmFsc2UsImlzRGVsZXRlZCI6ZmFsc2UsImNyZWF0ZWRBdCI6MTUwNzY0Njc5MjI5NywiYXJjaGl2ZWRBdCI6bnVsbCwibm9kZSI6eyJqUXVlcnkxNzIwNDI0NzE4MTg1NzEyOTY0MDUiOjZ9fSx7ImlkIjozLCJ0aXRsZSI6IkdlbmVyaWMiLCJkZXNjcmlwdGlvbiI6IllvdSBjYW4gYWxzbyB1c2UgZ2VuZXJpYyBjb21tYW5kcyBzdWNoIGFzIGN0cmwrXG4naScgdG8gY3JlYXRlIGEgY2FyZFxuJ3onIHRvIHJldml2ZSB0aGUgbGFzdCBkZWxldGVkIGNhcmQiLCJkZXB0aCI6NSwieCI6NDQxLCJ5IjoyOTYsImNvbG9yIjoiI0ZGRTA4MiIsInNlbGVjdGVkIjpmYWxzZSwiaXNBcmNoaXZlZCI6ZmFsc2UsImlzRGVsZXRlZCI6ZmFsc2UsImNyZWF0ZWRBdCI6MTUwNzY0ODYzODM4NiwiYXJjaGl2ZWRBdCI6bnVsbCwiaXNQcmlzdGluZSI6ZmFsc2UsIm5vZGUiOnsialF1ZXJ5MTcyMDQyNDcxODE4NTcxMjk2NDA1IjoxMH19XQ',\r\n  VERSION: '0.5.0',\r\n};","const CONFIG = require('../config');\r\n\r\nlet cardManager,\r\n    Card = require('../models/Card');\r\n\r\nlet mainContainer,\r\n    editContainer,\r\n    editInput,\r\n    titleInput,\r\n    importContainer,\r\n    importInput,\r\n    exportContainer,\r\n    exportContent,\r\n    importButton;\r\n\r\n\r\nfunction init(options) {\r\n    cardManager = options.cardManager;\r\n    bindings();\r\n}\r\n\r\nfunction bindings() {\r\n    mainContainer = $('#mainContainer');\r\n    editContainer = document.getElementById('editContainer');\r\n    editInput = editContainer.getElementsByClassName('textarea')[0];\r\n    titleInput = editContainer.getElementsByClassName('input')[0];\r\n    importContainer = document.getElementById('importContainer');\r\n    importInput = importContainer.getElementsByClassName('input')[0];\r\n    importButton = importContainer.getElementsByClassName('button')[0];\r\n    exportContainer = document.getElementById('exportContainer');\r\n    exportContent = exportContainer.getElementsByTagName('div')[0];\r\n\r\n\r\n    window.addEventListener('keyup', keyHandlerUp, false);\r\n    window.addEventListener('keydown', keyHandlerDown, false);\r\n    editInput.addEventListener('keydown', editInputKeyEvent);\r\n    titleInput.addEventListener('keydown', editInputKeyEvent);\r\n    editContainer.addEventListener('click', hideEditContainer);\r\n    editInput.addEventListener('click', stopPropagation);\r\n    titleInput.addEventListener('click', stopPropagation);\r\n    /*\r\n     On double click edit the card\r\n     */\r\n    mainContainer.on('dblclick', 'div', doubleClickHandler);\r\n    /*\r\n     On click perform the card\r\n     */\r\n    mainContainer.on('click', 'div', cardClickEvents);\r\n    mainContainer.on('click', 'div > div', cardMenuEvents);\r\n    document.getElementById('export').addEventListener('click', exportCards);\r\n    document.getElementById('import').addEventListener('click', showImporter);\r\n    importButton.addEventListener('click', loadImportCardsCode);\r\n    importContainer.addEventListener('click', hideImportContainer);\r\n    importInput.addEventListener('keydown', importInputKeyEvent);\r\n    importInput.addEventListener('click', stopPropagation);\r\n    exportContainer.addEventListener('click', hideExportContainer);\r\n    exportContent.addEventListener('click', stopPropagation);\r\n}\r\n\r\nfunction keyHandlerDown(e) {\r\n\r\n    if (e.keyCode === CONFIG.ASCII.TAB_KEY) {\r\n        document.activeElement.blur();\r\n        if (event.shiftKey) {\r\n            cardManager.previousCard();\r\n        } else {\r\n            cardManager.nextCard();\r\n        }\r\n        if (e.preventDefault) {\r\n            e.preventDefault();\r\n        }\r\n    } else if (e.keyCode === CONFIG.ASCII.CMD_KEY) {\r\n        window.cmdPress = true;\r\n    }\r\n}\r\n\r\nfunction keyHandlerUp(e) {\r\n    console.log(e.keyCode);\r\n    console.log(document.activeElement);\r\n    if (document.activeElement !== document.body || CONFIG.ASCII.KEYS_ARRAY.indexOf(e.keyCode) === -1) {\r\n        return;\r\n    }\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n\r\n    switch (e.keyCode) {\r\n        case CONFIG.ASCII.C_KEY:\r\n            if (event.ctrlKey || window.cmdPress || true) {\r\n                let elem = cardManager.selectedCard.node,\r\n                    selection;\r\n\r\n                selection = selectText(elem.getElementsByClassName('cardText')[0]);\r\n                copySelectionText();\r\n                selection.empty();\r\n            }\r\n\r\n            break;\r\n        case CONFIG.ASCII.D_KEY:\r\n            if (event.ctrlKey || window.cmdPress || true) {\r\n                let card = cardManager.selectedCard;\r\n                cardManager.nextCard();\r\n\r\n                cardManager.deleteCard(card);\r\n\r\n                cardManager.saveCards();\r\n            }\r\n            break;\r\n        case CONFIG.ASCII.E_KEY:\r\n            if (event.ctrlKey || window.cmdPress || true) {\r\n                doubleClickHandler.apply(cardManager.selectedCard.node);\r\n            }\r\n            break;\r\n        case CONFIG.ASCII.A_KEY:\r\n            if (event.ctrlKey || window.cmdPress || true) {\r\n                cardManager.selectedCard.toggleArchived();\r\n            }\r\n            break;\r\n        case CONFIG.ASCII.I_KEY:\r\n            if (event.ctrlKey || window.cmdPress || true) {\r\n                // input.focus();\r\n                createCard();\r\n            }\r\n            break;\r\n        case CONFIG.ASCII.PLUS_KEY:\r\n            changeDepth.apply(cardManager.selectedCard.node, [cardManager.selectedCard.id, 1]);\r\n            break;\r\n        case CONFIG.ASCII.MINUS_KEY:\r\n            changeDepth.apply(cardManager.selectedCard.node, [cardManager.selectedCard.id, -1]);\r\n            break;\r\n        case CONFIG.ASCII.DOT_KEY:\r\n            setDepth.apply(cardManager.selectedCard.node, [cardManager.selectedCard.id, 5]);\r\n            break;\r\n        case CONFIG.ASCII.R_KEY:\r\n            cardManager.selectedCard.color = cardManager.selectedCard.getBackgroundColor();\r\n            cardManager.selectedCard.derender();\r\n            cardManager.selectedCard.render();\r\n\r\n            cardManager.saveCards();\r\n            break;\r\n        case CONFIG.ASCII.Z_KEY:\r\n            if (event.ctrlKey || window.cmdPress || true) {\r\n                cardManager.undeleteLastCard();\r\n            }\r\n            break;\r\n        case CONFIG.ASCII.CMD_KEY:\r\n            window.cmdPress = false;\r\n    }\r\n}\r\n\r\nfunction hideExportContainer() {\r\n    exportContainer.style.display = 'none';\r\n}\r\n\r\nfunction hideEditContainer() {\r\n    editContainer.style.display = 'none';\r\n}\r\n\r\nfunction hideImportContainer() {\r\n    importContainer.style.display = 'none';\r\n}\r\n\r\nfunction stopPropagation(e) {\r\n    e.stopPropagation();\r\n}\r\n\r\nfunction editInputKeyEvent(event) {\r\n    event.stopPropagation();\r\n    let card;\r\n    if (event.keyCode === 13 && event.shiftKey) return;\r\n    if (event.keyCode === 13) {\r\n        card = cardManager.cards[editContainer.cardId];\r\n        card.title = titleInput.value;\r\n        card.description = editInput.value;\r\n        card.derender();\r\n        card.render();\r\n        this.value = '';\r\n        cardManager.saveCards();\r\n        hideEditContainer();\r\n    } else if (event.keyCode === 27) {\r\n        hideEditContainer();\r\n    }\r\n\r\n}\r\n\r\nfunction importInputKeyEvent(event) {\r\n    if (event.keyCode === 27) {\r\n        hideImportContainer();\r\n    }\r\n}\r\n\r\nfunction doubleClickHandler() {\r\n    let elem = this.querySelector('.cardText'),\r\n        cardId,\r\n        card;\r\n\r\n    if (this.id === '') {\r\n        cardId = parseInt(this.parentElement.id.split('_')[1]);\r\n    } else {\r\n        cardId = parseInt(this.id.split('_')[1]);\r\n    }\r\n\r\n    card = cardManager.cards[cardId];\r\n\r\n    titleInput.value = card.title;\r\n    editInput.value = card.description;\r\n    titleInput.style.top = card.y;\r\n    titleInput.style.left = card.x;\r\n    editContainer.cardId = cardId;\r\n    editContainer.style.display = 'block';\r\n    editInput.style.top = card.y + 23;\r\n    editInput.style.left = card.x;\r\n    titleInput.focus();\r\n}\r\n\r\nfunction cardClickEvents(event) {\r\n    let elem = this.querySelector('.cardText'),\r\n        cardId,\r\n        card;\r\n\r\n    if (this.id === \"\") {\r\n        cardId = parseInt(this.parentElement.id.split('_')[1]);\r\n    } else {\r\n        cardId = parseInt(this.id.split('_')[1]);\r\n    }\r\n\r\n    card = cardManager.cards[cardId];\r\n\r\n    if (card === undefined) return;\r\n\r\n    cardManager.selectCard(card.id);\r\n\r\n    if (event.ctrlKey) {\r\n    }\r\n    if (event.altKey) {\r\n        this.querySelector('.copy').click();\r\n    }\r\n    if (event.shiftKey) {\r\n\r\n    }\r\n}\r\n\r\nfunction cardMenuEvents() {\r\n    let option = $(this).html(),\r\n        selection,\r\n        cardId = getParentCardId(this);\r\n\r\n    switch (option) {\r\n        case '+':\r\n            changeDepth.apply(this, [cardId, 1]);\r\n            break;\r\n        case '-':\r\n            changeDepth.apply(this, [cardId, -1]);\r\n            break;\r\n        case 'C':\r\n            selection = selectText(this.parentElement.getElementsByClassName('cardText')[0]);\r\n            copySelectionText();\r\n            selection.empty();\r\n            break;\r\n        case 'x':\r\n            cardManager.deleteCard(cardManager.cards[cardId]);\r\n            break;\r\n        case 'V':\r\n        case 'O':\r\n            cardManager.cards[cardId].toggleArchived();\r\n    }\r\n    cardManager.saveCards();\r\n}\r\n\r\nfunction exportCards() {\r\n    exportContainer.style.display = 'block';\r\n    exportContent.innerHTML = cardManager.exportCards();\r\n    selection = selectText(exportContent);\r\n    copySelectionText();\r\n    selection.empty();\r\n}\r\n\r\nfunction loadImportCardsCode() {\r\n    let data = importInput.value;\r\n    cardManager.importCards(data);\r\n    importContainer.style.display = 'none';\r\n}\r\n\r\nfunction showImporter() {\r\n    importContainer.style.display = 'block';\r\n    importInput.focus();\r\n}\r\n\r\nfunction createCard() {\r\n    const card = cardManager.addCard(Object.create(Card, {}).init(''));\r\n    card.render();\r\n    cardManager.selectCard(card.id);\r\n\r\n    // and now we autoedit :D\r\n    doubleClickHandler.apply(card.node);\r\n}\r\n\r\nmodule.exports = {\r\n    init: init\r\n};","\r\nvar subs = {};\r\n\r\n\r\nfunction pub(name, params) {\r\n  subs[name].forEach(function(elem) {\r\n    elem.callback.apply(elem.context, params);\r\n  });\r\n}\r\n\r\nfunction sub(name, callback, context) {\r\n  if (subs[name] === undefined) {\r\n    subs[name] = [];\r\n  }\r\n\r\n  subs[name].push({\r\n    callback: callback,\r\n    context: context\r\n  });\r\n}\r\n\r\n\r\nmodule.exports = {\r\n  pub: pub,\r\n  sub: sub\r\n};","window.CONFIG = require('./config.js');\r\n\r\nlet keyHandler = require('./lib/keyHandler'),\r\n  cardManager = require('./models/CardManager').getInstance(),\r\n  pubsub = require('./lib/pubsub');\r\n\r\nwindow.cm = {\r\n  cardManager: cardManager\r\n};\r\n\r\nObject.assign(window, require('./prototypes'));\r\n\r\n\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n  'strict mode';\r\n\r\n  keyHandler.init({\r\n    cardManager: cardManager\r\n  });\r\n\r\n  cardManager.loadCards();\r\n  cardManager.renderAllCards();\r\n});\r\n","let pubsub = require('../lib/pubsub'),\r\n    randomMC = require('random-material-color');\r\n\r\n\r\nlet Card = {\r\n    init: function (title, description, pristine) {\r\n        this.id = -1;\r\n        this.title = title;\r\n        this.description = description;\r\n        this.depth = 5;\r\n        this.x = 100;\r\n        this.y = 100;\r\n        this.color = this.getBackgroundColor();\r\n        this.selected = false;\r\n        this.isArchived = false;\r\n        this.isDeleted = false;\r\n        this.createdAt = +new Date();\r\n        this.archivedAt = null;\r\n        this.isPristine = true;\r\n\r\n        return this;\r\n    },\r\n    render: function (always = false) {\r\n        if (this.isDeleted === true && always === false) {\r\n            return;\r\n        }\r\n\r\n        let node = document.createElement('div'),\r\n            title = document.createElement('div'),\r\n            text = document.createElement('div'),\r\n            link = this.findLink(),\r\n            that = this;\r\n\r\n        if (this.title) {\r\n            if (link) {\r\n                title.innerHTML = `<a target=\"_blank\" href=\"${link}\">${this.title}</a>`;\r\n            } else {\r\n                title.innerHTML = this.title;\r\n            }\r\n        } else {\r\n            if (link) {\r\n                title.innerHTML = `<a target=\"_blank\" href=\"${link}\">Link!</a>`;\r\n            } \r\n        }\r\n\r\n        if (this.description) {\r\n            text.innerHTML = this.description.replace(/\\r?\\n/g, '<br/>');\r\n        }\r\n\r\n        title.className = 'cardTitle';\r\n        text.className = 'cardText';\r\n\r\n        node.id = 'todo_' + this.id;\r\n        node.className = 'card card-1';\r\n        node.style.position = 'fixed';\r\n        node.style.left = this.x;\r\n        node.style.top = this.y;\r\n        node.style.cursor = '-webkit-grab';\r\n        node.style.zIndex = this.depth;\r\n        node.style.backgroundColor = this.color;\r\n\r\n        document.getElementById('mainContainer').appendChild(node);\r\n\r\n        node.appendChild(createDiv('x', 'control remove'));\r\n        // node.appendChild(createDiv('+', 'control up'));\r\n        // node.appendChild(createDiv('-', 'control down'));\r\n        node.appendChild(createDiv('C', 'control copy'));\r\n        node.appendChild(createDiv('depth: ' + this.depth, 'depth'));\r\n        // node.appendChild(createDiv(this.isArchived ? 'V' : 'O', 'isArchived'));\r\n        node.appendChild(createDiv('id: ' + this.id, 'id'));\r\n\r\n        node.appendChild(title);\r\n        node.appendChild(text);\r\n\r\n        $('#todo_' + this.id).draggable({\r\n            stop: function () {\r\n                let card = $('#todo_' + that.id);\r\n\r\n                if (that.isPristine === true) {\r\n                    that.isPristine = false;\r\n\r\n                    pubsub.pub(window.CONFIG.LESS_PRISTINE);\r\n                }\r\n\r\n                that.x = + card.css('left').replace('px', '');\r\n                that.y = + card.css('top').replace('px', '');\r\n\r\n                pubsub.pub(window.CONFIG.SELECT_CARD, [that.id]);\r\n                pubsub.pub(window.CONFIG.SAVE_CARDS);\r\n            },\r\n        });\r\n\r\n        this.node = node;\r\n\r\n\r\n        if (this.selected === true) {\r\n            node.classList.add('selected');\r\n        }\r\n\r\n        if (this.isArchived) {\r\n            node.classList.add('completed');\r\n        }\r\n\r\n        return this;\r\n    },\r\n    getBackgroundColor: function () {\r\n        return randomMC.getColor({ shades: ['200', '300'] });\r\n    },\r\n    derender: function () {\r\n        let node = document.getElementById('todo_' + this.id);\r\n        document.getElementById('mainContainer').removeChild(node);\r\n\r\n        return this;\r\n    },\r\n    toggleArchived: function () {\r\n        if (this.isArchived === false || this.isArchived === undefined) {\r\n            this.node.classList.remove('notCompleted');\r\n            void this.node.offsetWidth;\r\n            this.node.classList.add('completed');\r\n            this.archivedAt = +new Date();\r\n        } else {\r\n            this.node.classList.remove('completed');\r\n            void this.node.offsetWidth;\r\n            this.node.classList.add('notCompleted');\r\n            this.archivedAt = null;\r\n        }\r\n\r\n        this.isArchived = !this.isArchived;\r\n\r\n        pubsub.pub(window.CONFIG.SAVE_CARDS);\r\n    },\r\n    delete: function () {\r\n        this.isDeleted = true;\r\n\r\n        this.derender();\r\n    },\r\n    undelete: function () {\r\n        this.isDeleted = false;\r\n\r\n        this.render();\r\n\r\n        return this;\r\n    },\r\n    findLink: function () {\r\n        const regex = /(https?:\\/\\/[^\\s]+|www.[^\\s]+)/;\r\n        let link = regex.exec(this.title);\r\n\r\n        if (link == null) {\r\n            link = regex.exec(this.description);\r\n        }\r\n\r\n        if (link) {\r\n            return link[0];\r\n        }\r\n    }\r\n};\r\n\r\nmodule.exports = Card;","const Card = require('./Card'),\r\npubsub = require('../lib/pubsub'),\r\nCONFIG = require('../config');\r\n\r\nlet CardManager = {\r\n    init: function() {\r\n        this.cards = [];\r\n        this.selectedCard = {id: -1};\r\n        this.deletedCards = [];\r\n        this.pristine = 0;\r\n\r\n        return this;\r\n    },\r\n    addCard: function(card) {\r\n        this.cards.push(card);\r\n        card.id = this.cards.length - 1;\r\n\r\n        card.x = card.x + this.pristine * 10;\r\n        card.y = card.y + this.pristine * 10;\r\n\r\n        this.pristine++;\r\n\r\n        return card;\r\n    },\r\n    removeCard: function(id) {\r\n        this.cards[id].derender();\r\n        this.cards[id] = undefined;\r\n\r\n        return this;\r\n    },\r\n    redrawCard: function(cardId, x, y) {\r\n        let card = this.cards[cardId];\r\n        card.x = x;\r\n        card.y = y;\r\n\r\n        card.derender();\r\n        card.render();\r\n\r\n        return this;\r\n    },\r\n    saveCards: function() {\r\n        if (typeof(Storage) !== 'undefined') {\r\n            localStorage.setItem('cards', JSON.stringify(this.cards));\r\n        } else {\r\n            console.log('you don\\'t have local storage :(');\r\n        }\r\n\r\n        this.persistSelectedCard();\r\n        this.persistDeletedCards();\r\n\r\n        return this;\r\n    },\r\n    loadCards: function() {\r\n        this.cards = JSON.parse(localStorage.getItem('cards'));\r\n\r\n        if (this.cards === null) {\r\n            this.cards = JSON.parse(atob(CONFIG.DEFAULT_CONTENT));\r\n        }\r\n\r\n        this.clearArray();\r\n\r\n        this.loadSelectedCard();\r\n        this.loadDeletedCards();\r\n\r\n        document.activeElement.blur();\r\n\r\n        return this;\r\n    },\r\n    clearArray: function() {\r\n        let i;\r\n\r\n        this.cards = this.cards.filter(function(elem) {\r\n            return elem !== undefined && elem !== null;\r\n        });\r\n        for (i in this.cards) {\r\n            if (this.cards.hasOwnProperty(i)) {\r\n                this.cards[+i].id = +i;\r\n            }\r\n        }\r\n\r\n        return this;\r\n    },\r\n    reRenderAllCards: function() {\r\n        this.cards.forEach((card) => {\r\n            card.derender();\r\n        });\r\n        this.renderAllCards();\r\n    },\r\n    renderAllCards: function() {\r\n\r\n        this.cards.forEach((card) => {\r\n                card.selected = this.selectedCard && (this.selectedCard.id === card.id);\r\n                Object.setPrototypeOf(card, Card);\r\n                card.render();\r\n            }\r\n        );\r\n\r\n        return this;\r\n    },\r\n    getInstance: function() {\r\n        if (CardManager.instance === undefined) {\r\n            CardManager.instance = Object.create(CardManager, {});\r\n            CardManager.instance.init();\r\n            pubsub.sub(window.CONFIG.SAVE_CARDS, CardManager.instance.saveCards, CardManager.instance);\r\n            pubsub.sub(window.CONFIG.SELECT_CARD, CardManager.instance.selectCard, CardManager.instance);\r\n            pubsub.sub(window.CONFIG.RERENDER, CardManager.instance.reRenderAllCards, CardManager.instance);\r\n            pubsub.sub(window.CONFIG.LESS_PRISTINE, CardManager.instance.lessPristine, CardManager.instance);\r\n        }\r\n\r\n        return CardManager.instance;\r\n\r\n    },\r\n    lessPristine: function() {\r\n        this.pristine--;\r\n    },\r\n    exportCards: function() {\r\n        return btoa(JSON.stringify(this.cards));\r\n    },\r\n    importCards: function(data) {\r\n        localStorage.setItem('cards', atob(data));\r\n        this.loadCards();\r\n        this.renderAllCards();\r\n    },\r\n    selectCard: function(cardId) {\r\n        if (this.selectedCard !== undefined && this.selectedCard.node.classList !== undefined) {\r\n            this.selectedCard.node.classList.remove('selected');\r\n        }\r\n        this.selectedCard = this.cards[cardId];\r\n\r\n        this.selectedCard.node.classList.add('selected');\r\n\r\n        this.persistSelectedCard();\r\n        document.activeElement.blur();\r\n    },\r\n    nextCard: function() {\r\n        let it = +this.selectedCard.id + 1;\r\n\r\n        while (it !== +this.selectedCard.id) {\r\n            if (this.cards[it] !== undefined && this.cards[it].isDeleted !== true) {\r\n                break;\r\n            }\r\n            if (++it >= this.cards.length) {\r\n                it = 0;\r\n            }\r\n        }\r\n\r\n        this.selectCard(it);\r\n    },\r\n    previousCard: function() {\r\n        let it = +this.selectedCard.id - 1;\r\n\r\n        while (it !== +this.selectedCard.id) {\r\n            if (this.cards[it] !== undefined) {\r\n                break;\r\n            }\r\n            if (--it <= 0) {\r\n                it = this.cards.length;\r\n            }\r\n        }\r\n\r\n        this.selectCard(it);\r\n    },\r\n    persistSelectedCard: function() {\r\n        if (this.selectedCard && this.selectedCard.id > -1) {\r\n            localStorage.setItem('selectedCard', this.selectedCard.id);\r\n        }\r\n    },\r\n    loadSelectedCard: function() {\r\n        let selectedCardId = +localStorage.getItem('selectedCard');\r\n\r\n        if (selectedCardId !== undefined && selectedCardId > -1) {\r\n            this.selectedCard = this.cards[selectedCardId];\r\n        }\r\n    },\r\n    persistDeletedCards: function() {\r\n        localStorage.setItem('deletedCards', JSON.stringify(this.deletedCards));\r\n    },\r\n    loadDeletedCards: function() {\r\n        this.deletedCards = JSON.parse(localStorage.getItem('deletedCards')) || [];\r\n\r\n    },\r\n    deleteCard: function(card) {\r\n        this.deletedCards.push(card.id);\r\n\r\n        card.delete();\r\n    },\r\n    undeleteLastCard: function() {\r\n        if (this.deletedCards.length === 0) {\r\n            return;\r\n        }\r\n\r\n        this.selectCard(this.cards[this.deletedCards.splice(this.deletedCards.length - 1)].undelete().id);\r\n\r\n        this.saveCards();\r\n    }\r\n};\r\n\r\nmodule.exports = CardManager;","let cardManager = require('./models/CardManager').getInstance();\r\n\r\nfunction createDiv(text, className) {\r\n    let div = document.createElement('div');\r\n    div.innerHTML = text;\r\n    div.style.float = \"right\";\r\n    div.style.cursor = \"pointer\";\r\n    div.style.width = \"auto\";\r\n    div.style.textAlign = \"center\";\r\n    div.style.margin = \"0 3px\";\r\n\r\n    if (className !== undefined) {\r\n        div.className = className;\r\n    }\r\n\r\n    return div;\r\n}\r\n\r\nfunction copySelectionText() {\r\n    let copysuccess; // let to check whether execCommand successfully executed\r\n    try {\r\n        copysuccess = document.execCommand(\"copy\"); // run command to copy selected text to clipboard\r\n    } catch (e) {\r\n        copysuccess = false\r\n    }\r\n    return copysuccess\r\n}\r\n\r\nfunction selectText(element) {\r\n    let doc = document\r\n        , text = element\r\n        , range, selection\r\n    ;\r\n    if (doc.body.createTextRange) {\r\n        range = document.body.createTextRange();\r\n        range.moveToElementText(text);\r\n        range.select();\r\n    } else if (window.getSelection) {\r\n        selection = window.getSelection();\r\n        range = document.createRange();\r\n        range.selectNodeContents(text);\r\n        selection.removeAllRanges();\r\n        selection.addRange(range);\r\n        return selection;\r\n    }\r\n}\r\n\r\nfunction getParentCardId(context) {\r\n    if (context.parentElement === null) return;\r\n    return parseInt(context.parentElement.id.split(\"_\")[1]);\r\n}\r\n\r\nfunction getSomethingByclassName(context, classname) {\r\n    let res = context.getElementsByClassName(classname);\r\n\r\n    if (res.length === 0) {\r\n        res = context.parentElement.getElementsByClassName(classname);\r\n    }\r\n\r\n    return res;\r\n}\r\n\r\nfunction changeDepth(cardId, increment) {\r\n    let depth = cardManager.cards[cardId].depth + increment;\r\n\r\n    this.style.zIndex = depth;\r\n    cardManager.cards[cardId].depth = depth;\r\n\r\n    let elem = getSomethingByclassName(this, 'depth');\r\n    elem[0].innerHTML = depth;\r\n}\r\n\r\nfunction setDepth(cardId, depth) {\r\n    this.style.zIndex = depth;\r\n    cardManager.cards[cardId].depth = depth;\r\n\r\n    let elem = getSomethingByclassName(this, 'depth');\r\n    elem[0].innerHTML = depth;\r\n}\r\n\r\nfunction getCardHTMLById(mainContainer, id) {\r\n    return mainContainer.getElementById('todo_' + id);\r\n}\r\n\r\n// PROTOTYPES\r\n\r\n/*\r\n * Returns the size of an array\r\n */\r\nArray.prototype.size = function() {\r\n    return this.filter(function(a) {\r\n        return a !== undefined;\r\n    }).length\r\n};\r\n\r\n/*\r\n * Returns the size of an object\r\n */\r\nObject.size = function(obj) {\r\n    let size = 0, key = \"\";\r\n\r\n    for (key in obj) {\r\n        if (obj.hasOwnProperty(key)) size++;\r\n    }\r\n    return size;\r\n};\r\n\r\nmodule.exports = {\r\n    createDiv: createDiv,\r\n    copySelectionText: copySelectionText,\r\n    selectText: selectText,\r\n    getParentCardId: getParentCardId,\r\n    changeDepth: changeDepth,\r\n    setDepth: setDepth,\r\n    getCardHTMLById: getCardHTMLById\r\n};"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvbXVybXVyaGFzaC1qcy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9tdXJtdXJoYXNoLWpzL211cm11cmhhc2gyX2djLmpzIiwibm9kZV9tb2R1bGVzL211cm11cmhhc2gtanMvbXVybXVyaGFzaDNfZ2MuanMiLCJub2RlX21vZHVsZXMvcmFuZG9tLW1hdGVyaWFsLWNvbG9yL2Rpc3QvcmFuZG9tQ29sb3IuanMiLCJzcmMvanMvY29uZmlnLmpzIiwic3JjL2pzL2xpYi9rZXlIYW5kbGVyLmpzIiwic3JjL2pzL2xpYi9wdWJzdWIuanMiLCJzcmMvanMvbWFpbi5qcyIsInNyYy9qcy9tb2RlbHMvQ2FyZC5qcyIsInNyYy9qcy9tb2RlbHMvQ2FyZE1hbmFnZXIuanMiLCJzcmMvanMvcHJvdG90eXBlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3REQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25FQTs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBtdXJtdXIzID0gcmVxdWlyZShcIi4vbXVybXVyaGFzaDNfZ2MuanNcIilcbnZhciBtdXJtdXIyID0gcmVxdWlyZShcIi4vbXVybXVyaGFzaDJfZ2MuanNcIilcblxubW9kdWxlLmV4cG9ydHMgPSBtdXJtdXIzXG5tb2R1bGUuZXhwb3J0cy5tdXJtdXIzID0gbXVybXVyM1xubW9kdWxlLmV4cG9ydHMubXVybXVyMiA9IG11cm11cjJcbiIsIi8qKlxuICogSlMgSW1wbGVtZW50YXRpb24gb2YgTXVybXVySGFzaDJcbiAqIFxuICogQGF1dGhvciA8YSBocmVmPVwibWFpbHRvOmdhcnkuY291cnRAZ21haWwuY29tXCI+R2FyeSBDb3VydDwvYT5cbiAqIEBzZWUgaHR0cDovL2dpdGh1Yi5jb20vZ2FyeWNvdXJ0L211cm11cmhhc2gtanNcbiAqIEBhdXRob3IgPGEgaHJlZj1cIm1haWx0bzphYXBwbGVieUBnbWFpbC5jb21cIj5BdXN0aW4gQXBwbGVieTwvYT5cbiAqIEBzZWUgaHR0cDovL3NpdGVzLmdvb2dsZS5jb20vc2l0ZS9tdXJtdXJoYXNoL1xuICogXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyIEFTQ0lJIG9ubHlcbiAqIEBwYXJhbSB7bnVtYmVyfSBzZWVkIFBvc2l0aXZlIGludGVnZXIgb25seVxuICogQHJldHVybiB7bnVtYmVyfSAzMi1iaXQgcG9zaXRpdmUgaW50ZWdlciBoYXNoXG4gKi9cblxuZnVuY3Rpb24gbXVybXVyaGFzaDJfMzJfZ2Moc3RyLCBzZWVkKSB7XG4gIHZhclxuICAgIGwgPSBzdHIubGVuZ3RoLFxuICAgIGggPSBzZWVkIF4gbCxcbiAgICBpID0gMCxcbiAgICBrO1xuICBcbiAgd2hpbGUgKGwgPj0gNCkge1xuICBcdGsgPSBcbiAgXHQgICgoc3RyLmNoYXJDb2RlQXQoaSkgJiAweGZmKSkgfFxuICBcdCAgKChzdHIuY2hhckNvZGVBdCgrK2kpICYgMHhmZikgPDwgOCkgfFxuICBcdCAgKChzdHIuY2hhckNvZGVBdCgrK2kpICYgMHhmZikgPDwgMTYpIHxcbiAgXHQgICgoc3RyLmNoYXJDb2RlQXQoKytpKSAmIDB4ZmYpIDw8IDI0KTtcbiAgICBcbiAgICBrID0gKCgoayAmIDB4ZmZmZikgKiAweDViZDFlOTk1KSArICgoKChrID4+PiAxNikgKiAweDViZDFlOTk1KSAmIDB4ZmZmZikgPDwgMTYpKTtcbiAgICBrIF49IGsgPj4+IDI0O1xuICAgIGsgPSAoKChrICYgMHhmZmZmKSAqIDB4NWJkMWU5OTUpICsgKCgoKGsgPj4+IDE2KSAqIDB4NWJkMWU5OTUpICYgMHhmZmZmKSA8PCAxNikpO1xuXG5cdGggPSAoKChoICYgMHhmZmZmKSAqIDB4NWJkMWU5OTUpICsgKCgoKGggPj4+IDE2KSAqIDB4NWJkMWU5OTUpICYgMHhmZmZmKSA8PCAxNikpIF4gaztcblxuICAgIGwgLT0gNDtcbiAgICArK2k7XG4gIH1cbiAgXG4gIHN3aXRjaCAobCkge1xuICBjYXNlIDM6IGggXj0gKHN0ci5jaGFyQ29kZUF0KGkgKyAyKSAmIDB4ZmYpIDw8IDE2O1xuICBjYXNlIDI6IGggXj0gKHN0ci5jaGFyQ29kZUF0KGkgKyAxKSAmIDB4ZmYpIDw8IDg7XG4gIGNhc2UgMTogaCBePSAoc3RyLmNoYXJDb2RlQXQoaSkgJiAweGZmKTtcbiAgICAgICAgICBoID0gKCgoaCAmIDB4ZmZmZikgKiAweDViZDFlOTk1KSArICgoKChoID4+PiAxNikgKiAweDViZDFlOTk1KSAmIDB4ZmZmZikgPDwgMTYpKTtcbiAgfVxuXG4gIGggXj0gaCA+Pj4gMTM7XG4gIGggPSAoKChoICYgMHhmZmZmKSAqIDB4NWJkMWU5OTUpICsgKCgoKGggPj4+IDE2KSAqIDB4NWJkMWU5OTUpICYgMHhmZmZmKSA8PCAxNikpO1xuICBoIF49IGggPj4+IDE1O1xuXG4gIHJldHVybiBoID4+PiAwO1xufVxuXG5pZih0eXBlb2YgbW9kdWxlICE9PSB1bmRlZmluZWQpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSBtdXJtdXJoYXNoMl8zMl9nY1xufVxuIiwiLyoqXG4gKiBKUyBJbXBsZW1lbnRhdGlvbiBvZiBNdXJtdXJIYXNoMyAocjEzNikgKGFzIG9mIE1heSAyMCwgMjAxMSlcbiAqIFxuICogQGF1dGhvciA8YSBocmVmPVwibWFpbHRvOmdhcnkuY291cnRAZ21haWwuY29tXCI+R2FyeSBDb3VydDwvYT5cbiAqIEBzZWUgaHR0cDovL2dpdGh1Yi5jb20vZ2FyeWNvdXJ0L211cm11cmhhc2gtanNcbiAqIEBhdXRob3IgPGEgaHJlZj1cIm1haWx0bzphYXBwbGVieUBnbWFpbC5jb21cIj5BdXN0aW4gQXBwbGVieTwvYT5cbiAqIEBzZWUgaHR0cDovL3NpdGVzLmdvb2dsZS5jb20vc2l0ZS9tdXJtdXJoYXNoL1xuICogXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IEFTQ0lJIG9ubHlcbiAqIEBwYXJhbSB7bnVtYmVyfSBzZWVkIFBvc2l0aXZlIGludGVnZXIgb25seVxuICogQHJldHVybiB7bnVtYmVyfSAzMi1iaXQgcG9zaXRpdmUgaW50ZWdlciBoYXNoIFxuICovXG5cbmZ1bmN0aW9uIG11cm11cmhhc2gzXzMyX2djKGtleSwgc2VlZCkge1xuXHR2YXIgcmVtYWluZGVyLCBieXRlcywgaDEsIGgxYiwgYzEsIGMxYiwgYzIsIGMyYiwgazEsIGk7XG5cdFxuXHRyZW1haW5kZXIgPSBrZXkubGVuZ3RoICYgMzsgLy8ga2V5Lmxlbmd0aCAlIDRcblx0Ynl0ZXMgPSBrZXkubGVuZ3RoIC0gcmVtYWluZGVyO1xuXHRoMSA9IHNlZWQ7XG5cdGMxID0gMHhjYzllMmQ1MTtcblx0YzIgPSAweDFiODczNTkzO1xuXHRpID0gMDtcblx0XG5cdHdoaWxlIChpIDwgYnl0ZXMpIHtcblx0ICBcdGsxID0gXG5cdCAgXHQgICgoa2V5LmNoYXJDb2RlQXQoaSkgJiAweGZmKSkgfFxuXHQgIFx0ICAoKGtleS5jaGFyQ29kZUF0KCsraSkgJiAweGZmKSA8PCA4KSB8XG5cdCAgXHQgICgoa2V5LmNoYXJDb2RlQXQoKytpKSAmIDB4ZmYpIDw8IDE2KSB8XG5cdCAgXHQgICgoa2V5LmNoYXJDb2RlQXQoKytpKSAmIDB4ZmYpIDw8IDI0KTtcblx0XHQrK2k7XG5cdFx0XG5cdFx0azEgPSAoKCgoazEgJiAweGZmZmYpICogYzEpICsgKCgoKGsxID4+PiAxNikgKiBjMSkgJiAweGZmZmYpIDw8IDE2KSkpICYgMHhmZmZmZmZmZjtcblx0XHRrMSA9IChrMSA8PCAxNSkgfCAoazEgPj4+IDE3KTtcblx0XHRrMSA9ICgoKChrMSAmIDB4ZmZmZikgKiBjMikgKyAoKCgoazEgPj4+IDE2KSAqIGMyKSAmIDB4ZmZmZikgPDwgMTYpKSkgJiAweGZmZmZmZmZmO1xuXG5cdFx0aDEgXj0gazE7XG4gICAgICAgIGgxID0gKGgxIDw8IDEzKSB8IChoMSA+Pj4gMTkpO1xuXHRcdGgxYiA9ICgoKChoMSAmIDB4ZmZmZikgKiA1KSArICgoKChoMSA+Pj4gMTYpICogNSkgJiAweGZmZmYpIDw8IDE2KSkpICYgMHhmZmZmZmZmZjtcblx0XHRoMSA9ICgoKGgxYiAmIDB4ZmZmZikgKyAweDZiNjQpICsgKCgoKGgxYiA+Pj4gMTYpICsgMHhlNjU0KSAmIDB4ZmZmZikgPDwgMTYpKTtcblx0fVxuXHRcblx0azEgPSAwO1xuXHRcblx0c3dpdGNoIChyZW1haW5kZXIpIHtcblx0XHRjYXNlIDM6IGsxIF49IChrZXkuY2hhckNvZGVBdChpICsgMikgJiAweGZmKSA8PCAxNjtcblx0XHRjYXNlIDI6IGsxIF49IChrZXkuY2hhckNvZGVBdChpICsgMSkgJiAweGZmKSA8PCA4O1xuXHRcdGNhc2UgMTogazEgXj0gKGtleS5jaGFyQ29kZUF0KGkpICYgMHhmZik7XG5cdFx0XG5cdFx0azEgPSAoKChrMSAmIDB4ZmZmZikgKiBjMSkgKyAoKCgoazEgPj4+IDE2KSAqIGMxKSAmIDB4ZmZmZikgPDwgMTYpKSAmIDB4ZmZmZmZmZmY7XG5cdFx0azEgPSAoazEgPDwgMTUpIHwgKGsxID4+PiAxNyk7XG5cdFx0azEgPSAoKChrMSAmIDB4ZmZmZikgKiBjMikgKyAoKCgoazEgPj4+IDE2KSAqIGMyKSAmIDB4ZmZmZikgPDwgMTYpKSAmIDB4ZmZmZmZmZmY7XG5cdFx0aDEgXj0gazE7XG5cdH1cblx0XG5cdGgxIF49IGtleS5sZW5ndGg7XG5cblx0aDEgXj0gaDEgPj4+IDE2O1xuXHRoMSA9ICgoKGgxICYgMHhmZmZmKSAqIDB4ODVlYmNhNmIpICsgKCgoKGgxID4+PiAxNikgKiAweDg1ZWJjYTZiKSAmIDB4ZmZmZikgPDwgMTYpKSAmIDB4ZmZmZmZmZmY7XG5cdGgxIF49IGgxID4+PiAxMztcblx0aDEgPSAoKCgoaDEgJiAweGZmZmYpICogMHhjMmIyYWUzNSkgKyAoKCgoaDEgPj4+IDE2KSAqIDB4YzJiMmFlMzUpICYgMHhmZmZmKSA8PCAxNikpKSAmIDB4ZmZmZmZmZmY7XG5cdGgxIF49IGgxID4+PiAxNjtcblxuXHRyZXR1cm4gaDEgPj4+IDA7XG59XG5cbmlmKHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSBtdXJtdXJoYXNoM18zMl9nY1xufSIsInZhciBkZWZhdWx0UGFsZXR0ZT17NTA6W1wiI0ZGRUJFRVwiLFwiI0ZDRTRFQ1wiLFwiI0YzRTVGNVwiLFwiI0VERTdGNlwiLFwiI0U4RUFGNlwiLFwiI0UzRjJGRFwiLFwiI0UxRjVGRVwiLFwiI0UwRjdGQVwiLFwiI0UwRjJGMVwiLFwiI0U4RjVFOVwiLFwiI0YxRjhFOVwiLFwiI0Y5RkJFN1wiLFwiI0ZGRkRFN1wiLFwiI0ZGRjhFMVwiLFwiI0ZGRjNFMFwiLFwiI0ZCRTlFN1wiLFwiI0VGRUJFOVwiLFwiI0ZBRkFGQVwiLFwiI0VDRUZGMVwiXSwxMDA6W1wiI0ZGQ0REMlwiLFwiI0Y4QkJEMFwiLFwiI0UxQkVFN1wiLFwiI0QxQzRFOVwiLFwiI0M1Q0FFOVwiLFwiI0JCREVGQlwiLFwiI0IzRTVGQ1wiLFwiI0IyRUJGMlwiLFwiI0IyREZEQlwiLFwiI0M4RTZDOVwiLFwiI0RDRURDOFwiLFwiI0YwRjRDM1wiLFwiI0ZGRjlDNFwiLFwiI0ZGRUNCM1wiLFwiI0ZGRTBCMlwiLFwiI0ZGQ0NCQ1wiLFwiI0Q3Q0NDOFwiLFwiI0Y1RjVGNVwiLFwiI0NGRDhEQ1wiXSwyMDA6W1wiI0VGOUE5QVwiLFwiI0Y0OEZCMVwiLFwiI0NFOTNEOFwiLFwiI0IzOUREQlwiLFwiIzlGQThEQVwiLFwiIzkwQ0FGOVwiLFwiIzgxRDRGQVwiLFwiIzgwREVFQVwiLFwiIzgwQ0JDNFwiLFwiI0E1RDZBN1wiLFwiI0M1RTFBNVwiLFwiI0U2RUU5Q1wiLFwiI0ZGRjU5RFwiLFwiI0ZGRTA4MlwiLFwiI0ZGQ0M4MFwiLFwiI0ZGQUI5MVwiLFwiI0JDQUFBNFwiLFwiI0VFRUVFRVwiLFwiI0IwQkVDNVwiXSwzMDA6W1wiI0U1NzM3M1wiLFwiI0YwNjI5MlwiLFwiI0JBNjhDOFwiLFwiIzk1NzVDRFwiLFwiIzc5ODZDQlwiLFwiIzY0QjVGNlwiLFwiIzRGQzNGN1wiLFwiIzRERDBFMVwiLFwiIzREQjZBQ1wiLFwiIzgxQzc4NFwiLFwiI0FFRDU4MVwiLFwiI0RDRTc3NVwiLFwiI0ZGRjE3NlwiLFwiI0ZGRDU0RlwiLFwiI0ZGQjc0RFwiLFwiI0ZGOEE2NVwiLFwiI0ExODg3RlwiLFwiI0UwRTBFMFwiLFwiIzkwQTRBRVwiXSw0MDA6W1wiI0VGNTM1MFwiLFwiI0VDNDA3QVwiLFwiI0FCNDdCQ1wiLFwiIzdFNTdDMlwiLFwiIzVDNkJDMFwiLFwiIzQyQTVGNVwiLFwiIzI5QjZGNlwiLFwiIzI2QzZEQVwiLFwiIzI2QTY5QVwiLFwiIzY2QkI2QVwiLFwiIzlDQ0M2NVwiLFwiI0Q0RTE1N1wiLFwiI0ZGRUU1OFwiLFwiI0ZGQ0EyOFwiLFwiI0ZGQTcyNlwiLFwiI0ZGNzA0M1wiLFwiIzhENkU2M1wiLFwiI0JEQkRCRFwiLFwiIzc4OTA5Q1wiXSw1MDA6W1wiI0Y0NDMzNlwiLFwiI0U5MUU2M1wiLFwiIzlDMjdCMFwiLFwiIzY3M0FCN1wiLFwiIzNGNTFCNVwiLFwiIzIxOTZGM1wiLFwiIzAzQTlGNFwiLFwiIzAwQkNENFwiLFwiIzAwOTY4OFwiLFwiIzRDQUY1MFwiLFwiIzhCQzM0QVwiLFwiI0NEREMzOVwiLFwiI0ZGRUIzQlwiLFwiI0ZGQzEwN1wiLFwiI0ZGOTgwMFwiLFwiI0ZGNTcyMlwiLFwiIzc5NTU0OFwiLFwiIzlFOUU5RVwiLFwiIzYwN0Q4QlwiXSw2MDA6W1wiI0U1MzkzNVwiLFwiI0Q4MUI2MFwiLFwiIzhFMjRBQVwiLFwiIzVFMzVCMVwiLFwiIzM5NDlBQlwiLFwiIzFFODhFNVwiLFwiIzAzOUJFNVwiLFwiIzAwQUNDMVwiLFwiIzAwODk3QlwiLFwiIzQzQTA0N1wiLFwiIzdDQjM0MlwiLFwiI0MwQ0EzM1wiLFwiI0ZERDgzNVwiLFwiI0ZGQjMwMFwiLFwiI0ZCOEMwMFwiLFwiI0Y0NTExRVwiLFwiIzZENEM0MVwiLFwiIzc1NzU3NVwiLFwiIzU0NkU3QVwiXSw3MDA6W1wiI0QzMkYyRlwiLFwiI0MyMTg1QlwiLFwiIzdCMUZBMlwiLFwiIzUxMkRBOFwiLFwiIzMwM0Y5RlwiLFwiIzE5NzZEMlwiLFwiIzAyODhEMVwiLFwiIzAwOTdBN1wiLFwiIzAwNzk2QlwiLFwiIzM4OEUzQ1wiLFwiIzY4OUYzOFwiLFwiI0FGQjQyQlwiLFwiI0ZCQzAyRFwiLFwiI0ZGQTAwMFwiLFwiI0Y1N0MwMFwiLFwiI0U2NEExOVwiLFwiIzVENDAzN1wiLFwiIzYxNjE2MVwiLFwiIzQ1NUE2NFwiXSw4MDA6W1wiI0M2MjgyOFwiLFwiI0FEMTQ1N1wiLFwiIzZBMUI5QVwiLFwiIzQ1MjdBMFwiLFwiIzI4MzU5M1wiLFwiIzE1NjVDMFwiLFwiIzAyNzdCRFwiLFwiIzAwODM4RlwiLFwiIzAwNjk1Q1wiLFwiIzJFN0QzMlwiLFwiIzU1OEIyRlwiLFwiIzlFOUQyNFwiLFwiI0Y5QTgyNVwiLFwiI0ZGOEYwMFwiLFwiI0VGNkMwMFwiLFwiI0Q4NDMxNVwiLFwiIzRFMzQyRVwiLFwiIzQyNDI0MlwiLFwiIzM3NDc0RlwiXSw5MDA6W1wiI0I3MUMxQ1wiLFwiIzg4MEU0RlwiLFwiIzRBMTQ4Q1wiLFwiIzMxMUI5MlwiLFwiIzFBMjM3RVwiLFwiIzBENDdBMVwiLFwiIzAxNTc5QlwiLFwiIzAwNjA2NFwiLFwiIzAwNEQ0MFwiLFwiIzFCNUUyMFwiLFwiIzMzNjkxRVwiLFwiIzgyNzcxN1wiLFwiI0Y1N0YxN1wiLFwiI0ZGNkYwMFwiLFwiI0U2NTEwMFwiLFwiI0JGMzYwQ1wiLFwiIzNFMjcyM1wiLFwiIzIxMjEyMVwiLFwiIzI2MzIzOFwiXSxBMTAwOltcIiNGRjhBODBcIixcIiNGRjgwQUJcIixcIiNFQTgwRkNcIixcIiNCMzg4RkZcIixcIiM4QzlFRkZcIixcIiM4MkIxRkZcIixcIiM4MEQ4RkZcIixcIiM4NEZGRkZcIixcIiNBN0ZGRUJcIixcIiNCOUY2Q0FcIixcIiNDQ0ZGOTBcIixcIiNGNEZGODFcIixcIiNGRkZGOERcIixcIiNGRkU1N0ZcIixcIiNGRkQxODBcIixcIiNGRjlFODBcIl0sQTIwMDpbXCIjRkY1MjUyXCIsXCIjRkY0MDgxXCIsXCIjRTA0MEZCXCIsXCIjN0M0REZGXCIsXCIjNTM2REZFXCIsXCIjNDQ4QUZGXCIsXCIjNDBDNEZGXCIsXCIjMThGRkZGXCIsXCIjNjRGRkRBXCIsXCIjNjlGMEFFXCIsXCIjQjJGRjU5XCIsXCIjRUVGRjQxXCIsXCIjRkZGRjAwXCIsXCIjRkZENzQwXCIsXCIjRkZBQjQwXCIsXCIjRkY2RTQwXCJdLEE0MDA6W1wiI0ZGMTc0NFwiLFwiI0Y1MDA1N1wiLFwiI0Q1MDBGOVwiLFwiIzY1MUZGRlwiLFwiIzNENUFGRVwiLFwiIzI5NzlGRlwiLFwiIzAwQjBGRlwiLFwiIzAwRTVGRlwiLFwiIzFERTlCNlwiLFwiIzAwRTY3NlwiLFwiIzc2RkYwM1wiLFwiI0M2RkYwMFwiLFwiI0ZGRUEwMFwiLFwiI0ZGQzQwMFwiLFwiI0ZGOTEwMFwiLFwiI0ZGM0QwMFwiXSxBNzAwOltcIiNENTAwMDBcIixcIiNDNTExNjJcIixcIiNBQTAwRkZcIixcIiM2MjAwRUFcIixcIiMzMDRGRkVcIixcIiMyOTYyRkZcIixcIiMwMDkxRUFcIixcIiMwMEI4RDRcIixcIiMwMEJGQTVcIixcIiMwMEM4NTNcIixcIiM2NEREMTdcIixcIiNBRUVBMDBcIixcIiNGRkQ2MDBcIixcIiNGRkFCMDBcIixcIiNGRjZEMDBcIixcIiNERDJDMDBcIl19LG11cm11cj1yZXF1aXJlKFwibXVybXVyaGFzaC1qc1wiKTttb2R1bGUuZXhwb3J0cz1mdW5jdGlvbigpe3ZhciBGPVtdLEU9e3NoYWRlczpbXCI1MDBcIl0scGFsZXR0ZTpkZWZhdWx0UGFsZXR0ZSx0ZXh0Om51bGwsaWdub3JlQ29sb3JzOltdfSxDPWZ1bmN0aW9uKEMpe0N8fChDPUUpLEMucGFsZXR0ZXx8KEMucGFsZXR0ZT1kZWZhdWx0UGFsZXR0ZSksQy5zaGFkZXN8fChDLnNoYWRlcz1bXCI1MDBcIl0pO2Zvcih2YXIgQixEPUYubGVuZ3RoLHQ9MDtEPnQ7dCsrKWlmKEMudGV4dCYmRlt0XS50ZXh0PT09Qy50ZXh0KXJldHVybiBGW3RdLmNvbG9yO3JldHVybiBCPUEoQyksQy50ZXh0JiZGLnB1c2goe3RleHQ6Qy50ZXh0LGNvbG9yOkJ9KSxCfSxBPWZ1bmN0aW9uKEYpe3ZhciBFPUYuc2hhZGVzW0IoRi5zaGFkZXMubGVuZ3RoKV0sQz1cIlwiO2Zvcih2YXIgQSBpbiBGLnBhbGV0dGUpRi5wYWxldHRlLmhhc093blByb3BlcnR5KEEpJiZBPT09RSYmKEM9Ri50ZXh0P0YucGFsZXR0ZVtBXVtEKEYudGV4dCxGLnBhbGV0dGVbQV0ubGVuZ3RoKV06Ri5wYWxldHRlW0FdW0IoRi5wYWxldHRlW0FdLmxlbmd0aCldKTtyZXR1cm4gQ30sQj1mdW5jdGlvbihGKXtyZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKkYpfSxEPWZ1bmN0aW9uKEYsRSl7dmFyIEM9bXVybXVyLm11cm11cjMoRikvMWUxMDtyZXR1cm4uMT5DJiYoQz0xMCpDKSxNYXRoLmZsb29yKEMqRSl9O3JldHVybntnZXRDb2xvcjpDfX0oKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHtcclxuICBTQVZFX0NBUkRTOiAnU0FWRV9DQVJEUycsXHJcbiAgU0VMRUNUX0NBUkQ6ICdTRUxFQ1RfQ0FSRCcsXHJcbiAgUkVSRU5ERVI6ICdSRVJFTkRFUicsXHJcbiAgTEVTU19QUklTVElORTogJ0xFU1NfUFJJU1RJTkUnLFxyXG4gIEFTQ0lJOiB7XHJcbiAgICBFU0NBUEVfS0VZOiAyNyxcclxuICAgIFRBQl9LRVk6IDksXHJcbiAgICBDX0tFWTogNjcsXHJcbiAgICBEX0tFWTogNjgsXHJcbiAgICBFX0tFWTogNjksXHJcbiAgICBQTFVTX0tFWTogMTg3LFxyXG4gICAgTUlOVVNfS0VZOiAxODksXHJcbiAgICBET1RfS0VZOiAxOTAsXHJcbiAgICBBX0tFWTogNjUsXHJcbiAgICBJX0tFWTogNzMsXHJcbiAgICBSX0tFWTogODIsXHJcbiAgICBaX0tFWTogOTAsXHJcbiAgICBDTURfS0VZOiA5MSxcclxuICAgIEtFWVNfQVJSQVk6IFsyNywgOSwgNjcsIDY4LCA2OSwgMTg3LCAxODksIDE5MCwgNjUsIDczLCA4MiwgOTAsIDkxXSxcclxuICB9LFxyXG4gIERFRkFVTFRfQ09OVEVOVDogJ1czc2lhV1FpT2pBc0luUnBkR3hsSWpvaU1TSXNJbVJsYzJOeWFYQjBhVzl1SWpvaVZYTmxJSFJoWWlCaGJtUWdjMmhwWm5RZ2RHRmlJSFJ2SUdOcGNtTnNaU0JpWlhSM1pXVnVJR05oY21SeklEcEVYRzVjYmtSeVlXZG5hVzVuSUc5eUlHTnNhV05yYVc1bklIUm9aVzBnZDJsc2JDQmhiSE52SUcxaGNtc2dkR2hsYlNCaGN5QnpaV3hsWTNSbFpDSXNJbVJsY0hSb0lqbzFMQ0o0SWpveE5qa3NJbmtpT2pjNUxDSmpiMnh2Y2lJNklpTkJOVVEyUVRjaUxDSnpaV3hsWTNSbFpDSTZkSEoxWlN3aWFYTkJjbU5vYVhabFpDSTZabUZzYzJVc0ltbHpSR1ZzWlhSbFpDSTZabUZzYzJVc0ltTnlaV0YwWldSQmRDSTZNVFV3TnpZME5qYzFPREU0Tml3aVlYSmphR2wyWldSQmRDSTZiblZzYkN3aWJtOWtaU0k2ZXlKcVVYVmxjbmt4TnpJd05ESTBOekU0TVRnMU56RXlPVFkwTURVaU9qUjlmU3g3SW1sa0lqb3hMQ0owYVhSc1pTSTZJaklpTENKa1pYTmpjbWx3ZEdsdmJpSTZJazl1SUdFZ2JXRnlhMlZrSUdOaGNtUWdkWE5sSUdOMGNtd2dLenBjYmlkakp5QjBieUJqYjNCNUlIUm9aU0JqYjI1MFpXNTBYRzRuWkNjZ2RHOGdaR1ZzWlhSbElHbDBYRzRuWlNjZ2RHOGdaV1JwZENCcGRGeHVKMkVuSUhSdklHRnlZMmhwZG1VZ2IzSWdaR1ZoY21Ob2FYWmxJR1JsSUdOaGNtUWlMQ0prWlhCMGFDSTZOU3dpZUNJNk16Z3lMQ0o1SWpvM05pd2lZMjlzYjNJaU9pSWpRVVZFTlRneElpd2ljMlZzWldOMFpXUWlPbVpoYkhObExDSnBjMEZ5WTJocGRtVmtJanBtWVd4elpTd2lhWE5FWld4bGRHVmtJanBtWVd4elpTd2lZM0psWVhSbFpFRjBJam94TlRBM05qUTJOemN4TnpRd0xDSmhjbU5vYVhabFpFRjBJanB1ZFd4c0xDSnViMlJsSWpwN0ltcFJkV1Z5ZVRFM01qQTBNalEzTVRneE9EVTNNVEk1TmpRd05TSTZPSDE5TEhzaWFXUWlPaklzSW5ScGRHeGxJam9pWlc1MFpYSnpJaXdpWkdWelkzSnBjSFJwYjI0aU9pSlhhR2xzWlNCbFpHbDBhVzVuSUhWelpTQnphR2xtZENBcklHVnVkR1Z5SUhSdklGeHVhVzV6WlhKMFhHNWhYRzVzYVc1bFhHNWljbVZoYTF4dU9rUWlMQ0prWlhCMGFDSTZOU3dpZUNJNk1UVTVMQ0o1SWpvek1USXNJbU52Ykc5eUlqb2lJMFpHUWpjMFJDSXNJbk5sYkdWamRHVmtJanBtWVd4elpTd2lhWE5CY21Ob2FYWmxaQ0k2Wm1Gc2MyVXNJbWx6UkdWc1pYUmxaQ0k2Wm1Gc2MyVXNJbU55WldGMFpXUkJkQ0k2TVRVd056WTBOamM1TWpJNU55d2lZWEpqYUdsMlpXUkJkQ0k2Ym5Wc2JDd2libTlrWlNJNmV5SnFVWFZsY25reE56SXdOREkwTnpFNE1UZzFOekV5T1RZME1EVWlPalo5ZlN4N0ltbGtJam96TENKMGFYUnNaU0k2SWtkbGJtVnlhV01pTENKa1pYTmpjbWx3ZEdsdmJpSTZJbGx2ZFNCallXNGdZV3h6YnlCMWMyVWdaMlZ1WlhKcFl5QmpiMjF0WVc1a2N5QnpkV05vSUdGeklHTjBjbXdyWEc0bmFTY2dkRzhnWTNKbFlYUmxJR0VnWTJGeVpGeHVKM29uSUhSdklISmxkbWwyWlNCMGFHVWdiR0Z6ZENCa1pXeGxkR1ZrSUdOaGNtUWlMQ0prWlhCMGFDSTZOU3dpZUNJNk5EUXhMQ0o1SWpveU9UWXNJbU52Ykc5eUlqb2lJMFpHUlRBNE1pSXNJbk5sYkdWamRHVmtJanBtWVd4elpTd2lhWE5CY21Ob2FYWmxaQ0k2Wm1Gc2MyVXNJbWx6UkdWc1pYUmxaQ0k2Wm1Gc2MyVXNJbU55WldGMFpXUkJkQ0k2TVRVd056WTBPRFl6T0RNNE5pd2lZWEpqYUdsMlpXUkJkQ0k2Ym5Wc2JDd2lhWE5RY21semRHbHVaU0k2Wm1Gc2MyVXNJbTV2WkdVaU9uc2lhbEYxWlhKNU1UY3lNRFF5TkRjeE9ERTROVGN4TWprMk5EQTFJam94TUgxOVhRJyxcclxuICBWRVJTSU9OOiAnMC41LjAnLFxyXG59OyIsImNvbnN0IENPTkZJRyA9IHJlcXVpcmUoJy4uL2NvbmZpZycpO1xyXG5cclxubGV0IGNhcmRNYW5hZ2VyLFxyXG4gICAgQ2FyZCA9IHJlcXVpcmUoJy4uL21vZGVscy9DYXJkJyk7XHJcblxyXG5sZXQgbWFpbkNvbnRhaW5lcixcclxuICAgIGVkaXRDb250YWluZXIsXHJcbiAgICBlZGl0SW5wdXQsXHJcbiAgICB0aXRsZUlucHV0LFxyXG4gICAgaW1wb3J0Q29udGFpbmVyLFxyXG4gICAgaW1wb3J0SW5wdXQsXHJcbiAgICBleHBvcnRDb250YWluZXIsXHJcbiAgICBleHBvcnRDb250ZW50LFxyXG4gICAgaW1wb3J0QnV0dG9uO1xyXG5cclxuXHJcbmZ1bmN0aW9uIGluaXQob3B0aW9ucykge1xyXG4gICAgY2FyZE1hbmFnZXIgPSBvcHRpb25zLmNhcmRNYW5hZ2VyO1xyXG4gICAgYmluZGluZ3MoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gYmluZGluZ3MoKSB7XHJcbiAgICBtYWluQ29udGFpbmVyID0gJCgnI21haW5Db250YWluZXInKTtcclxuICAgIGVkaXRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdENvbnRhaW5lcicpO1xyXG4gICAgZWRpdElucHV0ID0gZWRpdENvbnRhaW5lci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd0ZXh0YXJlYScpWzBdO1xyXG4gICAgdGl0bGVJbnB1dCA9IGVkaXRDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnaW5wdXQnKVswXTtcclxuICAgIGltcG9ydENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbXBvcnRDb250YWluZXInKTtcclxuICAgIGltcG9ydElucHV0ID0gaW1wb3J0Q29udGFpbmVyLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2lucHV0JylbMF07XHJcbiAgICBpbXBvcnRCdXR0b24gPSBpbXBvcnRDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnV0dG9uJylbMF07XHJcbiAgICBleHBvcnRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXhwb3J0Q29udGFpbmVyJyk7XHJcbiAgICBleHBvcnRDb250ZW50ID0gZXhwb3J0Q29udGFpbmVyLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdkaXYnKVswXTtcclxuXHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywga2V5SGFuZGxlclVwLCBmYWxzZSk7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGtleUhhbmRsZXJEb3duLCBmYWxzZSk7XHJcbiAgICBlZGl0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGVkaXRJbnB1dEtleUV2ZW50KTtcclxuICAgIHRpdGxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGVkaXRJbnB1dEtleUV2ZW50KTtcclxuICAgIGVkaXRDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoaWRlRWRpdENvbnRhaW5lcik7XHJcbiAgICBlZGl0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdG9wUHJvcGFnYXRpb24pO1xyXG4gICAgdGl0bGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN0b3BQcm9wYWdhdGlvbik7XHJcbiAgICAvKlxyXG4gICAgIE9uIGRvdWJsZSBjbGljayBlZGl0IHRoZSBjYXJkXHJcbiAgICAgKi9cclxuICAgIG1haW5Db250YWluZXIub24oJ2RibGNsaWNrJywgJ2RpdicsIGRvdWJsZUNsaWNrSGFuZGxlcik7XHJcbiAgICAvKlxyXG4gICAgIE9uIGNsaWNrIHBlcmZvcm0gdGhlIGNhcmRcclxuICAgICAqL1xyXG4gICAgbWFpbkNvbnRhaW5lci5vbignY2xpY2snLCAnZGl2JywgY2FyZENsaWNrRXZlbnRzKTtcclxuICAgIG1haW5Db250YWluZXIub24oJ2NsaWNrJywgJ2RpdiA+IGRpdicsIGNhcmRNZW51RXZlbnRzKTtcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHBvcnQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV4cG9ydENhcmRzKTtcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbXBvcnQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNob3dJbXBvcnRlcik7XHJcbiAgICBpbXBvcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBsb2FkSW1wb3J0Q2FyZHNDb2RlKTtcclxuICAgIGltcG9ydENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhpZGVJbXBvcnRDb250YWluZXIpO1xyXG4gICAgaW1wb3J0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGltcG9ydElucHV0S2V5RXZlbnQpO1xyXG4gICAgaW1wb3J0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdG9wUHJvcGFnYXRpb24pO1xyXG4gICAgZXhwb3J0Q29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGlkZUV4cG9ydENvbnRhaW5lcik7XHJcbiAgICBleHBvcnRDb250ZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3RvcFByb3BhZ2F0aW9uKTtcclxufVxyXG5cclxuZnVuY3Rpb24ga2V5SGFuZGxlckRvd24oZSkge1xyXG5cclxuICAgIGlmIChlLmtleUNvZGUgPT09IENPTkZJRy5BU0NJSS5UQUJfS0VZKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7XHJcbiAgICAgICAgaWYgKGV2ZW50LnNoaWZ0S2V5KSB7XHJcbiAgICAgICAgICAgIGNhcmRNYW5hZ2VyLnByZXZpb3VzQ2FyZCgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNhcmRNYW5hZ2VyLm5leHRDYXJkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gQ09ORklHLkFTQ0lJLkNNRF9LRVkpIHtcclxuICAgICAgICB3aW5kb3cuY21kUHJlc3MgPSB0cnVlO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBrZXlIYW5kbGVyVXAoZSkge1xyXG4gICAgY29uc29sZS5sb2coZS5rZXlDb2RlKTtcclxuICAgIGNvbnNvbGUubG9nKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpO1xyXG4gICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgIT09IGRvY3VtZW50LmJvZHkgfHwgQ09ORklHLkFTQ0lJLktFWVNfQVJSQVkuaW5kZXhPZihlLmtleUNvZGUpID09PSAtMSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgc3dpdGNoIChlLmtleUNvZGUpIHtcclxuICAgICAgICBjYXNlIENPTkZJRy5BU0NJSS5DX0tFWTpcclxuICAgICAgICAgICAgaWYgKGV2ZW50LmN0cmxLZXkgfHwgd2luZG93LmNtZFByZXNzIHx8IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlbGVtID0gY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLm5vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uO1xyXG5cclxuICAgICAgICAgICAgICAgIHNlbGVjdGlvbiA9IHNlbGVjdFRleHQoZWxlbS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYXJkVGV4dCcpWzBdKTtcclxuICAgICAgICAgICAgICAgIGNvcHlTZWxlY3Rpb25UZXh0KCk7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3Rpb24uZW1wdHkoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBDT05GSUcuQVNDSUkuRF9LRVk6XHJcbiAgICAgICAgICAgIGlmIChldmVudC5jdHJsS2V5IHx8IHdpbmRvdy5jbWRQcmVzcyB8fCB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY2FyZCA9IGNhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZDtcclxuICAgICAgICAgICAgICAgIGNhcmRNYW5hZ2VyLm5leHRDYXJkKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FyZE1hbmFnZXIuZGVsZXRlQ2FyZChjYXJkKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXJkTWFuYWdlci5zYXZlQ2FyZHMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIENPTkZJRy5BU0NJSS5FX0tFWTpcclxuICAgICAgICAgICAgaWYgKGV2ZW50LmN0cmxLZXkgfHwgd2luZG93LmNtZFByZXNzIHx8IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIGRvdWJsZUNsaWNrSGFuZGxlci5hcHBseShjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQubm9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBDT05GSUcuQVNDSUkuQV9LRVk6XHJcbiAgICAgICAgICAgIGlmIChldmVudC5jdHJsS2V5IHx8IHdpbmRvdy5jbWRQcmVzcyB8fCB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQudG9nZ2xlQXJjaGl2ZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIENPTkZJRy5BU0NJSS5JX0tFWTpcclxuICAgICAgICAgICAgaWYgKGV2ZW50LmN0cmxLZXkgfHwgd2luZG93LmNtZFByZXNzIHx8IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIC8vIGlucHV0LmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICBjcmVhdGVDYXJkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBDT05GSUcuQVNDSUkuUExVU19LRVk6XHJcbiAgICAgICAgICAgIGNoYW5nZURlcHRoLmFwcGx5KGNhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5ub2RlLCBbY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLmlkLCAxXSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgQ09ORklHLkFTQ0lJLk1JTlVTX0tFWTpcclxuICAgICAgICAgICAgY2hhbmdlRGVwdGguYXBwbHkoY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLm5vZGUsIFtjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQuaWQsIC0xXSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgQ09ORklHLkFTQ0lJLkRPVF9LRVk6XHJcbiAgICAgICAgICAgIHNldERlcHRoLmFwcGx5KGNhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5ub2RlLCBbY2FyZE1hbmFnZXIuc2VsZWN0ZWRDYXJkLmlkLCA1XSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgQ09ORklHLkFTQ0lJLlJfS0VZOlxyXG4gICAgICAgICAgICBjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQuY29sb3IgPSBjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQuZ2V0QmFja2dyb3VuZENvbG9yKCk7XHJcbiAgICAgICAgICAgIGNhcmRNYW5hZ2VyLnNlbGVjdGVkQ2FyZC5kZXJlbmRlcigpO1xyXG4gICAgICAgICAgICBjYXJkTWFuYWdlci5zZWxlY3RlZENhcmQucmVuZGVyKCk7XHJcblxyXG4gICAgICAgICAgICBjYXJkTWFuYWdlci5zYXZlQ2FyZHMoKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBDT05GSUcuQVNDSUkuWl9LRVk6XHJcbiAgICAgICAgICAgIGlmIChldmVudC5jdHJsS2V5IHx8IHdpbmRvdy5jbWRQcmVzcyB8fCB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXJkTWFuYWdlci51bmRlbGV0ZUxhc3RDYXJkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBDT05GSUcuQVNDSUkuQ01EX0tFWTpcclxuICAgICAgICAgICAgd2luZG93LmNtZFByZXNzID0gZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhpZGVFeHBvcnRDb250YWluZXIoKSB7XHJcbiAgICBleHBvcnRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxufVxyXG5cclxuZnVuY3Rpb24gaGlkZUVkaXRDb250YWluZXIoKSB7XHJcbiAgICBlZGl0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhpZGVJbXBvcnRDb250YWluZXIoKSB7XHJcbiAgICBpbXBvcnRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxufVxyXG5cclxuZnVuY3Rpb24gc3RvcFByb3BhZ2F0aW9uKGUpIHtcclxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVkaXRJbnB1dEtleUV2ZW50KGV2ZW50KSB7XHJcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIGxldCBjYXJkO1xyXG4gICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzICYmIGV2ZW50LnNoaWZ0S2V5KSByZXR1cm47XHJcbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcclxuICAgICAgICBjYXJkID0gY2FyZE1hbmFnZXIuY2FyZHNbZWRpdENvbnRhaW5lci5jYXJkSWRdO1xyXG4gICAgICAgIGNhcmQudGl0bGUgPSB0aXRsZUlucHV0LnZhbHVlO1xyXG4gICAgICAgIGNhcmQuZGVzY3JpcHRpb24gPSBlZGl0SW5wdXQudmFsdWU7XHJcbiAgICAgICAgY2FyZC5kZXJlbmRlcigpO1xyXG4gICAgICAgIGNhcmQucmVuZGVyKCk7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9ICcnO1xyXG4gICAgICAgIGNhcmRNYW5hZ2VyLnNhdmVDYXJkcygpO1xyXG4gICAgICAgIGhpZGVFZGl0Q29udGFpbmVyKCk7XHJcbiAgICB9IGVsc2UgaWYgKGV2ZW50LmtleUNvZGUgPT09IDI3KSB7XHJcbiAgICAgICAgaGlkZUVkaXRDb250YWluZXIoKTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGltcG9ydElucHV0S2V5RXZlbnQoZXZlbnQpIHtcclxuICAgIGlmIChldmVudC5rZXlDb2RlID09PSAyNykge1xyXG4gICAgICAgIGhpZGVJbXBvcnRDb250YWluZXIoKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZG91YmxlQ2xpY2tIYW5kbGVyKCkge1xyXG4gICAgbGV0IGVsZW0gPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkVGV4dCcpLFxyXG4gICAgICAgIGNhcmRJZCxcclxuICAgICAgICBjYXJkO1xyXG5cclxuICAgIGlmICh0aGlzLmlkID09PSAnJykge1xyXG4gICAgICAgIGNhcmRJZCA9IHBhcnNlSW50KHRoaXMucGFyZW50RWxlbWVudC5pZC5zcGxpdCgnXycpWzFdKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY2FyZElkID0gcGFyc2VJbnQodGhpcy5pZC5zcGxpdCgnXycpWzFdKTtcclxuICAgIH1cclxuXHJcbiAgICBjYXJkID0gY2FyZE1hbmFnZXIuY2FyZHNbY2FyZElkXTtcclxuXHJcbiAgICB0aXRsZUlucHV0LnZhbHVlID0gY2FyZC50aXRsZTtcclxuICAgIGVkaXRJbnB1dC52YWx1ZSA9IGNhcmQuZGVzY3JpcHRpb247XHJcbiAgICB0aXRsZUlucHV0LnN0eWxlLnRvcCA9IGNhcmQueTtcclxuICAgIHRpdGxlSW5wdXQuc3R5bGUubGVmdCA9IGNhcmQueDtcclxuICAgIGVkaXRDb250YWluZXIuY2FyZElkID0gY2FyZElkO1xyXG4gICAgZWRpdENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgIGVkaXRJbnB1dC5zdHlsZS50b3AgPSBjYXJkLnkgKyAyMztcclxuICAgIGVkaXRJbnB1dC5zdHlsZS5sZWZ0ID0gY2FyZC54O1xyXG4gICAgdGl0bGVJbnB1dC5mb2N1cygpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjYXJkQ2xpY2tFdmVudHMoZXZlbnQpIHtcclxuICAgIGxldCBlbGVtID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcuY2FyZFRleHQnKSxcclxuICAgICAgICBjYXJkSWQsXHJcbiAgICAgICAgY2FyZDtcclxuXHJcbiAgICBpZiAodGhpcy5pZCA9PT0gXCJcIikge1xyXG4gICAgICAgIGNhcmRJZCA9IHBhcnNlSW50KHRoaXMucGFyZW50RWxlbWVudC5pZC5zcGxpdCgnXycpWzFdKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY2FyZElkID0gcGFyc2VJbnQodGhpcy5pZC5zcGxpdCgnXycpWzFdKTtcclxuICAgIH1cclxuXHJcbiAgICBjYXJkID0gY2FyZE1hbmFnZXIuY2FyZHNbY2FyZElkXTtcclxuXHJcbiAgICBpZiAoY2FyZCA9PT0gdW5kZWZpbmVkKSByZXR1cm47XHJcblxyXG4gICAgY2FyZE1hbmFnZXIuc2VsZWN0Q2FyZChjYXJkLmlkKTtcclxuXHJcbiAgICBpZiAoZXZlbnQuY3RybEtleSkge1xyXG4gICAgfVxyXG4gICAgaWYgKGV2ZW50LmFsdEtleSkge1xyXG4gICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLmNvcHknKS5jbGljaygpO1xyXG4gICAgfVxyXG4gICAgaWYgKGV2ZW50LnNoaWZ0S2V5KSB7XHJcblxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjYXJkTWVudUV2ZW50cygpIHtcclxuICAgIGxldCBvcHRpb24gPSAkKHRoaXMpLmh0bWwoKSxcclxuICAgICAgICBzZWxlY3Rpb24sXHJcbiAgICAgICAgY2FyZElkID0gZ2V0UGFyZW50Q2FyZElkKHRoaXMpO1xyXG5cclxuICAgIHN3aXRjaCAob3B0aW9uKSB7XHJcbiAgICAgICAgY2FzZSAnKyc6XHJcbiAgICAgICAgICAgIGNoYW5nZURlcHRoLmFwcGx5KHRoaXMsIFtjYXJkSWQsIDFdKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnLSc6XHJcbiAgICAgICAgICAgIGNoYW5nZURlcHRoLmFwcGx5KHRoaXMsIFtjYXJkSWQsIC0xXSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ0MnOlxyXG4gICAgICAgICAgICBzZWxlY3Rpb24gPSBzZWxlY3RUZXh0KHRoaXMucGFyZW50RWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjYXJkVGV4dCcpWzBdKTtcclxuICAgICAgICAgICAgY29weVNlbGVjdGlvblRleHQoKTtcclxuICAgICAgICAgICAgc2VsZWN0aW9uLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ3gnOlxyXG4gICAgICAgICAgICBjYXJkTWFuYWdlci5kZWxldGVDYXJkKGNhcmRNYW5hZ2VyLmNhcmRzW2NhcmRJZF0pO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdWJzpcclxuICAgICAgICBjYXNlICdPJzpcclxuICAgICAgICAgICAgY2FyZE1hbmFnZXIuY2FyZHNbY2FyZElkXS50b2dnbGVBcmNoaXZlZCgpO1xyXG4gICAgfVxyXG4gICAgY2FyZE1hbmFnZXIuc2F2ZUNhcmRzKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGV4cG9ydENhcmRzKCkge1xyXG4gICAgZXhwb3J0Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgZXhwb3J0Q29udGVudC5pbm5lckhUTUwgPSBjYXJkTWFuYWdlci5leHBvcnRDYXJkcygpO1xyXG4gICAgc2VsZWN0aW9uID0gc2VsZWN0VGV4dChleHBvcnRDb250ZW50KTtcclxuICAgIGNvcHlTZWxlY3Rpb25UZXh0KCk7XHJcbiAgICBzZWxlY3Rpb24uZW1wdHkoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gbG9hZEltcG9ydENhcmRzQ29kZSgpIHtcclxuICAgIGxldCBkYXRhID0gaW1wb3J0SW5wdXQudmFsdWU7XHJcbiAgICBjYXJkTWFuYWdlci5pbXBvcnRDYXJkcyhkYXRhKTtcclxuICAgIGltcG9ydENvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93SW1wb3J0ZXIoKSB7XHJcbiAgICBpbXBvcnRDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICBpbXBvcnRJbnB1dC5mb2N1cygpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKCkge1xyXG4gICAgY29uc3QgY2FyZCA9IGNhcmRNYW5hZ2VyLmFkZENhcmQoT2JqZWN0LmNyZWF0ZShDYXJkLCB7fSkuaW5pdCgnJykpO1xyXG4gICAgY2FyZC5yZW5kZXIoKTtcclxuICAgIGNhcmRNYW5hZ2VyLnNlbGVjdENhcmQoY2FyZC5pZCk7XHJcblxyXG4gICAgLy8gYW5kIG5vdyB3ZSBhdXRvZWRpdCA6RFxyXG4gICAgZG91YmxlQ2xpY2tIYW5kbGVyLmFwcGx5KGNhcmQubm9kZSk7XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgaW5pdDogaW5pdFxyXG59OyIsIlxyXG52YXIgc3VicyA9IHt9O1xyXG5cclxuXHJcbmZ1bmN0aW9uIHB1YihuYW1lLCBwYXJhbXMpIHtcclxuICBzdWJzW25hbWVdLmZvckVhY2goZnVuY3Rpb24oZWxlbSkge1xyXG4gICAgZWxlbS5jYWxsYmFjay5hcHBseShlbGVtLmNvbnRleHQsIHBhcmFtcyk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN1YihuYW1lLCBjYWxsYmFjaywgY29udGV4dCkge1xyXG4gIGlmIChzdWJzW25hbWVdID09PSB1bmRlZmluZWQpIHtcclxuICAgIHN1YnNbbmFtZV0gPSBbXTtcclxuICB9XHJcblxyXG4gIHN1YnNbbmFtZV0ucHVzaCh7XHJcbiAgICBjYWxsYmFjazogY2FsbGJhY2ssXHJcbiAgICBjb250ZXh0OiBjb250ZXh0XHJcbiAgfSk7XHJcbn1cclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuICBwdWI6IHB1YixcclxuICBzdWI6IHN1YlxyXG59OyIsIndpbmRvdy5DT05GSUcgPSByZXF1aXJlKCcuL2NvbmZpZy5qcycpO1xyXG5cclxubGV0IGtleUhhbmRsZXIgPSByZXF1aXJlKCcuL2xpYi9rZXlIYW5kbGVyJyksXHJcbiAgY2FyZE1hbmFnZXIgPSByZXF1aXJlKCcuL21vZGVscy9DYXJkTWFuYWdlcicpLmdldEluc3RhbmNlKCksXHJcbiAgcHVic3ViID0gcmVxdWlyZSgnLi9saWIvcHVic3ViJyk7XHJcblxyXG53aW5kb3cuY20gPSB7XHJcbiAgY2FyZE1hbmFnZXI6IGNhcmRNYW5hZ2VyXHJcbn07XHJcblxyXG5PYmplY3QuYXNzaWduKHdpbmRvdywgcmVxdWlyZSgnLi9wcm90b3R5cGVzJykpO1xyXG5cclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgJ3N0cmljdCBtb2RlJztcclxuXHJcbiAga2V5SGFuZGxlci5pbml0KHtcclxuICAgIGNhcmRNYW5hZ2VyOiBjYXJkTWFuYWdlclxyXG4gIH0pO1xyXG5cclxuICBjYXJkTWFuYWdlci5sb2FkQ2FyZHMoKTtcclxuICBjYXJkTWFuYWdlci5yZW5kZXJBbGxDYXJkcygpO1xyXG59KTtcclxuIiwibGV0IHB1YnN1YiA9IHJlcXVpcmUoJy4uL2xpYi9wdWJzdWInKSxcclxuICAgIHJhbmRvbU1DID0gcmVxdWlyZSgncmFuZG9tLW1hdGVyaWFsLWNvbG9yJyk7XHJcblxyXG5cclxubGV0IENhcmQgPSB7XHJcbiAgICBpbml0OiBmdW5jdGlvbiAodGl0bGUsIGRlc2NyaXB0aW9uLCBwcmlzdGluZSkge1xyXG4gICAgICAgIHRoaXMuaWQgPSAtMTtcclxuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgICAgIHRoaXMuZGVwdGggPSA1O1xyXG4gICAgICAgIHRoaXMueCA9IDEwMDtcclxuICAgICAgICB0aGlzLnkgPSAxMDA7XHJcbiAgICAgICAgdGhpcy5jb2xvciA9IHRoaXMuZ2V0QmFja2dyb3VuZENvbG9yKCk7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNBcmNoaXZlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNEZWxldGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVkQXQgPSArbmV3IERhdGUoKTtcclxuICAgICAgICB0aGlzLmFyY2hpdmVkQXQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNQcmlzdGluZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSxcclxuICAgIHJlbmRlcjogZnVuY3Rpb24gKGFsd2F5cyA9IGZhbHNlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNEZWxldGVkID09PSB0cnVlICYmIGFsd2F5cyA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcclxuICAgICAgICAgICAgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcclxuICAgICAgICAgICAgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLFxyXG4gICAgICAgICAgICBsaW5rID0gdGhpcy5maW5kTGluaygpLFxyXG4gICAgICAgICAgICB0aGF0ID0gdGhpcztcclxuXHJcbiAgICAgICAgaWYgKHRoaXMudGl0bGUpIHtcclxuICAgICAgICAgICAgaWYgKGxpbmspIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlLmlubmVySFRNTCA9IGA8YSB0YXJnZXQ9XCJfYmxhbmtcIiBocmVmPVwiJHtsaW5rfVwiPiR7dGhpcy50aXRsZX08L2E+YDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRpdGxlLmlubmVySFRNTCA9IHRoaXMudGl0bGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAobGluaykge1xyXG4gICAgICAgICAgICAgICAgdGl0bGUuaW5uZXJIVE1MID0gYDxhIHRhcmdldD1cIl9ibGFua1wiIGhyZWY9XCIke2xpbmt9XCI+TGluayE8L2E+YDtcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmRlc2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgIHRleHQuaW5uZXJIVE1MID0gdGhpcy5kZXNjcmlwdGlvbi5yZXBsYWNlKC9cXHI/XFxuL2csICc8YnIvPicpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGl0bGUuY2xhc3NOYW1lID0gJ2NhcmRUaXRsZSc7XHJcbiAgICAgICAgdGV4dC5jbGFzc05hbWUgPSAnY2FyZFRleHQnO1xyXG5cclxuICAgICAgICBub2RlLmlkID0gJ3RvZG9fJyArIHRoaXMuaWQ7XHJcbiAgICAgICAgbm9kZS5jbGFzc05hbWUgPSAnY2FyZCBjYXJkLTEnO1xyXG4gICAgICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xyXG4gICAgICAgIG5vZGUuc3R5bGUubGVmdCA9IHRoaXMueDtcclxuICAgICAgICBub2RlLnN0eWxlLnRvcCA9IHRoaXMueTtcclxuICAgICAgICBub2RlLnN0eWxlLmN1cnNvciA9ICctd2Via2l0LWdyYWInO1xyXG4gICAgICAgIG5vZGUuc3R5bGUuekluZGV4ID0gdGhpcy5kZXB0aDtcclxuICAgICAgICBub2RlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHRoaXMuY29sb3I7XHJcblxyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQ29udGFpbmVyJykuYXBwZW5kQ2hpbGQobm9kZSk7XHJcblxyXG4gICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQoY3JlYXRlRGl2KCd4JywgJ2NvbnRyb2wgcmVtb3ZlJykpO1xyXG4gICAgICAgIC8vIG5vZGUuYXBwZW5kQ2hpbGQoY3JlYXRlRGl2KCcrJywgJ2NvbnRyb2wgdXAnKSk7XHJcbiAgICAgICAgLy8gbm9kZS5hcHBlbmRDaGlsZChjcmVhdGVEaXYoJy0nLCAnY29udHJvbCBkb3duJykpO1xyXG4gICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQoY3JlYXRlRGl2KCdDJywgJ2NvbnRyb2wgY29weScpKTtcclxuICAgICAgICBub2RlLmFwcGVuZENoaWxkKGNyZWF0ZURpdignZGVwdGg6ICcgKyB0aGlzLmRlcHRoLCAnZGVwdGgnKSk7XHJcbiAgICAgICAgLy8gbm9kZS5hcHBlbmRDaGlsZChjcmVhdGVEaXYodGhpcy5pc0FyY2hpdmVkID8gJ1YnIDogJ08nLCAnaXNBcmNoaXZlZCcpKTtcclxuICAgICAgICBub2RlLmFwcGVuZENoaWxkKGNyZWF0ZURpdignaWQ6ICcgKyB0aGlzLmlkLCAnaWQnKSk7XHJcblxyXG4gICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQodGl0bGUpO1xyXG4gICAgICAgIG5vZGUuYXBwZW5kQ2hpbGQodGV4dCk7XHJcblxyXG4gICAgICAgICQoJyN0b2RvXycgKyB0aGlzLmlkKS5kcmFnZ2FibGUoe1xyXG4gICAgICAgICAgICBzdG9wOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY2FyZCA9ICQoJyN0b2RvXycgKyB0aGF0LmlkKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhhdC5pc1ByaXN0aW5lID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5pc1ByaXN0aW5lID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHB1YnN1Yi5wdWIod2luZG93LkNPTkZJRy5MRVNTX1BSSVNUSU5FKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGF0LnggPSArIGNhcmQuY3NzKCdsZWZ0JykucmVwbGFjZSgncHgnLCAnJyk7XHJcbiAgICAgICAgICAgICAgICB0aGF0LnkgPSArIGNhcmQuY3NzKCd0b3AnKS5yZXBsYWNlKCdweCcsICcnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBwdWJzdWIucHViKHdpbmRvdy5DT05GSUcuU0VMRUNUX0NBUkQsIFt0aGF0LmlkXSk7XHJcbiAgICAgICAgICAgICAgICBwdWJzdWIucHViKHdpbmRvdy5DT05GSUcuU0FWRV9DQVJEUyk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMubm9kZSA9IG5vZGU7XHJcblxyXG5cclxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5pc0FyY2hpdmVkKSB7XHJcbiAgICAgICAgICAgIG5vZGUuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0sXHJcbiAgICBnZXRCYWNrZ3JvdW5kQ29sb3I6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gcmFuZG9tTUMuZ2V0Q29sb3IoeyBzaGFkZXM6IFsnMjAwJywgJzMwMCddIH0pO1xyXG4gICAgfSxcclxuICAgIGRlcmVuZGVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgbGV0IG5vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9kb18nICsgdGhpcy5pZCk7XHJcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250YWluZXInKS5yZW1vdmVDaGlsZChub2RlKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9LFxyXG4gICAgdG9nZ2xlQXJjaGl2ZWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0FyY2hpdmVkID09PSBmYWxzZSB8fCB0aGlzLmlzQXJjaGl2ZWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnbm90Q29tcGxldGVkJyk7XHJcbiAgICAgICAgICAgIHZvaWQgdGhpcy5ub2RlLm9mZnNldFdpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUuY2xhc3NMaXN0LmFkZCgnY29tcGxldGVkJyk7XHJcbiAgICAgICAgICAgIHRoaXMuYXJjaGl2ZWRBdCA9ICtuZXcgRGF0ZSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjb21wbGV0ZWQnKTtcclxuICAgICAgICAgICAgdm9pZCB0aGlzLm5vZGUub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5jbGFzc0xpc3QuYWRkKCdub3RDb21wbGV0ZWQnKTtcclxuICAgICAgICAgICAgdGhpcy5hcmNoaXZlZEF0ID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuaXNBcmNoaXZlZCA9ICF0aGlzLmlzQXJjaGl2ZWQ7XHJcblxyXG4gICAgICAgIHB1YnN1Yi5wdWIod2luZG93LkNPTkZJRy5TQVZFX0NBUkRTKTtcclxuICAgIH0sXHJcbiAgICBkZWxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmlzRGVsZXRlZCA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMuZGVyZW5kZXIoKTtcclxuICAgIH0sXHJcbiAgICB1bmRlbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuaXNEZWxldGVkID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHRoaXMucmVuZGVyKCk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSxcclxuICAgIGZpbmRMaW5rOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3QgcmVnZXggPSAvKGh0dHBzPzpcXC9cXC9bXlxcc10rfHd3dy5bXlxcc10rKS87XHJcbiAgICAgICAgbGV0IGxpbmsgPSByZWdleC5leGVjKHRoaXMudGl0bGUpO1xyXG5cclxuICAgICAgICBpZiAobGluayA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGxpbmsgPSByZWdleC5leGVjKHRoaXMuZGVzY3JpcHRpb24pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGxpbmspIHtcclxuICAgICAgICAgICAgcmV0dXJuIGxpbmtbMF07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBDYXJkOyIsImNvbnN0IENhcmQgPSByZXF1aXJlKCcuL0NhcmQnKSxcclxucHVic3ViID0gcmVxdWlyZSgnLi4vbGliL3B1YnN1YicpLFxyXG5DT05GSUcgPSByZXF1aXJlKCcuLi9jb25maWcnKTtcclxuXHJcbmxldCBDYXJkTWFuYWdlciA9IHtcclxuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuY2FyZHMgPSBbXTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkQ2FyZCA9IHtpZDogLTF9O1xyXG4gICAgICAgIHRoaXMuZGVsZXRlZENhcmRzID0gW107XHJcbiAgICAgICAgdGhpcy5wcmlzdGluZSA9IDA7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSxcclxuICAgIGFkZENhcmQ6IGZ1bmN0aW9uKGNhcmQpIHtcclxuICAgICAgICB0aGlzLmNhcmRzLnB1c2goY2FyZCk7XHJcbiAgICAgICAgY2FyZC5pZCA9IHRoaXMuY2FyZHMubGVuZ3RoIC0gMTtcclxuXHJcbiAgICAgICAgY2FyZC54ID0gY2FyZC54ICsgdGhpcy5wcmlzdGluZSAqIDEwO1xyXG4gICAgICAgIGNhcmQueSA9IGNhcmQueSArIHRoaXMucHJpc3RpbmUgKiAxMDtcclxuXHJcbiAgICAgICAgdGhpcy5wcmlzdGluZSsrO1xyXG5cclxuICAgICAgICByZXR1cm4gY2FyZDtcclxuICAgIH0sXHJcbiAgICByZW1vdmVDYXJkOiBmdW5jdGlvbihpZCkge1xyXG4gICAgICAgIHRoaXMuY2FyZHNbaWRdLmRlcmVuZGVyKCk7XHJcbiAgICAgICAgdGhpcy5jYXJkc1tpZF0gPSB1bmRlZmluZWQ7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSxcclxuICAgIHJlZHJhd0NhcmQ6IGZ1bmN0aW9uKGNhcmRJZCwgeCwgeSkge1xyXG4gICAgICAgIGxldCBjYXJkID0gdGhpcy5jYXJkc1tjYXJkSWRdO1xyXG4gICAgICAgIGNhcmQueCA9IHg7XHJcbiAgICAgICAgY2FyZC55ID0geTtcclxuXHJcbiAgICAgICAgY2FyZC5kZXJlbmRlcigpO1xyXG4gICAgICAgIGNhcmQucmVuZGVyKCk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSxcclxuICAgIHNhdmVDYXJkczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZihTdG9yYWdlKSAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhcmRzJywgSlNPTi5zdHJpbmdpZnkodGhpcy5jYXJkcykpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd5b3UgZG9uXFwndCBoYXZlIGxvY2FsIHN0b3JhZ2UgOignKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucGVyc2lzdFNlbGVjdGVkQ2FyZCgpO1xyXG4gICAgICAgIHRoaXMucGVyc2lzdERlbGV0ZWRDYXJkcygpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0sXHJcbiAgICBsb2FkQ2FyZHM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuY2FyZHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYXJkcycpKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2FyZHMgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYXJkcyA9IEpTT04ucGFyc2UoYXRvYihDT05GSUcuREVGQVVMVF9DT05URU5UKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmNsZWFyQXJyYXkoKTtcclxuXHJcbiAgICAgICAgdGhpcy5sb2FkU2VsZWN0ZWRDYXJkKCk7XHJcbiAgICAgICAgdGhpcy5sb2FkRGVsZXRlZENhcmRzKCk7XHJcblxyXG4gICAgICAgIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0sXHJcbiAgICBjbGVhckFycmF5OiBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgaTtcclxuXHJcbiAgICAgICAgdGhpcy5jYXJkcyA9IHRoaXMuY2FyZHMuZmlsdGVyKGZ1bmN0aW9uKGVsZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGVsZW0gIT09IHVuZGVmaW5lZCAmJiBlbGVtICE9PSBudWxsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGZvciAoaSBpbiB0aGlzLmNhcmRzKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNhcmRzLmhhc093blByb3BlcnR5KGkpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhcmRzWytpXS5pZCA9ICtpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0sXHJcbiAgICByZVJlbmRlckFsbENhcmRzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmNhcmRzLmZvckVhY2goKGNhcmQpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5kZXJlbmRlcigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMucmVuZGVyQWxsQ2FyZHMoKTtcclxuICAgIH0sXHJcbiAgICByZW5kZXJBbGxDYXJkczogZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgIHRoaXMuY2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY2FyZC5zZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWRDYXJkICYmICh0aGlzLnNlbGVjdGVkQ2FyZC5pZCA9PT0gY2FyZC5pZCk7XHJcbiAgICAgICAgICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoY2FyZCwgQ2FyZCk7XHJcbiAgICAgICAgICAgICAgICBjYXJkLnJlbmRlcigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9LFxyXG4gICAgZ2V0SW5zdGFuY2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChDYXJkTWFuYWdlci5pbnN0YW5jZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIENhcmRNYW5hZ2VyLmluc3RhbmNlID0gT2JqZWN0LmNyZWF0ZShDYXJkTWFuYWdlciwge30pO1xyXG4gICAgICAgICAgICBDYXJkTWFuYWdlci5pbnN0YW5jZS5pbml0KCk7XHJcbiAgICAgICAgICAgIHB1YnN1Yi5zdWIod2luZG93LkNPTkZJRy5TQVZFX0NBUkRTLCBDYXJkTWFuYWdlci5pbnN0YW5jZS5zYXZlQ2FyZHMsIENhcmRNYW5hZ2VyLmluc3RhbmNlKTtcclxuICAgICAgICAgICAgcHVic3ViLnN1Yih3aW5kb3cuQ09ORklHLlNFTEVDVF9DQVJELCBDYXJkTWFuYWdlci5pbnN0YW5jZS5zZWxlY3RDYXJkLCBDYXJkTWFuYWdlci5pbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIHB1YnN1Yi5zdWIod2luZG93LkNPTkZJRy5SRVJFTkRFUiwgQ2FyZE1hbmFnZXIuaW5zdGFuY2UucmVSZW5kZXJBbGxDYXJkcywgQ2FyZE1hbmFnZXIuaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICBwdWJzdWIuc3ViKHdpbmRvdy5DT05GSUcuTEVTU19QUklTVElORSwgQ2FyZE1hbmFnZXIuaW5zdGFuY2UubGVzc1ByaXN0aW5lLCBDYXJkTWFuYWdlci5pbnN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gQ2FyZE1hbmFnZXIuaW5zdGFuY2U7XHJcblxyXG4gICAgfSxcclxuICAgIGxlc3NQcmlzdGluZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5wcmlzdGluZS0tO1xyXG4gICAgfSxcclxuICAgIGV4cG9ydENhcmRzOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gYnRvYShKU09OLnN0cmluZ2lmeSh0aGlzLmNhcmRzKSk7XHJcbiAgICB9LFxyXG4gICAgaW1wb3J0Q2FyZHM6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FyZHMnLCBhdG9iKGRhdGEpKTtcclxuICAgICAgICB0aGlzLmxvYWRDYXJkcygpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyQWxsQ2FyZHMoKTtcclxuICAgIH0sXHJcbiAgICBzZWxlY3RDYXJkOiBmdW5jdGlvbihjYXJkSWQpIHtcclxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZENhcmQgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnNlbGVjdGVkQ2FyZC5ub2RlLmNsYXNzTGlzdCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRDYXJkLm5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZENhcmQgPSB0aGlzLmNhcmRzW2NhcmRJZF07XHJcblxyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRDYXJkLm5vZGUuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcclxuXHJcbiAgICAgICAgdGhpcy5wZXJzaXN0U2VsZWN0ZWRDYXJkKCk7XHJcbiAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7XHJcbiAgICB9LFxyXG4gICAgbmV4dENhcmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBpdCA9ICt0aGlzLnNlbGVjdGVkQ2FyZC5pZCArIDE7XHJcblxyXG4gICAgICAgIHdoaWxlIChpdCAhPT0gK3RoaXMuc2VsZWN0ZWRDYXJkLmlkKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNhcmRzW2l0XSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuY2FyZHNbaXRdLmlzRGVsZXRlZCAhPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCsraXQgPj0gdGhpcy5jYXJkcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGl0ID0gMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zZWxlY3RDYXJkKGl0KTtcclxuICAgIH0sXHJcbiAgICBwcmV2aW91c0NhcmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBpdCA9ICt0aGlzLnNlbGVjdGVkQ2FyZC5pZCAtIDE7XHJcblxyXG4gICAgICAgIHdoaWxlIChpdCAhPT0gK3RoaXMuc2VsZWN0ZWRDYXJkLmlkKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNhcmRzW2l0XSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoLS1pdCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBpdCA9IHRoaXMuY2FyZHMubGVuZ3RoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNlbGVjdENhcmQoaXQpO1xyXG4gICAgfSxcclxuICAgIHBlcnNpc3RTZWxlY3RlZENhcmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkQ2FyZCAmJiB0aGlzLnNlbGVjdGVkQ2FyZC5pZCA+IC0xKSB7XHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdzZWxlY3RlZENhcmQnLCB0aGlzLnNlbGVjdGVkQ2FyZC5pZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGxvYWRTZWxlY3RlZENhcmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBzZWxlY3RlZENhcmRJZCA9ICtsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2VsZWN0ZWRDYXJkJyk7XHJcblxyXG4gICAgICAgIGlmIChzZWxlY3RlZENhcmRJZCAhPT0gdW5kZWZpbmVkICYmIHNlbGVjdGVkQ2FyZElkID4gLTEpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZENhcmQgPSB0aGlzLmNhcmRzW3NlbGVjdGVkQ2FyZElkXTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgcGVyc2lzdERlbGV0ZWRDYXJkczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2RlbGV0ZWRDYXJkcycsIEpTT04uc3RyaW5naWZ5KHRoaXMuZGVsZXRlZENhcmRzKSk7XHJcbiAgICB9LFxyXG4gICAgbG9hZERlbGV0ZWRDYXJkczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5kZWxldGVkQ2FyZHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdkZWxldGVkQ2FyZHMnKSkgfHwgW107XHJcblxyXG4gICAgfSxcclxuICAgIGRlbGV0ZUNhcmQ6IGZ1bmN0aW9uKGNhcmQpIHtcclxuICAgICAgICB0aGlzLmRlbGV0ZWRDYXJkcy5wdXNoKGNhcmQuaWQpO1xyXG5cclxuICAgICAgICBjYXJkLmRlbGV0ZSgpO1xyXG4gICAgfSxcclxuICAgIHVuZGVsZXRlTGFzdENhcmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmRlbGV0ZWRDYXJkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zZWxlY3RDYXJkKHRoaXMuY2FyZHNbdGhpcy5kZWxldGVkQ2FyZHMuc3BsaWNlKHRoaXMuZGVsZXRlZENhcmRzLmxlbmd0aCAtIDEpXS51bmRlbGV0ZSgpLmlkKTtcclxuXHJcbiAgICAgICAgdGhpcy5zYXZlQ2FyZHMoKTtcclxuICAgIH1cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQ2FyZE1hbmFnZXI7IiwibGV0IGNhcmRNYW5hZ2VyID0gcmVxdWlyZSgnLi9tb2RlbHMvQ2FyZE1hbmFnZXInKS5nZXRJbnN0YW5jZSgpO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlRGl2KHRleHQsIGNsYXNzTmFtZSkge1xyXG4gICAgbGV0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgZGl2LmlubmVySFRNTCA9IHRleHQ7XHJcbiAgICBkaXYuc3R5bGUuZmxvYXQgPSBcInJpZ2h0XCI7XHJcbiAgICBkaXYuc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XHJcbiAgICBkaXYuc3R5bGUud2lkdGggPSBcImF1dG9cIjtcclxuICAgIGRpdi5zdHlsZS50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xyXG4gICAgZGl2LnN0eWxlLm1hcmdpbiA9IFwiMCAzcHhcIjtcclxuXHJcbiAgICBpZiAoY2xhc3NOYW1lICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBkaXYuY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBkaXY7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNvcHlTZWxlY3Rpb25UZXh0KCkge1xyXG4gICAgbGV0IGNvcHlzdWNjZXNzOyAvLyBsZXQgdG8gY2hlY2sgd2hldGhlciBleGVjQ29tbWFuZCBzdWNjZXNzZnVsbHkgZXhlY3V0ZWRcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29weXN1Y2Nlc3MgPSBkb2N1bWVudC5leGVjQ29tbWFuZChcImNvcHlcIik7IC8vIHJ1biBjb21tYW5kIHRvIGNvcHkgc2VsZWN0ZWQgdGV4dCB0byBjbGlwYm9hcmRcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb3B5c3VjY2VzcyA9IGZhbHNlXHJcbiAgICB9XHJcbiAgICByZXR1cm4gY29weXN1Y2Nlc3NcclxufVxyXG5cclxuZnVuY3Rpb24gc2VsZWN0VGV4dChlbGVtZW50KSB7XHJcbiAgICBsZXQgZG9jID0gZG9jdW1lbnRcclxuICAgICAgICAsIHRleHQgPSBlbGVtZW50XHJcbiAgICAgICAgLCByYW5nZSwgc2VsZWN0aW9uXHJcbiAgICA7XHJcbiAgICBpZiAoZG9jLmJvZHkuY3JlYXRlVGV4dFJhbmdlKSB7XHJcbiAgICAgICAgcmFuZ2UgPSBkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSgpO1xyXG4gICAgICAgIHJhbmdlLm1vdmVUb0VsZW1lbnRUZXh0KHRleHQpO1xyXG4gICAgICAgIHJhbmdlLnNlbGVjdCgpO1xyXG4gICAgfSBlbHNlIGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uKSB7XHJcbiAgICAgICAgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpO1xyXG4gICAgICAgIHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtcclxuICAgICAgICByYW5nZS5zZWxlY3ROb2RlQ29udGVudHModGV4dCk7XHJcbiAgICAgICAgc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xyXG4gICAgICAgIHNlbGVjdGlvbi5hZGRSYW5nZShyYW5nZSk7XHJcbiAgICAgICAgcmV0dXJuIHNlbGVjdGlvbjtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0UGFyZW50Q2FyZElkKGNvbnRleHQpIHtcclxuICAgIGlmIChjb250ZXh0LnBhcmVudEVsZW1lbnQgPT09IG51bGwpIHJldHVybjtcclxuICAgIHJldHVybiBwYXJzZUludChjb250ZXh0LnBhcmVudEVsZW1lbnQuaWQuc3BsaXQoXCJfXCIpWzFdKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0U29tZXRoaW5nQnljbGFzc05hbWUoY29udGV4dCwgY2xhc3NuYW1lKSB7XHJcbiAgICBsZXQgcmVzID0gY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGNsYXNzbmFtZSk7XHJcblxyXG4gICAgaWYgKHJlcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXMgPSBjb250ZXh0LnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShjbGFzc25hbWUpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoYW5nZURlcHRoKGNhcmRJZCwgaW5jcmVtZW50KSB7XHJcbiAgICBsZXQgZGVwdGggPSBjYXJkTWFuYWdlci5jYXJkc1tjYXJkSWRdLmRlcHRoICsgaW5jcmVtZW50O1xyXG5cclxuICAgIHRoaXMuc3R5bGUuekluZGV4ID0gZGVwdGg7XHJcbiAgICBjYXJkTWFuYWdlci5jYXJkc1tjYXJkSWRdLmRlcHRoID0gZGVwdGg7XHJcblxyXG4gICAgbGV0IGVsZW0gPSBnZXRTb21ldGhpbmdCeWNsYXNzTmFtZSh0aGlzLCAnZGVwdGgnKTtcclxuICAgIGVsZW1bMF0uaW5uZXJIVE1MID0gZGVwdGg7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldERlcHRoKGNhcmRJZCwgZGVwdGgpIHtcclxuICAgIHRoaXMuc3R5bGUuekluZGV4ID0gZGVwdGg7XHJcbiAgICBjYXJkTWFuYWdlci5jYXJkc1tjYXJkSWRdLmRlcHRoID0gZGVwdGg7XHJcblxyXG4gICAgbGV0IGVsZW0gPSBnZXRTb21ldGhpbmdCeWNsYXNzTmFtZSh0aGlzLCAnZGVwdGgnKTtcclxuICAgIGVsZW1bMF0uaW5uZXJIVE1MID0gZGVwdGg7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldENhcmRIVE1MQnlJZChtYWluQ29udGFpbmVyLCBpZCkge1xyXG4gICAgcmV0dXJuIG1haW5Db250YWluZXIuZ2V0RWxlbWVudEJ5SWQoJ3RvZG9fJyArIGlkKTtcclxufVxyXG5cclxuLy8gUFJPVE9UWVBFU1xyXG5cclxuLypcclxuICogUmV0dXJucyB0aGUgc2l6ZSBvZiBhbiBhcnJheVxyXG4gKi9cclxuQXJyYXkucHJvdG90eXBlLnNpemUgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbihhKSB7XHJcbiAgICAgICAgcmV0dXJuIGEgIT09IHVuZGVmaW5lZDtcclxuICAgIH0pLmxlbmd0aFxyXG59O1xyXG5cclxuLypcclxuICogUmV0dXJucyB0aGUgc2l6ZSBvZiBhbiBvYmplY3RcclxuICovXHJcbk9iamVjdC5zaXplID0gZnVuY3Rpb24ob2JqKSB7XHJcbiAgICBsZXQgc2l6ZSA9IDAsIGtleSA9IFwiXCI7XHJcblxyXG4gICAgZm9yIChrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSBzaXplKys7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc2l6ZTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgY3JlYXRlRGl2OiBjcmVhdGVEaXYsXHJcbiAgICBjb3B5U2VsZWN0aW9uVGV4dDogY29weVNlbGVjdGlvblRleHQsXHJcbiAgICBzZWxlY3RUZXh0OiBzZWxlY3RUZXh0LFxyXG4gICAgZ2V0UGFyZW50Q2FyZElkOiBnZXRQYXJlbnRDYXJkSWQsXHJcbiAgICBjaGFuZ2VEZXB0aDogY2hhbmdlRGVwdGgsXHJcbiAgICBzZXREZXB0aDogc2V0RGVwdGgsXHJcbiAgICBnZXRDYXJkSFRNTEJ5SWQ6IGdldENhcmRIVE1MQnlJZFxyXG59OyJdfQ=="}